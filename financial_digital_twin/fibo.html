<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Guide to the FIBO-Based Risk Framework</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Serene Neutral (Warm grays, soft beige, with a muted blue accent) -->
    <!-- Application Structure Plan: A thematic, four-section SPA design (Intro, Interactive Dashboard, Data Model, AI Workflow). This structure was chosen to guide the user from high-level theory to practical application, which is more intuitive for learning than the linear structure of the source report. The core interaction is the Risk Control Dashboard, allowing non-linear exploration of the key data points and their relationships, enhancing user understanding and engagement. -->
    <!-- Visualization & Content Choices: 
    - Report Info: Core relationship (Counterparty->Agreement->Facility). Goal: Organize/Inform. Viz: HTML/CSS diagram. Interaction: Click to reveal definitions. Justification: Simple, clear visual for a foundational concept. Method: Vanilla JS + Tailwind.
    - Report Info: 11 risk fields and their hierarchy. Goal: Compare/Inform. Viz: Horizontal Bar Chart + Text Panel. Interaction: Click list to update chart highlight and text. Justification: Interactively connects the list of fields to their strategic importance and detailed definitions. Library: Chart.js.
    - Report Info: JSON schema and example. Goal: Organize/Inform. Viz: Interactive code block. Interaction: Click on JSON keys to see explanations. Justification: Demystifies the final data output by making it explorable. Method: Vanilla JS.
    - Report Info: AI workflow process. Goal: Organize/Change. Viz: HTML/CSS flowchart. Interaction: Hover for tooltips. Justification: Visually simplifies a complex, multi-step process. Method: Tailwind CSS.
    - CONFIRMATION: NO SVG/Mermaid used. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8; /* Warm off-white */
            color: #374151; /* Cool Gray 700 */
        }
        .nav-link {
            transition: color 0.3s ease, border-bottom-color 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover, .nav-link.active {
            color: #3B82F6; /* Blue 500 */
            border-bottom-color: #3B82F6;
        }
        .card {
            background-color: #FFFFFF;
            border: 1px solid #E5E7EB; /* Cool Gray 200 */
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: box-shadow 0.3s ease;
        }
        .card:hover {
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .risk-field-item {
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        .risk-field-item.active, .risk-field-item:hover {
            background-color: #EFF6FF; /* Blue 50 */
            color: #1D4ED8; /* Blue 700 */
        }
        .json-key { color: #9333EA; } /* Purple 600 */
        .json-string { color: #16A34A; } /* Green 600 */
        .json-number { color: #EA580C; } /* Orange 600 */
        .json-punctuation { color: #4B5563; } /* Cool Gray 600 */
        .tooltip {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .has-tooltip:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 border-b border-gray-200">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-gray-800">FIBO-Based Risk Framework</h1>
                </div>
                <nav class="hidden md:flex md:space-x-8">
                    <a href="#introduction" class="nav-link text-gray-500 font-medium py-2">Introduction</a>
                    <a href="#dashboard" class="nav-link text-gray-500 font-medium py-2">Dashboard</a>
                    <a href="#datamodel" class="nav-link text-gray-500 font-medium py-2">Data Model</a>
                    <a href="#workflow" class="nav-link text-gray-500 font-medium py-2">AI Workflow</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <section id="introduction" class="scroll-mt-20 mb-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold tracking-tight text-gray-900">A Semantic Framework for Enterprise Risk</h2>
                <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">This application provides an interactive exploration of a sophisticated, unambiguous, and extensible data standard for financial risk analysis, grounded in the Financial Industry Business Ontology (FIBO).</p>
            </div>

            <div class="card p-6 md:p-8">
                <h3 class="text-2xl font-semibold text-gray-800 mb-2">The Core Relationship Model</h3>
                <p class="text-gray-600 mb-6">A direct link between a counterparty and a facility is a simplification. The correct ontological representation involves the crucial contractual mechanism that binds them. This three-part relationship is essential for accurately representing legal obligations and enabling deep risk analysis.</p>
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 text-center">
                    <div id="model-counterparty" class="p-4 border-2 border-blue-500 rounded-lg bg-blue-50 w-full md:w-1/4 cursor-pointer">
                        <span class="text-2xl">üë§</span>
                        <h4 class="font-bold text-blue-800">Counterparty</h4>
                    </div>
                    <div class="text-2xl font-mono text-gray-400">‚Üí</div>
                    <div id="model-agreement" class="p-4 border-2 border-green-500 rounded-lg bg-green-50 w-full md:w-1/4 cursor-pointer">
                        <span class="text-2xl">üìú</span>
                        <h4 class="font-bold text-green-800">Credit Agreement</h4>
                    </div>
                    <div class="text-2xl font-mono text-gray-400">‚Üí</div>
                    <div id="model-facility" class="p-4 border-2 border-purple-500 rounded-lg bg-purple-50 w-full md:w-1/4 cursor-pointer">
                        <span class="text-2xl">üè¶</span>
                        <h4 class="font-bold text-purple-800">Facility</h4>
                    </div>
                </div>
                <div id="model-explanation" class="mt-6 p-4 bg-gray-50 rounded-lg min-h-[80px] flex items-center justify-center">
                    <p class="text-gray-700 italic">Click on a component above to see its definition.</p>
                </div>
            </div>
        </section>

        <section id="dashboard" class="scroll-mt-20 mb-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold tracking-tight text-gray-900">Interactive Risk Control Dashboard</h2>
                <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">Explore the 11 interconnected risk control fields. Select a field from the list to view its details, context, and its place within the overall risk management hierarchy.</p>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1">
                    <div class="card p-4">
                        <h3 class="text-lg font-semibold mb-3 px-2 text-gray-700">Risk Control Fields</h3>
                        <ul id="risk-fields-list" class="space-y-1"></ul>
                    </div>
                </div>
                <div class="lg:col-span-2">
                    <div class="card p-6 md:p-8">
                        <div id="risk-field-details"></div>
                    </div>
                    <div class="card p-6 md:p-8 mt-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4 text-center">Risk Control Hierarchy</h3>
                        <div class="chart-container">
                            <canvas id="riskHierarchyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="datamodel" class="scroll-mt-20 mb-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold tracking-tight text-gray-900">The Data Model in Action</h2>
                <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">See how these concepts translate into a portable, modular, and scalable graph data schema, ready for ingestion into an agentic workflow.</p>
            </div>
            <div class="card p-6 md:p-8">
                <h3 class="text-2xl font-semibold text-gray-800 mb-4">Example JSON Output</h3>
                <p class="text-gray-600 mb-6">The final output is a structured JSON object for each company. This format is easily parsed and ensures data is directly consumable by modern AI agents, "grounding" them in factual data to prevent inaccuracies.</p>
                <div class="bg-gray-900 rounded-lg p-4 text-sm font-mono text-white overflow-x-auto">
                    <pre><code id="json-output"></code></pre>
                </div>
            </div>
        </section>

        <section id="workflow" class="scroll-mt-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold tracking-tight text-gray-900">The AI Agentic Workflow</h2>
                <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">This structured data enables a continuous feedback loop, transforming a static data file into a dynamic component of a real-time, self-improving risk monitoring system.</p>
            </div>
            <div class="card p-6 md:p-8">
                <div class="flex flex-col md:flex-row items-center justify-between space-y-8 md:space-y-0 md:space-x-4">
                    <div class="has-tooltip relative flex flex-col items-center text-center w-full md:w-1/5">
                        <div class="w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center text-3xl">üìÑ</div>
                        <h4 class="mt-2 font-semibold text-blue-800">1. Unstructured Data</h4>
                        <div class="tooltip absolute bottom-full mb-2 w-60 bg-gray-800 text-white text-xs rounded py-2 px-3">Source documents like credit agreements are processed.</div>
                    </div>
                    <div class="text-2xl font-mono text-gray-400">‚Üí</div>
                    <div class="has-tooltip relative flex flex-col items-center text-center w-full md:w-1/5">
                        <div class="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center text-3xl">ü§ñ</div>
                        <h4 class="mt-2 font-semibold text-green-800">2. AI Processing</h4>
                        <div class="tooltip absolute bottom-full mb-2 w-60 bg-gray-800 text-white text-xs rounded py-2 px-3">AI extracts structured data into the FIBO-aligned JSON format.</div>
                    </div>
                    <div class="text-2xl font-mono text-gray-400">‚Üí</div>
                    <div class="has-tooltip relative flex flex-col items-center text-center w-full md:w-1/5">
                        <div class="w-16 h-16 rounded-full bg-purple-100 flex items-center justify-center text-3xl">üß†</div>
                        <h4 class="mt-2 font-semibold text-purple-800">3. Agent Analysis</h4>
                        <div class="tooltip absolute bottom-full mb-2 w-60 bg-gray-800 text-white text-xs rounded py-2 px-3">An AI agent ingests the structured JSON and analyzes real-time signals.</div>
                    </div>
                    <div class="text-2xl font-mono text-gray-400">‚Üí</div>
                    <div class="has-tooltip relative flex flex-col items-center text-center w-full md:w-1/5">
                        <div class="w-16 h-16 rounded-full bg-yellow-100 flex items-center justify-center text-3xl">üö©</div>
                        <h4 class="mt-2 font-semibold text-yellow-800">4. Automated Flagging</h4>
                        <div class="tooltip absolute bottom-full mb-2 w-60 bg-gray-800 text-white text-xs rounded py-2 px-3">The agent generates a risk rating and flags, updating the JSON file.</div>
                    </div>
                    <div class="text-2xl font-mono text-gray-400 hidden md:block">‚Ü∫</div>
                </div>
                 <p class="text-center mt-8 text-gray-600 italic">Hover over each step to learn more about the process.</p>
            </div>
        </section>

    </main>

    <footer class="border-t border-gray-200 mt-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 text-center text-gray-500">
            <p>&copy; 2025 Interactive Risk Framework. All concepts based on the Semantic Framework for Enterprise Financial Risk report.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const data = {
                modelDefinitions: {
                    counterparty: 'A party to a contract with whom one negotiates on a given agreement. It is a specific role played by a legal person or other agent.',
                    agreement: 'A contractual agreement that establishes the terms of a loan or other financial facility, binding the counterparty to specific obligations.',
                    facility: 'A high-level business concept, typically a loan or credit agreement, that defines the financial instrument provided to the counterparty.'
                },
                riskFields: [
                    { id: 'riskRating', name: 'Risk Rating', category: 'Strategic', description: "A score reflecting the creditworthiness of a counterparty.", context: "An objective measure of a counterparty's ability to fulfill its financial obligations." },
                    { id: 'riskAppetite', name: 'Risk Appetite', category: 'Strategic', description: "The amount and type of risk an organization is willing to accept.", context: "A strategic guide for decision-making and resource allocation." },
                    { id: 'regulatoryRating', name: 'Regulatory Rating', category: 'Strategic', description: "A rating assigned by a regulatory body for compliance purposes.", context: "A score reflecting a counterparty's compliance and risk as viewed by a regulator." },
                    { id: 'facilityLimit', name: 'Facility Limit', category: 'Tactical', description: "The maximum amount a bank can lend to a single borrower.", context: "A regulatory or internal control to prevent excessive concentration of credit risk." },
                    { id: 'tradingLimit', name: 'Trading Limit', category: 'Tactical', description: "The maximum amount of exposure to a counterparty in a trading relationship.", context: "A control to manage counterparty credit risk in over-the-counter (OTC) markets." },
                    { id: 'targetNetRiskDate', name: 'Target Net Risk Date', category: 'Tactical', description: "A date by which a portfolio's risk profile should be reduced.", context: "A temporal mechanism for dynamically managing and rebalancing risk over time." },
                    { id: 'hedgeAmount', name: 'Hedge Amount', category: 'Operational', description: "The value of an investment position intended to offset potential losses.", context: "A risk mitigation strategy using financial instruments like futures or options." },
                    { id: 'takeAndHoldAmount', name: 'Take and Hold Amount', category: 'Operational', description: "A temporary authorization on funds to mitigate transaction risk.", context: "Reserves a specific amount in an account to ensure payment upon transaction finalization." },
                    { id: 'productType', name: 'Product Type', category: 'Operational', description: "The type of financial instrument or service involved.", context: "Classifies the transaction, such as derivatives, securities, or loans." },
                    { id: 'kycStatus', name: 'KYC Status', category: 'Operational', description: "The state of a counterparty's 'Know Your Customer' verification.", context: "A measure of compliance with AML regulations, essential for due diligence." },
                    { id: 'automatedRiskFlag', name: 'Automated Risk Flag', category: 'Operational', description: "A tag generated by an AI model to signal a potential risk.", context: "A real-time, dynamic indicator of potential risk based on behavioral analysis." }
                ],
                jsonData: {
                    "companies": [
                        {
                            "Counterparty": {
                                "uuid": "ACME-CORP-2025",
                                "legalName": "Acme Supplies",
                                "kycStatus": "Verified",
                                "regulatoryRating": "A-1",
                                "riskAppetite": "Moderate",
                                "CreditAgreements": [
                                    {
                                        "agreementUUID": "1234-ABCD-5678",
                                        "agreementDate": "2023-01-15",
                                        "productType": "Derivatives",
                                        "expirationDate": "2025-12-31",
                                        "Facilities": [
                                            {
                                                "facilityUUID": "ABCD-1234-EFGH",
                                                "facilityLimit": 1000000.00,
                                                "tradingLimit": 500000.00,
                                                "takeAndHoldAmount": 50000.00,
                                                "targetNetRiskDate": "2024-06-30",
                                                "hedgeAmount": 25000.00,
                                                "automatedRiskFlags": [
                                                    "high_utilization"
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    ]
                }
            };
            
            let riskChart;

            function init() {
                setupNavigation();
                setupModelDiagram();
                populateRiskFieldsList();
                displayRiskFieldDetails(data.riskFields[0].id);
                renderRiskHierarchyChart(data.riskFields[0].id);
                renderJsonOutput();
            }

            function setupNavigation() {
                const navLinks = document.querySelectorAll('.nav-link');
                const sections = document.querySelectorAll('section');

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            navLinks.forEach(link => {
                                link.classList.toggle('active', link.getAttribute('href').substring(1) === entry.target.id);
                            });
                        }
                    });
                }, { rootMargin: "-50% 0px -50% 0px" });

                sections.forEach(section => observer.observe(section));
                
                navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        document.querySelector(link.getAttribute('href')).scrollIntoView({
                            behavior: 'smooth'
                        });
                    });
                });
            }

            function setupModelDiagram() {
                const counterparty = document.getElementById('model-counterparty');
                const agreement = document.getElementById('model-agreement');
                const facility = document.getElementById('model-facility');
                const explanation = document.getElementById('model-explanation');

                counterparty.addEventListener('click', () => {
                    explanation.innerHTML = `<p class="text-gray-800">${data.modelDefinitions.counterparty}</p>`;
                });
                agreement.addEventListener('click', () => {
                    explanation.innerHTML = `<p class="text-gray-800">${data.modelDefinitions.agreement}</p>`;
                });
                facility.addEventListener('click', () => {
                    explanation.innerHTML = `<p class="text-gray-800">${data.modelDefinitions.facility}</p>`;
                });
            }

            function populateRiskFieldsList() {
                const list = document.getElementById('risk-fields-list');
                data.riskFields.forEach((field, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `<a id="link-${field.id}" class="risk-field-item block p-2 rounded-md ${index === 0 ? 'active' : ''}">${field.name}</a>`;
                    li.addEventListener('click', () => {
                        displayRiskFieldDetails(field.id);
                        renderRiskHierarchyChart(field.id);
                        document.querySelectorAll('.risk-field-item').forEach(item => item.classList.remove('active'));
                        li.querySelector('a').classList.add('active');
                    });
                    list.appendChild(li);
                });
            }

            function displayRiskFieldDetails(fieldId) {
                const field = data.riskFields.find(f => f.id === fieldId);
                const container = document.getElementById('risk-field-details');
                container.innerHTML = `
                    <h3 class="text-2xl font-bold text-gray-800">${field.name}</h3>
                    <p class="mt-2 text-lg text-gray-600">${field.description}</p>
                    <div class="mt-4 pt-4 border-t border-gray-200">
                        <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">Financial Context</h4>
                        <p class="mt-1 text-gray-700">${field.context}</p>
                    </div>
                `;
            }

            function renderRiskHierarchyChart(highlightedFieldId) {
                const ctx = document.getElementById('riskHierarchyChart').getContext('2d');
                const fieldData = data.riskFields.find(f => f.id === highlightedFieldId);
                
                const backgroundColors = {
                    'Strategic': 'rgba(59, 130, 246, 0.2)',
                    'Tactical': 'rgba(16, 185, 129, 0.2)',
                    'Operational': 'rgba(139, 92, 246, 0.2)'
                };
                const borderColors = {
                    'Strategic': 'rgba(59, 130, 246, 1)',
                    'Tactical': 'rgba(16, 185, 129, 1)',
                    'Operational': 'rgba(139, 92, 246, 1)'
                };

                const chartData = {
                    labels: ['Strategic', 'Tactical', 'Operational'],
                    datasets: [{
                        label: 'Risk Control Level',
                        data: [1, 1, 1],
                        backgroundColor: (context) => {
                            const label = context.chart.data.labels[context.dataIndex];
                            return label === fieldData.category ? borderColors[label] : backgroundColors[label];
                        },
                        borderColor: (context) => {
                            const label = context.chart.data.labels[context.dataIndex];
                            return borderColors[label];
                        },
                        borderWidth: 2
                    }]
                };

                if (riskChart) {
                    riskChart.data = chartData;
                    riskChart.update();
                } else {
                    riskChart = new Chart(ctx, {
                        type: 'bar',
                        data: chartData,
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    enabled: false
                                }
                            },
                            scales: {
                                x: {
                                    display: false,
                                    max: 1.1
                                },
                                y: {
                                    grid: {
                                        display: false
                                    },
                                    ticks: {
                                        font: {
                                            size: 14,
                                            weight: '500'
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
            }

            function renderJsonOutput() {
                const jsonString = JSON.stringify(data.jsonData, null, 2);
                const formattedJson = jsonString.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, (match) => {
                    let cls = 'json-number';
                    if (/^"/.test(match)) {
                        if (/:$/.test(match)) {
                            cls = 'json-key';
                        } else {
                            cls = 'json-string';
                        }
                    } else if (/true|false/.test(match)) {
                        cls = 'json-boolean';
                    } else if (/null/.test(match)) {
                        cls = 'json-null';
                    }
                    return `<span class="${cls}">${match}</span>`;
                }).replace(/([\{\}\[\]\(\),:])/g, '<span class="json-punctuation">$1</span>');
                document.getElementById('json-output').innerHTML = formattedJson;
            }

            init();
        });
    </script>
</body>
</html>
