<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM System | Agent Registry</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="h-screen flex flex-col grid-bg text-slate-200">
    <div class="scan-line"></div>
    <!-- Nav via nav.js -->

    <main class="flex-1 p-8 overflow-y-auto">

        <header class="mb-8 flex justify-between items-center glass-panel p-6 rounded-lg border-l-4 border-emerald-500">
            <div>
                <h1 class="text-3xl font-bold text-white mb-2 font-mono">AGENT REGISTRY</h1>
                <p class="text-slate-400">Manage and monitor autonomous agents, swarms, and meta-agents.</p>
            </div>
            <div class="flex space-x-4">
                 <button class="px-4 py-2 bg-emerald-900/50 hover:bg-emerald-800 text-emerald-400 border border-emerald-700 rounded text-sm font-mono transition">
                    + DEPLOY NEW
                 </button>
                 <button class="px-4 py-2 bg-slate-800 hover:bg-slate-700 text-slate-300 border border-slate-600 rounded text-sm font-mono transition" onclick="renderAgents()">
                    REFRESH STATUS
                 </button>
            </div>
        </header>

        <!-- Filters -->
        <div class="flex space-x-2 mb-6 text-sm font-mono" id="filters">
            <button class="px-3 py-1 bg-blue-900/40 text-blue-300 border border-blue-800 rounded hover:bg-blue-800/50 active" onclick="filter('ALL')">ALL</button>
            <button class="px-3 py-1 bg-slate-800 text-slate-400 border border-slate-700 rounded hover:bg-slate-700" onclick="filter('Sub-Agent')">SUB-AGENTS</button>
            <button class="px-3 py-1 bg-slate-800 text-slate-400 border border-slate-700 rounded hover:bg-slate-700" onclick="filter('Meta-Agent')">META-AGENTS</button>
            <button class="px-3 py-1 bg-slate-800 text-slate-400 border border-slate-700 rounded hover:bg-slate-700" onclick="filter('Orchestrator')">ORCHESTRATORS</button>
        </div>

        <!-- Agents Grid -->
        <div id="agents-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Populated by JS -->
            <div class="col-span-full text-center text-slate-500 py-20 font-mono animate-pulse">
                Accessing Agent Registry...
            </div>
        </div>

    </main>

    <script src="js/mock_data.js"></script>
    <script src="js/app.js"></script>
    <script src="js/nav.js"></script>
    <script>
        let allAgents = [];
        let currentFilter = 'ALL';

        document.addEventListener('DOMContentLoaded', () => {
             const data = window.MOCK_DATA || {};
             allAgents = data.agents || [];
             // Simulate loading delay for effect
             setTimeout(renderAgents, 500);
        });

        function filter(type) {
            currentFilter = type;
            // Update UI buttons
            const buttons = document.getElementById('filters').querySelectorAll('button');
            buttons.forEach(btn => {
                if(btn.textContent === type || (type === 'ALL' && btn.textContent === 'ALL')) {
                    btn.className = "px-3 py-1 bg-blue-900/40 text-blue-300 border border-blue-800 rounded hover:bg-blue-800/50 active";
                } else if (btn.textContent === 'SUB-AGENTS' && type === 'Sub-Agent') {
                    btn.className = "px-3 py-1 bg-blue-900/40 text-blue-300 border border-blue-800 rounded hover:bg-blue-800/50 active";
                } else if (btn.textContent === 'META-AGENTS' && type === 'Meta-Agent') {
                    btn.className = "px-3 py-1 bg-blue-900/40 text-blue-300 border border-blue-800 rounded hover:bg-blue-800/50 active";
                } else if (btn.textContent === 'ORCHESTRATORS' && type === 'Orchestrator') {
                    btn.className = "px-3 py-1 bg-blue-900/40 text-blue-300 border border-blue-800 rounded hover:bg-blue-800/50 active";
                } else {
                    btn.className = "px-3 py-1 bg-slate-800 text-slate-400 border border-slate-700 rounded hover:bg-slate-700";
                }
            });
            renderAgents();
        }

        function renderAgents() {
            const grid = document.getElementById('agents-grid');
            grid.innerHTML = '';

            if (allAgents.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center text-slate-500 py-10">No agents found in registry.</div>';
                return;
            }

            const filtered = currentFilter === 'ALL' ? allAgents : allAgents.filter(a => a.type === currentFilter);

            filtered.forEach(agent => {
                // Generate consistent mock stats based on name hash
                const hash = agent.name.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
                const load = hash % 100;
                const statusOpts = ['ACTIVE', 'IDLE', 'PROCESSING', 'MAINTENANCE'];
                const status = statusOpts[hash % 4];
                const version = `v${(hash % 5) + 1}.0`;
                const id = `AGT-${hash.toString().slice(0, 3)}`;

                const isProcessing = status === 'PROCESSING';
                const isIdle = status === 'IDLE' || status === 'SLEEP';
                const isMaint = status === 'MAINTENANCE';

                let statusColor = 'bg-emerald-500';
                if(isProcessing) statusColor = 'bg-blue-500';
                if(isIdle) statusColor = 'bg-slate-500';
                if(isMaint) statusColor = 'bg-amber-500';

                // Map type to color
                let typeColor = "text-slate-400 border-slate-600";
                if(agent.type === 'Sub-Agent') typeColor = "text-blue-400 border-blue-600";
                if(agent.type === 'Meta-Agent') typeColor = "text-purple-400 border-purple-600";
                if(agent.type === 'Orchestrator') typeColor = "text-amber-400 border-amber-600";

                const card = document.createElement('div');
                card.className = 'glass-panel p-5 rounded-lg border border-slate-700 hover:border-slate-500 hover-card group flex flex-col justify-between h-56 transition';

                card.innerHTML = `
                    <div>
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[0.65rem] font-bold font-mono px-2 py-0.5 rounded bg-slate-800 ${typeColor} border uppercase">${agent.type}</span>
                            <span class="flex items-center space-x-2 text-xs font-mono text-slate-300">
                                <span class="w-2 h-2 rounded-full ${statusColor} ${isProcessing ? 'animate-pulse' : ''}"></span>
                                <span>${status}</span>
                            </span>
                        </div>
                        <h3 class="text-lg font-bold text-white group-hover:text-cyan-400 transition mb-1 leading-tight">${agent.name}</h3>
                        <p class="text-xs text-slate-400 line-clamp-3 mb-3 overflow-hidden" title="${agent.description}">${agent.description}</p>
                    </div>

                    <div>
                        <div class="flex justify-between text-[0.6rem] text-slate-500 font-mono mb-1">
                            <span>ID: ${id}</span>
                            <span>VER: ${version}</span>
                        </div>
                        <div class="w-full bg-slate-800 h-1.5 rounded-full overflow-hidden">
                            <div class="h-full ${statusColor} opacity-80" style="width: ${load}%"></div>
                        </div>
                         <div class="text-[0.6rem] text-right text-slate-500 mt-1">LOAD: ${load}%</div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
    </script>
</body>
</html>
