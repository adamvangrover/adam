<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM v23.5 :: MARKET MAYHEM: THE GREAT SHUT-IN</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/market_mayhem_tiers.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/nav.js" defer></script>
    <script src="js/market_mayhem_viewer.js" defer></script>
</head>
<body class="tier-high">

    <!-- System 2 Verification Overlay -->
    <div id="system2-overlay" class="system2-overlay">
        <div class="system2-terminal">
            <div id="sys2-content"></div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="cyber-toast-container"></div>

    <!-- Raw Source Modal -->
    <div id="raw-source-modal" class="raw-source-modal">
        <div class="raw-source-header">
            <span>SOURCE_DATA.JSON</span>
            <span style="cursor:pointer; color:#cc0000;" onclick="toggleSource()">[CLOSE]</span>
        </div>
        <div class="raw-source-content" id="raw-source-content"></div>
    </div>

    <!-- Virtual Toolbar for High Tier -->
    <div class="doc-toolbar" style="display: flex;">
        <div class="toolbar-item" onclick="window.location.href='market_mayhem_archive_v24.html'"><strong>FILE</strong></div>
        <div class="toolbar-item" onclick="toggleRedactionMode()">REDACT</div>
        <div class="toolbar-item" onclick="printReport()">PRINT</div>
        <div class="toolbar-item" onclick="shareReport()">SHARE</div>
        <div class="toolbar-item" onclick="downloadReport()">DOWNLOAD</div>
        <div class="toolbar-item" onclick="toggleTheme()">VIEW</div>
        <div class="toolbar-item" onclick="showToast('INSERT: PERMISSION DENIED')">INSERT</div>
        <div class="toolbar-item" onclick="showToast('FORMAT: LOCKED')">FORMAT</div>
        <div class="toolbar-item" onclick="runVerification()" style="color: #0078d7;"><strong>VERIFY</strong></div>
        <div style="flex-grow:1;"></div>
        <div class="toolbar-item" style="color:#666;">ADAM_V26_EDITOR</div>
    </div>

    <div style="max-width: 1400px; margin: 0 auto; padding: 10px 20px; display:flex; justify-content:space-between; align-items:center; display: none;">
        <a href="market_mayhem_archive_v24.html" class="cyber-btn">&larr; RETURN TO ARCHIVE</a>
        <div style="font-family:'JetBrains Mono'; font-size:0.7rem; color:#666;">SECURE CONNECTION ESTABLISHED</div>
    </div>

    <div class="newsletter-wrapper">
        <div class="paper-sheet" id="paper-sheet">

            <!-- Top Secret Stamp -->
            <div id="top-secret-stamp" class="top-secret-stamp">TOP SECRET</div>

            <!-- High Tier Header UI -->
            <div class="doc-header-ui" style="display: flex;">
                <span id="verification-status">CONFIDENTIAL // SYSTEM 2 REVIEW</span>
                <span>c79435b5</span>
            </div>

            <div style="display:flex; justify-content:space-between; font-family:'JetBrains Mono'; font-size:0.8rem; color:#666; margin-bottom:20px; margin-top: 20px;">
                <span>2020-03-20</span>
                <span>ID: c79435b5</span>
            </div>

            <h1 class="title">MARKET MAYHEM: THE GREAT SHUT-IN</h1>

            <!-- Metadata Panel for High Tier (Embedded in Doc) -->
            <div class="doc-metadata-panel" style="display: grid;">
                <div class="doc-metadata-item"><strong>Classification</strong>UNCLASSIFIED</div>
                <div class="doc-metadata-item"><strong>Conviction</strong>50/100</div>
                <div class="doc-metadata-item"><strong>Sentiment</strong>85/100</div>
                <div class="doc-metadata-item"><strong>Reviewer</strong>Risk_Engine</div>
            </div>

            <div id="financialChartContainer" style="display:none; margin-bottom: 30px;">
                <canvas id="financialChart"></canvas>
            </div>

            <!-- Crisis Simulator (High Tier Only) -->
            <div id="crisisSimContainer" style="display:none; margin-bottom: 30px; border: 1px solid #cc0000; padding: 20px; background: rgba(50, 0, 0, 0.2);">
                <h3 style="color: #cc0000; margin-top: 0; font-family: 'JetBrains Mono'; border-bottom: 1px solid #cc0000; padding-bottom: 10px; margin-bottom: 20px;">CRISIS SIMULATOR // STRESS TEST</h3>

                <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                    <div class="crisis-btn" onclick="renderCrisis('2008_LEHMAN')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2008 LEHMAN
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('1987_BLACK_MONDAY')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        1987 BLACK MON
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2020_COVID')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2020 PANDEMIC
                    </div>
                </div>

                <div style="height: 300px; position: relative;">
                    <canvas id="crisisChart"></canvas>
                </div>
                <div style="font-size: 0.7rem; color: #888; margin-top: 15px; font-style: italic;">
                    * Hypothetical performance based on portfolio beta and current risk profile. PAST PERFORMANCE IS NOT INDICATIVE OF FUTURE RESULTS.
                </div>
            </div>

            <div id="document-body">
                <p><strong>The World Has Stopped.</strong> In an unprecedented event, the global economy has entered a medically-induced coma. The S&P 500 has crashed 34% from its February highs, the fastest bear market in history.</p>
<p>Volatility is off the charts. The VIX closed at 82.69 on March 16th, surpassing the 2008 peak. Credit spreads have blown out, and liquidity in the Treasury market—usually the deepest in the world—has evaporated.</p>
<p><strong>Oil Shock:</strong> Demand destruction is so severe that WTI crude futures are trading at imminent risk of turning negative due to storage capacity constraints. (Update: They did, hitting -$37.63 in April).</p>
<p><strong>Central Bank Response:</strong> The Fed has unleashed 'Unlimited QE', buying corporate bonds for the first time in history. The mantra is 'Don't Fight the Fed', but the economic data is catastrophic.</p>
            </div>

            <!-- Provenance Log (All Tiers) -->
            <div class="provenance-log">
                <div class="log-entry">
                    <span>> HASH_CHECK</span>
                    <span style="color:var(--terminal-green);">c79435b514fd775700564d6dc1bdc047f1d459b783eb05d854d8f07cf7cbb756</span>
                </div>
                <div class="log-entry">
                    <span>> SENTIMENT_SCAN</span>
                    <span>85 (DENSITY: 67)</span>
                </div>
                <div class="log-entry">
                    <span>> CONVICTION_LOCK</span>
                    <span>50%</span>
                </div>
                <div class="log-entry">
                    <span>> CRITIQUE_LOG</span>
                    <span>"Agent Risk_Engine reviewed this intelligence. Verdict: REVIEW_REQUIRED. Sentiment alignment: 85/100. Cross-reference with knowledge graph completed."</span>
                </div>
            </div>

            <a href="#" class="source-jump-btn" onclick="toggleSource(); return false;" title="View Source JSON">JUMP TO SOURCE</a>

            <div style="margin-top: 40px; border-top: 1px solid #ccc; padding-top: 20px; font-style: italic; color: #666;">
                End of Transmission.
            </div>
        </div>

        <aside class="cyber-sidebar">
            <div class="sidebar-widget">
                <div class="sidebar-title">Intelligence Metadata</div>
                <div class="stat-row"><span>DATE</span> <span class="stat-val">2020-03-20</span></div>
                <div class="stat-row"><span>TYPE</span> <span class="stat-val">HISTORICAL</span></div>
                <div class="stat-row"><span>CLASS</span> <span class="stat-val">UNCLASSIFIED</span></div>
                <div class="stat-row"><span>PROVENANCE</span> <span class="stat-val" title="c79435b514fd775700564d6dc1bdc047f1d459b783eb05d854d8f07cf7cbb756">c79435b5</span></div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Sentiment Analysis</div>
                <div class="stat-row"><span>SCORE</span> <span class="stat-val">85/100</span></div>
                <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 85%;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Detected Entities</div>
                <div class="tag-cloud">
                    <a href="market_mayhem_archive_v24.html?search=US_FED" class="tag" style="text-decoration:none;">US_FED</a><a href="market_mayhem_archive_v24.html?search=AI" class="tag" style="text-decoration:none; border-color:#666;">AI</a><a href="market_mayhem_archive_v24.html?search=Bonds" class="tag" style="text-decoration:none; border-color:#666;">Bonds</a><a href="market_mayhem_archive_v24.html?search=EV" class="tag" style="text-decoration:none; border-color:#666;">EV</a><a href="market_mayhem_archive_v24.html?search=Oil" class="tag" style="text-decoration:none; border-color:#666;">Oil</a><a href="market_mayhem_archive_v24.html?search=Volatility" class="tag" style="text-decoration:none; border-color:#666;">Volatility</a>
                </div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Agent Conviction</div>
                 <div class="stat-row"><span>CONFIDENCE</span> <span class="stat-val">50/100</span></div>
                 <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 50%; background: #ffff00;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Semantic Analysis</div>
                 <div class="stat-row"><span>DENSITY</span> <span class="stat-val">67/100</span></div>
                 <div class="stat-row"><span>PROBABILITY</span> <span class="stat-val">50/100</span></div>
            </div>

             <div class="sidebar-widget" style="border-color: #555;">
                <div class="sidebar-title">Reviewer Agent Log</div>
                 <div style="font-size: 0.75rem; color: #ccc; font-style: italic;">
                    "Agent Risk_Engine reviewed this intelligence. Verdict: REVIEW_REQUIRED. Sentiment alignment: 85/100. Cross-reference with knowledge graph completed."
                </div>
                <div class="stat-row" style="margin-top:10px;"><span>QUALITY SCORE</span> <span class="stat-val">100/100</span></div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Contributing Agents</div>
                 <div style="display:flex; flex-direction:column; gap:5px;">
                    <div style="font-size:0.75rem; color:#666;">System Core</div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Hidden Raw Data -->
    <textarea id="hidden-raw-data" style="display:none;">{
  "date": "2020-03-20",
  "title": "MARKET MAYHEM: THE GREAT SHUT-IN",
  "summary": "\"Lockdown\". The global economy has come to a screeching halt. With \"15 Days to Slow the Spread\" in effect, markets are pricing in a depression-level GDP contraction.",
  "type": "HISTORICAL",
  "filename": "newsletter_market_mayhem_mar_2020.html",
  "is_sourced": true,
  "full_body": "<p><strong>The World Has Stopped.</strong> In an unprecedented event, the global economy has entered a medically-induced coma. The S&P 500 has crashed 34% from its February highs, the fastest bear market in history.</p>\n<p>Volatility is off the charts. The VIX closed at 82.69 on March 16th, surpassing the 2008 peak. Credit spreads have blown out, and liquidity in the Treasury market\u2014usually the deepest in the world\u2014has evaporated.</p>\n<p><strong>Oil Shock:</strong> Demand destruction is so severe that WTI crude futures are trading at imminent risk of turning negative due to storage capacity constraints. (Update: They did, hitting -$37.63 in April).</p>\n<p><strong>Central Bank Response:</strong> The Fed has unleashed 'Unlimited QE', buying corporate bonds for the first time in history. The mantra is 'Don't Fight the Fed', but the economic data is catastrophic.</p>",
  "source_priority": 3,
  "sentiment_score": 85,
  "entities": {
    "tickers": [],
    "agents": [],
    "sovereigns": [
      "US_FED"
    ],
    "keywords": [
      "AI",
      "Bonds",
      "EV",
      "Oil",
      "Volatility"
    ]
  },
  "provenance_hash": "c79435b514fd775700564d6dc1bdc047f1d459b783eb05d854d8f07cf7cbb756",
  "metrics_json": "{}",
  "conviction": 50,
  "semantic_score": 67,
  "probability": 50,
  "critique": "Agent Risk_Engine reviewed this intelligence. Verdict: REVIEW_REQUIRED. Sentiment alignment: 85/100. Cross-reference with knowledge graph completed."
}</textarea>

    <script>
        // Chart Injection Logic
        const metricsData = {};
        const crisisData = {"2008_LEHMAN": {"scenario": "2008_LEHMAN", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "market": [100.0, 88.71, 89.14, 88.68, 86.18, 80.58, 84.38, 87.15, 86.67, 88.84, 77.96, 78.24, 75.34, 76.85, 57.79, 54.74, 55.09, 57.76, 61.83, 59.86, 64.79, 65.12, 59.44, 51.71, 48.39, 46.1, 43.84, 44.4, 44.8, 41.04], "portfolio": [100.0, 85.63, 87.2, 85.87, 81.92, 74.04, 80.88, 84.67, 84.49, 86.91, 71.15, 72.79, 66.62, 67.36, 39.91, 37.51, 37.23, 39.41, 43.63, 41.25, 48.19, 48.27, 42.77, 33.62, 30.93, 29.36, 27.5, 27.88, 27.55, 24.21]}, "1987_BLACK_MONDAY": {"scenario": "1987_BLACK_MONDAY", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], "market": [100.0, 84.14, 86.64, 87.83, 85.79, 78.76, 86.44, 92.89, 94.11, 79.25, 65.46, 67.28, 64.77, 68.27, 59.07, 55.67, 57.75, 63.78, 72.7, 70.96], "portfolio": [100.0, 78.77, 83.15, 84.25, 81.01, 71.15, 83.1, 92.19, 94.58, 71.33, 52.88, 56.02, 51.25, 54.43, 41.49, 38.71, 40.22, 45.95, 55.64, 53.27]}, "2020_COVID": {"scenario": "2020_COVID", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "market": [100.0, 87.35, 88.65, 88.89, 86.68, 80.71, 86.0, 90.17, 90.38, 93.91, 80.95, 82.03, 79.12, 81.73, 72.86, 68.9, 70.05, 74.75, 81.75, 69.55, 76.62, 77.33, 69.46, 58.83, 54.47, 51.81, 49.19, 50.33, 51.28, 46.52, 47.15, 48.68, 47.67, 45.55, 46.75, 49.53, 51.15, 52.55, 53.35, 53.35], "portfolio": [100.0, 83.59, 86.37, 86.09, 82.56, 74.13, 83.03, 88.86, 89.72, 94.18, 74.9, 77.72, 71.32, 73.5, 58.92, 55.25, 55.69, 60.5, 69.07, 53.15, 63.64, 64.13, 55.44, 41.66, 37.72, 35.72, 33.36, 34.34, 34.45, 29.81, 30.38, 31.39, 30.75, 28.36, 29.78, 32.42, 34.19, 35.82, 36.34, 36.68]}};

        // --- Metrics Chart ---
        if (metricsData && Object.keys(metricsData).length > 0) {
            const ctx = document.getElementById('financialChart');
            const container = document.getElementById('financialChartContainer');

            // Basic parsing of metrics structure (assuming flat or Year->Val)
            let labels = [];
            let values = [];
            let labelName = "Metric";

            // Try to find a timeseries
            for (const [key, val] of Object.entries(metricsData)) {
                if (typeof val === 'object') {
                    // Likely year -> value
                    labels = Object.keys(val);
                    values = Object.values(val).map(v => parseFloat(v.replace(/[^0-9.-]/g, '')));
                    labelName = key;
                    break;
                }
            }

            if (labels.length > 0) {
                container.style.display = 'block';
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: labelName,
                            data: values,
                            backgroundColor: 'rgba(204, 0, 0, 0.5)',
                            borderColor: '#cc0000',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#ccc' } }
                        },
                        scales: {
                            y: { grid: { color: '#333' }, ticks: { color: '#888' } },
                            x: { grid: { color: '#333' }, ticks: { color: '#888' } }
                        }
                    }
                });
            }
        }

        // --- Crisis Simulation Logic ---
        let crisisChartInstance = null;

        window.renderCrisis = function(scenarioName) {
            if (!crisisData || !crisisData[scenarioName]) return;

            // UI Feedback for Buttons
            document.querySelectorAll('.crisis-btn').forEach(btn => {
                btn.style.borderColor = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#666';
                btn.style.color = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#ccc';
            });

            const data = crisisData[scenarioName];
            const ctx = document.getElementById('crisisChart').getContext('2d');

            if (crisisChartInstance) {
                crisisChartInstance.destroy();
            }

            crisisChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'Your Portfolio (Simulated)',
                            data: data.portfolio,
                            borderColor: '#00f3ff',
                            backgroundColor: 'rgba(0, 243, 255, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 0
                        },
                        {
                            label: 'Market Benchmark',
                            data: data.market,
                            borderColor: '#666',
                            borderDash: [5, 5],
                            borderWidth: 1,
                            pointRadius: 0,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { labels: { color: '#ccc', font: { family: 'JetBrains Mono' } } },
                        title: {
                            display: true,
                            text: 'STRESS TEST SCENARIO: ' + scenarioName.replace(/_/g, ' '),
                            color: '#cc0000',
                            font: { family: 'JetBrains Mono' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#cc0000',
                            bodyColor: '#fff',
                            borderColor: '#333',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#333' },
                            ticks: { color: '#888', callback: function(value) { return value + '%'; } }
                        },
                        x: {
                            grid: { color: '#333' },
                            ticks: { display: false }
                        }
                    }
                }
            });
        };

        // Auto-Run Default Crisis if Data Available
        if (crisisData && Object.keys(crisisData).length > 0) {
            document.getElementById('crisisSimContainer').style.display = 'block';
            // slight delay to ensure Chart.js loaded
            setTimeout(() => renderCrisis('2008_LEHMAN'), 100);
        }
    </script>
</body>
</html>
