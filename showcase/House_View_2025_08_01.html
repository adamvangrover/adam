<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM v23.5 :: House View: Energy Crisis & Geopolitics Outlook</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/market_mayhem_tiers.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/nav.js" defer></script>
    <script src="js/market_mayhem_viewer.js" defer></script>
</head>
<body class="tier-high">

    <div id="system2-overlay" class="system2-overlay">
        <div class="system2-terminal">
            <div id="sys2-content"></div>
        </div>
    </div>

    <div id="toast-container" class="cyber-toast-container"></div>

    <div id="raw-source-modal" class="raw-source-modal">
        <div class="raw-source-header">
            <span>SOURCE_DATA.JSON</span>
            <span style="cursor:pointer; color:#cc0000;" onclick="toggleSource()">[CLOSE]</span>
        </div>
        <div class="raw-source-content" id="raw-source-content"></div>
    </div>

    <div class="doc-toolbar" style="display: flex;">
        <div class="toolbar-item" onclick="window.location.href='market_mayhem_archive_v24.html'"><strong>FILE</strong></div>
        <div class="toolbar-item" onclick="toggleRedactionMode()">REDACT</div>
        <div class="toolbar-item" onclick="printReport()">PRINT</div>
        <div class="toolbar-item" onclick="shareReport()">SHARE</div>
        <div class="toolbar-item" onclick="downloadReport()">DOWNLOAD</div>
        <div class="toolbar-item" onclick="toggleTheme()">VIEW</div>
        <div class="toolbar-item" onclick="showToast('INSERT: PERMISSION DENIED')">INSERT</div>
        <div class="toolbar-item" onclick="showToast('FORMAT: LOCKED')">FORMAT</div>
        <div class="toolbar-item" onclick="runVerification()" style="color: #0078d7;"><strong>VERIFY</strong></div>
        <div style="flex-grow:1;"></div>
        <div class="toolbar-item" style="color:#666;">ADAM_V26_EDITOR</div>
    </div>

    <div style="max-width: 1400px; margin: 0 auto; padding: 10px 20px; display:flex; justify-content:space-between; align-items:center; display: none;">
        <a href="market_mayhem_archive_v24.html" class="cyber-btn">&larr; RETURN TO ARCHIVE</a>
        <div style="font-family:'JetBrains Mono'; font-size:0.7rem; color:#666;">SECURE CONNECTION ESTABLISHED</div>
    </div>

    <div class="newsletter-wrapper">
        <div class="paper-sheet" id="paper-sheet">

            <div id="top-secret-stamp" class="top-secret-stamp">TOP SECRET</div>

            <div class="doc-header-ui" style="display: flex;">
                <span id="verification-status">CONFIDENTIAL // SYSTEM 2 REVIEW</span>
                <span>d053131c</span>
            </div>

            <div style="display:flex; justify-content:space-between; font-family:'JetBrains Mono'; font-size:0.8rem; color:#666; margin-bottom:20px; margin-top: 20px;">
                <span>2025-08-01</span>
                <span>ID: d053131c</span>
            </div>

            <h1 class="title">House View: Energy Crisis & Geopolitics Outlook</h1>

            <div class="doc-metadata-panel" style="display: grid;">
                <div class="doc-metadata-item"><strong>Classification</strong>UNCLASSIFIED</div>
                <div class="doc-metadata-item"><strong>Conviction</strong>50/100</div>
                <div class="doc-metadata-item"><strong>Sentiment</strong>25/100</div>
                <div class="doc-metadata-item"><strong>Reviewer</strong>Market_Maker</div>
            </div>

            <div id="financialChartContainer" style="display:none; margin-bottom: 30px;">
                <canvas id="financialChart"></canvas>
            </div>

            <div id="crisisSimContainer" style="display:none; margin-bottom: 30px; border: 1px solid #cc0000; padding: 20px; background: rgba(50, 0, 0, 0.2);">
                <h3 style="color: #cc0000; margin-top: 0; font-family: 'JetBrains Mono'; border-bottom: 1px solid #cc0000; padding-bottom: 10px; margin-bottom: 20px;">CRISIS SIMULATOR // STRESS TEST</h3>

                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 20px;">
                    <div class="crisis-btn" onclick="renderCrisis('2008_LEHMAN')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2008 LEHMAN
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('1987_BLACK_MONDAY')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        1987 BLACK MON
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2000_DOTCOM_BUBBLE')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2000 DOTCOM
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2020_COVID')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2020 PANDEMIC
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2022_INFLATION_SHOCK')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2022 INFLATION
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2025_AI_SHOCK')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2025 AI SHOCK
                    </div>
                </div>

                <div style="height: 300px; position: relative;">
                    <canvas id="crisisChart"></canvas>
                </div>

                <div id="crisisMetrics" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; font-family: 'JetBrains Mono'; font-size: 0.8rem; color: #ccc;">
                    <div style="border: 1px solid #00f3ff; padding: 10px; background: rgba(0, 243, 255, 0.05);">
                        <div style="color: #00f3ff; border-bottom: 1px solid #00f3ff; margin-bottom: 10px; padding-bottom: 5px; font-weight: bold;">PORTFOLIO PERFORMANCE</div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>MAX DRAWDOWN:</span> <span id="port_dd" style="color: #fff;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>VOLATILITY (ANN):</span> <span id="port_vol" style="color: #fff;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between;"><span>TOTAL RETURN:</span> <span id="port_ret" style="color: #fff;">0.00%</span></div>
                    </div>
                    <div style="border: 1px solid #666; padding: 10px; background: rgba(100, 100, 100, 0.1);">
                        <div style="color: #888; border-bottom: 1px solid #666; margin-bottom: 10px; padding-bottom: 5px; font-weight: bold;">MARKET BENCHMARK</div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>MAX DRAWDOWN:</span> <span id="mkt_dd" style="color: #ccc;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>VOLATILITY (ANN):</span> <span id="mkt_vol" style="color: #ccc;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between;"><span>TOTAL RETURN:</span> <span id="mkt_ret" style="color: #ccc;">0.00%</span></div>
                    </div>
                </div>

                <div style="font-size: 0.7rem; color: #888; margin-top: 15px; font-style: italic;">
                    * Hypothetical performance based on portfolio beta and current risk profile. PAST PERFORMANCE IS NOT INDICATIVE OF FUTURE RESULTS.
                </div>
            </div>

            <div id="document-body">
                <strong>Date:</strong> 2025-08-01
<strong>Type:</strong> House_View
<strong>Agent:</strong> RiskGuardian
<h2>Executive Summary</h2>
Strategic allocation update for August 2025. The Energy Crisis & Geopolitics remains the dominant macro driver.
<h2>Analysis</h2>
We recommend adjusting exposure based on the Energy Crisis & Geopolitics. The Volatile environment suggests caution/opportunity.
<h2>Key Metrics</h2>
<ul>
<li><strong>S&P 500:</strong> 5968</li>
<li><strong>VIX:</strong> 14.75</li>
<li><strong>10Y Treasury:</strong> 4.02%</li>
</ul>
<em>Generated by Adam v30.0 System Intelligence</em>

            </div>

            <div class="provenance-log">
                <div class="log-entry">
                    <span>> HASH_CHECK</span>
                    <span style="color:var(--terminal-green);">d053131c4a02f58f1b898f5f453639e34a01fbc3d6af59a93c1409001aee43e1</span>
                </div>
                <div class="log-entry">
                    <span>> SENTIMENT_SCAN</span>
                    <span>25 (DENSITY: 88)</span>
                </div>
                <div class="log-entry">
                    <span>> CONVICTION_LOCK</span>
                    <span>50%</span>
                </div>
                <div class="log-entry">
                    <span>> CRITIQUE_LOG</span>
                    <span>"Agent Market_Maker reviewed this intelligence. Verdict: SPECULATIVE. Sentiment alignment: 25/100. Cross-reference with knowledge graph completed."</span>
                </div>
            </div>

            <a href="#" class="source-jump-btn" onclick="toggleSource(); return false;" title="View Source JSON">JUMP TO SOURCE</a>

            <div style="margin-top: 40px; border-top: 1px solid #ccc; padding-top: 20px; font-style: italic; color: #666;">
                End of Transmission.
            </div>
        </div>

        <aside class="cyber-sidebar">
            <div class="sidebar-widget">
                <div class="sidebar-title">Intelligence Metadata</div>
                <div class="stat-row"><span>DATE</span> <span class="stat-val">2025-08-01</span></div>
                <div class="stat-row"><span>TYPE</span> <span class="stat-val">NEWSLETTER</span></div>
                <div class="stat-row"><span>CLASS</span> <span class="stat-val">UNCLASSIFIED</span></div>
                <div class="stat-row"><span>PROVENANCE</span> <span class="stat-val" title="d053131c4a02f58f1b898f5f453639e34a01fbc3d6af59a93c1409001aee43e1">d053131c</span></div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Sentiment Analysis</div>
                <div class="stat-row"><span>SCORE</span> <span class="stat-val">25/100</span></div>
                <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 25%;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Detected Entities</div>
                <div class="tag-cloud">
                    <a href="market_mayhem_archive_v24.html?search=AI" class="tag" style="text-decoration:none; border-color:#666;">AI</a><a href="market_mayhem_archive_v24.html?search=Energy" class="tag" style="text-decoration:none; border-color:#666;">Energy</a>
                </div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Agent Conviction</div>
                 <div class="stat-row"><span>CONFIDENCE</span> <span class="stat-val">50/100</span></div>
                 <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 50%; background: #ffff00;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Semantic Analysis</div>
                 <div class="stat-row"><span>DENSITY</span> <span class="stat-val">88/100</span></div>
                 <div class="stat-row"><span>PROBABILITY</span> <span class="stat-val">50/100</span></div>
            </div>

             <div class="sidebar-widget" style="border-color: #555;">
                <div class="sidebar-title">Reviewer Agent Log</div>
                 <div style="font-size: 0.75rem; color: #ccc; font-style: italic;">
                    "Agent Market_Maker reviewed this intelligence. Verdict: SPECULATIVE. Sentiment alignment: 25/100. Cross-reference with knowledge graph completed."
                </div>
                <div class="stat-row" style="margin-top:10px;"><span>QUALITY SCORE</span> <span class="stat-val">100/100</span></div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Contributing Agents</div>
                 <div style="display:flex; flex-direction:column; gap:5px;">
                    <div style="font-size:0.75rem; color:#666;">System Core</div>
                </div>
            </div>
        </aside>
    </div>

    <textarea id="hidden-raw-data" style="display:none;">{
  "title": "House View: Energy Crisis & Geopolitics Outlook",
  "date": "2025-08-01",
  "summary": "Strategic allocation update for August 2025. The Energy Crisis & Geopolitics remains the dominant macro driver....",
  "type": "NEWSLETTER",
  "full_body": "<strong>Date:</strong> 2025-08-01\n<strong>Type:</strong> House_View\n<strong>Agent:</strong> RiskGuardian\n<h2>Executive Summary</h2>\nStrategic allocation update for August 2025. The Energy Crisis & Geopolitics remains the dominant macro driver.\n<h2>Analysis</h2>\nWe recommend adjusting exposure based on the Energy Crisis & Geopolitics. The Volatile environment suggests caution/opportunity.\n<h2>Key Metrics</h2>\n<ul>\n<li><strong>S&P 500:</strong> 5968</li>\n<li><strong>VIX:</strong> 14.75</li>\n<li><strong>10Y Treasury:</strong> 4.02%</li>\n</ul>\n<em>Generated by Adam v30.0 System Intelligence</em>\n",
  "sentiment_score": 25,
  "entities": {
    "tickers": [],
    "agents": [],
    "sovereigns": [],
    "keywords": [
      "AI",
      "Energy"
    ]
  },
  "provenance_hash": "d053131c4a02f58f1b898f5f453639e34a01fbc3d6af59a93c1409001aee43e1",
  "filename": "House_View_2025_08_01.html",
  "is_sourced": true,
  "metrics_json": "{}",
  "source_priority": 2,
  "conviction": 50,
  "critique": "Agent Market_Maker reviewed this intelligence. Verdict: SPECULATIVE. Sentiment alignment: 25/100. Cross-reference with knowledge graph completed.",
  "quality": 100,
  "semantic_score": 88,
  "probability": 50,
  "outlook_score": 10
}</textarea>

    <script>
        // Chart Injection Logic
        const metricsData = {};
        const crisisData = {"2008_LEHMAN": {"scenario": "2008_LEHMAN", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "market": [100.0, 93.16, 97.06, 85.78, 87.65, 82.36, 76.94, 73.34, 81.08, 71.87, 68.41, 68.13, 66.62, 61.71, 38.84, 37.59, 32.63, 34.26, 37.32, 36.48, 32.32, 32.4, 33.77, 33.99, 32.96, 33.13, 34.37, 36.33, 38.18, 37.86], "portfolio": [100.0, 94.07, 96.51, 88.13, 88.52, 87.47, 84.99, 80.15, 82.4, 76.42, 75.62, 73.54, 70.58, 67.75, 53.86, 51.43, 47.75, 46.8, 47.74, 50.02, 47.91, 46.47, 47.22, 47.79, 46.22, 46.57, 47.02, 48.63, 49.87, 49.47], "metrics": {"market": {"max_drawdown": 67.68, "volatility": 141.26, "total_return": -62.14}, "portfolio": {"max_drawdown": 53.78, "volatility": 77.8, "total_return": -50.53}}}, "1987_BLACK_MONDAY": {"scenario": "1987_BLACK_MONDAY", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], "market": [100.0, 84.8, 80.28, 68.87, 63.69, 72.03, 93.11, 107.15, 101.21, 73.47, 46.88, 42.8, 50.29, 48.77, 47.45, 41.68, 45.93, 48.7, 41.13, 35.67], "portfolio": [100.0, 90.78, 88.55, 80.89, 76.19, 81.31, 96.0, 101.5, 100.23, 80.59, 67.84, 62.7, 76.42, 76.61, 78.76, 72.28, 78.09, 80.84, 72.98, 65.93], "metrics": {"market": {"max_drawdown": 66.71, "volatility": 248.83, "total_return": -64.33}, "portfolio": {"max_drawdown": 38.23, "volatility": 165.54, "total_return": -34.07}}}, "2000_DOTCOM_BUBBLE": {"scenario": "2000_DOTCOM_BUBBLE", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45], "market": [100.0, 95.24, 103.68, 116.17, 108.27, 104.93, 102.5, 102.8, 102.37, 78.74, 80.52, 85.36, 77.8, 76.46, 71.48, 71.03, 74.84, 74.4, 77.38, 77.19, 73.04, 70.14, 67.93, 68.22, 68.02, 69.05, 63.35, 61.21, 60.14, 59.18, 58.01, 59.52, 60.22, 57.37, 56.0, 58.65, 52.3, 49.38, 48.46, 45.59, 44.23, 44.31, 44.92, 45.1, 44.34], "portfolio": [100.0, 100.01, 104.86, 114.42, 109.49, 105.75, 105.46, 108.82, 101.07, 83.58, 85.86, 85.07, 81.73, 88.5, 83.49, 86.16, 88.76, 90.53, 92.59, 94.87, 89.84, 88.75, 87.89, 88.42, 91.42, 90.3, 86.08, 83.93, 82.57, 78.81, 77.73, 81.26, 81.93, 80.05, 79.11, 81.42, 77.84, 74.32, 72.77, 69.34, 66.62, 67.6, 66.34, 67.09, 66.53], "metrics": {"market": {"max_drawdown": 61.93, "volatility": 87.41, "total_return": -55.66}, "portfolio": {"max_drawdown": 42.02, "volatility": 69.75, "total_return": -33.47}}}, "2020_COVID": {"scenario": "2020_COVID", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "market": [100.0, 104.0, 100.57, 96.79, 97.0, 94.53, 94.49, 91.63, 112.43, 116.35, 111.0, 106.3, 107.97, 109.98, 113.08, 123.46, 125.53, 122.61, 129.81, 109.71, 98.55, 88.4, 75.06, 68.42, 51.48, 52.29, 54.6, 63.46, 72.02, 68.25, 62.55, 63.38, 64.53, 68.38, 77.47, 78.03, 75.75, 68.94, 65.98, 68.59], "portfolio": [100.0, 103.25, 99.84, 96.49, 97.78, 95.88, 95.17, 95.89, 111.32, 113.02, 115.26, 113.69, 118.7, 119.46, 124.91, 129.18, 135.26, 134.36, 146.4, 146.58, 144.18, 141.46, 130.35, 119.11, 101.82, 107.98, 114.85, 123.1, 136.21, 124.42, 120.8, 117.57, 118.42, 125.32, 133.42, 131.66, 130.97, 122.75, 119.73, 122.75], "metrics": {"market": {"max_drawdown": 60.34, "volatility": 139.82, "total_return": -31.41}, "portfolio": {"max_drawdown": 30.54, "volatility": 90.19, "total_return": 22.75}}}, "2022_INFLATION_SHOCK": {"scenario": "2022_INFLATION_SHOCK", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "market": [100.0, 97.58, 98.24, 102.04, 103.39, 106.51, 105.61, 106.18, 103.09, 101.66, 101.07, 96.96, 98.03, 98.56, 98.93, 99.48, 92.31, 89.74, 89.51, 85.74, 78.61, 82.25, 72.25, 77.29, 76.38, 74.37, 75.33, 78.04, 75.64, 54.87, 45.95, 43.92, 43.79, 43.54, 43.61, 42.31, 42.09, 41.8, 39.95, 39.19, 38.76, 39.5, 39.25, 37.83, 38.03, 39.69, 37.48, 36.56, 36.59, 37.83, 38.83, 39.4, 37.13, 37.5, 36.18, 34.73, 34.92, 34.57, 32.83, 32.91], "portfolio": [100.0, 100.55, 104.79, 108.13, 109.62, 106.3, 106.82, 109.03, 110.2, 109.3, 109.28, 101.24, 100.08, 101.61, 101.43, 101.36, 98.54, 91.96, 93.78, 94.63, 84.7, 83.41, 79.6, 81.57, 82.89, 75.01, 76.54, 77.73, 77.01, 75.27, 65.08, 63.93, 63.25, 61.51, 61.14, 60.96, 60.43, 59.55, 58.1, 58.64, 55.0, 55.06, 53.72, 53.28, 54.65, 56.97, 55.84, 54.57, 51.92, 53.48, 56.03, 55.33, 53.07, 51.84, 48.79, 47.86, 48.49, 48.38, 46.95, 47.08], "metrics": {"market": {"max_drawdown": 69.18, "volatility": 81.12, "total_return": -67.09}, "portfolio": {"max_drawdown": 57.4, "volatility": 55.91, "total_return": -52.92}}}, "2025_AI_SHOCK": {"scenario": "2025_AI_SHOCK", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "market": [100.0, 108.57, 104.26, 104.85, 105.55, 114.17, 119.1, 113.66, 93.82, 103.79, 94.3, 101.31, 99.03, 107.2, 104.28, 95.33, 94.52, 75.22, 58.96, 54.66, 56.52, 61.89, 57.68, 58.48, 57.91, 57.34, 57.72, 56.54, 58.17, 50.79, 52.08, 45.25, 40.45, 40.01, 43.92], "portfolio": [100.0, 104.36, 100.43, 102.63, 104.29, 105.43, 107.27, 100.76, 94.55, 100.5, 98.34, 103.11, 102.42, 107.66, 102.03, 97.92, 93.4, 77.98, 69.63, 68.59, 71.49, 81.76, 78.25, 81.73, 87.14, 83.6, 83.21, 80.07, 81.67, 76.02, 76.39, 72.66, 67.5, 65.87, 72.18], "metrics": {"market": {"max_drawdown": 66.41, "volatility": 133.95, "total_return": -56.08}, "portfolio": {"max_drawdown": 38.82, "volatility": 94.67, "total_return": -27.82}}}};

        // --- Metrics Chart ---
        if (metricsData && Object.keys(metricsData).length > 0) {
            const ctx = document.getElementById('financialChart');
            const container = document.getElementById('financialChartContainer');

            // Basic parsing of metrics structure (assuming flat or Year->Val)
            let labels = [];
            let values = [];
            let labelName = "Metric";

            // Try to find a timeseries
            for (const [key, val] of Object.entries(metricsData)) {
                if (typeof val === 'object') {
                    // Likely year -> value
                    labels = Object.keys(val);
                    values = Object.values(val).map(v => parseFloat(v.replace(/[^0-9.-]/g, '')));
                    labelName = key;
                    break;
                }
            }

            if (labels.length > 0) {
                container.style.display = 'block';
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: labelName,
                            data: values,
                            backgroundColor: 'rgba(204, 0, 0, 0.5)',
                            borderColor: '#cc0000',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#ccc' } }
                        },
                        scales: {
                            y: { grid: { color: '#333' }, ticks: { color: '#888' } },
                            x: { grid: { color: '#333' }, ticks: { color: '#888' } }
                        }
                    }
                });
            }
        }

        // --- Crisis Simulation Logic ---
        let crisisChartInstance = null;

        window.renderCrisis = function(scenarioName) {
            if (!crisisData || !crisisData[scenarioName]) return;

            // UI Feedback for Buttons
            document.querySelectorAll('.crisis-btn').forEach(btn => {
                btn.style.borderColor = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#666';
                btn.style.color = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#ccc';
            });

            const data = crisisData[scenarioName];

            // Update Metrics Display
            if (data.metrics) {
                const p = data.metrics.portfolio;
                const m = data.metrics.market;

                document.getElementById('port_dd').innerText = p.max_drawdown.toFixed(2) + '%';
                document.getElementById('port_vol').innerText = p.volatility.toFixed(2) + '%';
                document.getElementById('port_ret').innerText = p.total_return.toFixed(2) + '%';

                // Color code return
                document.getElementById('port_ret').style.color = p.total_return >= 0 ? '#00f3ff' : '#ff4444';

                document.getElementById('mkt_dd').innerText = m.max_drawdown.toFixed(2) + '%';
                document.getElementById('mkt_vol').innerText = m.volatility.toFixed(2) + '%';
                document.getElementById('mkt_ret').innerText = m.total_return.toFixed(2) + '%';

                document.getElementById('mkt_ret').style.color = m.total_return >= 0 ? '#ccc' : '#cc0000';
            }

            const ctx = document.getElementById('crisisChart').getContext('2d');

            if (crisisChartInstance) {
                crisisChartInstance.destroy();
            }

            crisisChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'Your Portfolio (Simulated)',
                            data: data.portfolio,
                            borderColor: '#00f3ff',
                            backgroundColor: 'rgba(0, 243, 255, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 0
                        },
                        {
                            label: 'Market Benchmark',
                            data: data.market,
                            borderColor: '#666',
                            borderDash: [5, 5],
                            borderWidth: 1,
                            pointRadius: 0,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { labels: { color: '#ccc', font: { family: 'JetBrains Mono' } } },
                        title: {
                            display: true,
                            text: 'STRESS TEST SCENARIO: ' + scenarioName.replace(/_/g, ' '),
                            color: '#cc0000',
                            font: { family: 'JetBrains Mono' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#cc0000',
                            bodyColor: '#fff',
                            borderColor: '#333',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#333' },
                            ticks: { color: '#888', callback: function(value) { return value + '%'; } }
                        },
                        x: {
                            grid: { color: '#333' },
                            ticks: { display: false }
                        }
                    }
                }
            });
        };

        // Auto-Run Default Crisis if Data Available
        if (crisisData && Object.keys(crisisData).length > 0) {
            document.getElementById('crisisSimContainer').style.display = 'block';

            // Parse URL parameters for ?sim=SCENARIO_NAME
            const urlParams = new URLSearchParams(window.location.search);
            const simParam = urlParams.get('sim');

            // slight delay to ensure Chart.js loaded
            setTimeout(() => {
                if (simParam && crisisData[simParam]) {
                    renderCrisis(simParam);
                    // Scroll to container
                    document.getElementById('crisisSimContainer').scrollIntoView({ behavior: 'smooth' });
                } else {
                    renderCrisis('2008_LEHMAN');
                }
            }, 100);
        }
    </script>
</body>
</html>