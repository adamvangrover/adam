<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM | AVG Search</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --bg-dark: #020408;
            --panel-bg: rgba(15, 23, 42, 0.95);
            --border-color: #334155;
            --accent-cyan: #22d3ee;
            --accent-purple: #a855f7;
        }

        body {
            background-color: var(--bg-dark);
            color: #e2e8f0;
            font-family: 'Inter', sans-serif;
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        .glass-panel {
            background: var(--panel-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-color);
        }

        .scan-line {
            position: fixed; top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(to bottom, rgba(168, 85, 247, 0), rgba(168, 85, 247, 0.5), rgba(168, 85, 247, 0));
            opacity: 0.1; animation: scan 8s linear infinite; pointer-events: none; z-index: 50;
        }
        @keyframes scan { 0% { top: -10%; } 100% { top: 110%; } }

        .pulse-text { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

        /* Steps Animation */
        .pipeline-step {
            transition: all 0.5s ease;
            opacity: 0.5;
        }
        .pipeline-step.active {
            opacity: 1;
            transform: scale(1.02);
            border-color: var(--accent-cyan);
        }
    </style>
</head>
<body class="flex flex-col min-h-screen bg-[#050b14] relative overflow-x-hidden">
    <div class="scan-line"></div>

    <!-- Header -->
    <header class="h-16 border-b border-slate-700/50 flex items-center justify-between px-6 bg-[#0f172a]/90 backdrop-blur-md z-40 sticky top-0">
        <div class="flex items-center gap-4">
            <a href="index.html" class="text-slate-400 hover:text-white transition"><i class="fas fa-arrow-left"></i></a>
            <div class="w-8 h-8 bg-purple-900/50 rounded flex items-center justify-center border border-purple-500/30">
                <i class="fas fa-atom text-purple-400"></i>
            </div>
            <h1 class="text-xl font-bold tracking-tight mono">ADAM <span class="text-purple-400">AVG SEARCH</span> <span class="text-slate-500 font-normal">| AVG Hybrid Engine</span></h1>
        </div>

        <!-- Navigation Tabs -->
        <div class="flex gap-6 text-sm font-mono">
            <a href="avg_search.html" class="tab-active py-2">DASHBOARD</a>
            <a href="avg_schedule.html" class="tab-inactive py-2">OPTIMIZER</a>
            <a href="avg_market.html" class="tab-inactive py-2">MARKET SCAN</a>
        </div>

        <div class="flex items-center gap-4 text-xs font-mono">
             <span class="text-emerald-400"><i class="fas fa-check-circle mr-1"></i> OPTIMIZED</span>
             <div class="px-3 py-1 bg-purple-900/30 border border-purple-700 text-purple-400 rounded">
                <i class="fas fa-server mr-1"></i> SIMULATION RUNTIME
             </div>
        </div>
    </header>

    <main class="flex-1 p-6 grid grid-cols-12 gap-6 max-w-7xl mx-auto w-full">

        <!-- Left Column: Narrative & Pipeline Status -->
        <div class="col-span-12 lg:col-span-4 space-y-6">

            <!-- Context -->
            <div class="glass-panel p-6 rounded-lg relative overflow-hidden">
                <div class="absolute top-0 right-0 p-4 text-slate-700"><i class="fas fa-search text-4xl opacity-20"></i></div>
                <h2 class="text-lg font-bold text-purple-400 mono mb-4 border-b border-slate-700 pb-2">HYBRID INDEXING</h2>
                <div class="prose prose-invert prose-sm text-slate-300 font-light leading-relaxed">
                    <p class="mb-4">
                        <strong>AVG Search</strong> combines Quantum Annealing with classical AI optimization.
                    </p>
                    <p class="mb-4">
                        The quantum processor acts as a <span class="text-purple-400">Probabilistic Filter</span>, reducing a haystack of 10<sup>15</sup> items to a small batch of high-energy candidates.
                    </p>
                    <p>
                        A classical verification step then performs O(1) checks to identify the true needle.
                    </p>
                </div>
            </div>

            <!-- Pipeline Visualization -->
            <div class="glass-panel p-4 rounded-lg">
                <h3 class="text-xs font-bold text-slate-500 mono uppercase mb-3">Hybrid Pipeline Execution</h3>

                <div class="space-y-4">
                    <!-- Step 1 -->
                    <div class="pipeline-step active p-3 bg-slate-800/50 border border-slate-700 rounded flex items-center gap-3">
                        <div class="w-8 h-8 rounded-full bg-slate-900 flex items-center justify-center text-purple-400 border border-slate-700">1</div>
                        <div class="flex-1">
                            <div class="text-xs font-bold text-white">Quantum Optimization</div>
                            <div class="text-[10px] text-slate-400">Adam tuning annealing schedule</div>
                        </div>
                        <i class="fas fa-check text-emerald-500"></i>
                    </div>

                    <!-- Step 2 -->
                    <div class="pipeline-step active p-3 bg-slate-800/50 border border-slate-700 rounded flex items-center gap-3">
                        <div class="w-8 h-8 rounded-full bg-slate-900 flex items-center justify-center text-cyan-400 border border-slate-700">2</div>
                        <div class="flex-1">
                            <div class="text-xs font-bold text-white">Probabilistic Sampling</div>
                            <div class="text-[10px] text-slate-400">Collapsed into batch candidates</div>
                        </div>
                        <i class="fas fa-check text-emerald-500"></i>
                    </div>

                    <!-- Step 3 -->
                    <div class="pipeline-step active p-3 bg-slate-800/50 border border-slate-700 rounded flex items-center gap-3">
                        <div class="w-8 h-8 rounded-full bg-slate-900 flex items-center justify-center text-emerald-400 border border-slate-700">3</div>
                        <div class="flex-1">
                            <div class="text-xs font-bold text-white">Classical Verification</div>
                            <div class="text-[10px] text-slate-400">O(1) Oracle Check</div>
                        </div>
                        <i class="fas fa-check text-emerald-500"></i>
                    </div>
                </div>

                <div class="mt-4 pt-4 border-t border-slate-700/50">
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-slate-500">Total Pipeline Time</span>
                        <span class="text-white font-mono" id="pipeline-time">--</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span class="text-slate-500">Batch Reduction</span>
                        <span class="text-emerald-400 font-mono">10<sup>15</sup> &rarr; <span id="batch-size">--</span></span>
                    </div>
                </div>
            </div>

            <!-- Result Panel -->
             <div class="glass-panel p-4 rounded-lg bg-emerald-900/10 border-emerald-500/30">
                <h3 class="text-xs font-bold text-emerald-400 mono uppercase mb-3">Verified Target</h3>
                <div id="verified-result" class="text-sm font-mono text-white">
                    Scanning...
                </div>
            </div>

        </div>

        <!-- Right Column: Charts & Data -->
        <div class="col-span-12 lg:col-span-8 space-y-6">

            <!-- Schedule Chart -->
            <div class="glass-panel p-6 rounded-lg">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-lg font-bold text-white mono">AVG SCHEDULE OPTIMIZATION</h2>
                    <span class="text-xs font-mono bg-slate-800 px-2 py-1 rounded text-slate-400">Roland-Cerf Approximation</span>
                </div>
                <div class="h-64 relative">
                    <canvas id="scheduleChart"></canvas>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Raw Candidates -->
                <div class="glass-panel p-4 rounded-lg flex flex-col h-64">
                    <h3 class="text-xs font-bold text-slate-500 mono uppercase mb-3 flex justify-between">
                        <span>Raw Quantum Batch</span>
                        <span class="text-purple-400" id="batch-count">-- Items</span>
                    </h3>
                    <div class="overflow-y-auto custom-scrollbar flex-1 space-y-2 pr-2" id="raw-candidates-list">
                        <!-- Populated via JS -->
                    </div>
                </div>

                <!-- Market Intelligence -->
                <div class="glass-panel p-4 rounded-lg flex flex-col">
                    <h3 class="text-xs font-bold text-slate-500 mono uppercase mb-3">Market Intelligence</h3>
                    <div class="bg-slate-800/30 p-3 rounded flex flex-col justify-center flex-1">
                        <div class="flex justify-between items-end mb-2">
                            <span class="text-xs text-slate-400">Detected Anomalies</span>
                            <span class="text-xl font-bold text-white" id="anomaly-count">--</span>
                        </div>
                        <div class="space-y-1" id="anomalies-list">
                            <!-- Populated via JS -->
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-slate-700/30">
                        <div class="text-[10px] text-purple-300 uppercase mb-1">Enterprise Odds</div>
                        <div class="text-xl font-bold text-white mono" id="odds-display">--</div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        async function loadData() {
            try {
                const response = await fetch('data/quantum_search_data.json');
                const data = await response.json();
                renderDashboard(data);
            } catch (e) {
                console.error("Failed to load data:", e);
                document.getElementById('verified-result').innerText = "Simulation Data Unavailable";
            }
        }

        function renderDashboard(data) {
            // 1. Pipeline Metrics
            if(data.pipeline && data.pipeline.verification_metrics) {
                document.getElementById('pipeline-time').innerText = `~${data.pipeline.verification_metrics.total_verification_time}`;
                document.getElementById('batch-size').innerText = data.pipeline.verification_metrics.batch_size;
                document.getElementById('batch-count').innerText = data.pipeline.verification_metrics.batch_size;
            }

            // 2. Verified Result (Market Data or Encryption)
            const needle = data.pipeline.raw_candidates.find(c => c.status === "VERIFIED");
            if(needle) {
                const icon = needle.type === "MarketAnomaly" ? "fa-chart-line" : "fa-key";
                document.getElementById('verified-result').innerHTML = `
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded bg-emerald-900/50 flex items-center justify-center text-emerald-400">
                            <i class="fas ${icon} text-lg"></i>
                        </div>
                        <div>
                            <div class="text-white font-bold">${needle.type} Found</div>
                            <div class="text-slate-400 text-xs">${needle.details || needle.id}</div>
                        </div>
                    </div>
                `;
            }

            // 3. Raw Candidates List
            const listContainer = document.getElementById('raw-candidates-list');
            listContainer.innerHTML = data.pipeline.raw_candidates.map(c => {
                const isVerified = c.status === "VERIFIED";
                const colorClass = isVerified ? "text-emerald-400 border-emerald-500/50 bg-emerald-900/20" : "text-slate-400 border-slate-700 bg-slate-800/30 opacity-60";
                const icon = isVerified ? "fa-check-circle" : "fa-times-circle";

                return `
                <div class="flex items-center justify-between p-2 border rounded text-xs ${colorClass}">
                    <div class="font-mono truncate w-24">${c.id}</div>
                    <div class="flex items-center gap-2">
                        <span class="font-bold">${c.energy.toFixed(2)} E</span>
                        <i class="fas ${icon}"></i>
                    </div>
                </div>`;
            }).join('');

            // 4. Market Intelligence
            if(data.market_intelligence && data.market_intelligence.verified_anomalies) {
                document.getElementById('anomaly-count').innerText = data.market_intelligence.anomalies_detected;

                const anomaliesList = document.getElementById('anomalies-list');
                anomaliesList.innerHTML = data.market_intelligence.verified_anomalies.slice(0, 3).map(a => `
                    <div class="flex justify-between text-xs border-b border-slate-700/50 pb-1 last:border-0">
                        <span class="text-slate-400">${a.date}</span>
                        <span class="text-red-400 font-bold">${a.pct_change}% Vol</span>
                    </div>
                `).join('');
            }

            // 5. Odds
            document.getElementById('odds-display').innerText = data.metrics.enterprise_odds_display;

            // 6. Chart
            renderChart(data);
        }

        function renderChart(data) {
            const ctx = document.getElementById('scheduleChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.annealing_schedule.t.map(t => t.toFixed(2)),
                    datasets: [
                        {
                            label: 'A(t) [Initial]',
                            data: data.annealing_schedule.A,
                            borderColor: '#22d3ee',
                            backgroundColor: 'rgba(34, 211, 238, 0.1)',
                            borderWidth: 2, tension: 0.4, pointRadius: 0
                        },
                        {
                            label: 'B(t) [Problem]',
                            data: data.annealing_schedule.B,
                            borderColor: '#a855f7',
                            backgroundColor: 'rgba(168, 85, 247, 0.1)',
                            borderWidth: 2, tension: 0.4, pointRadius: 0
                        },
                        {
                            label: 'Linear Baseline',
                            data: data.annealing_schedule.t,
                            borderColor: '#475569',
                            borderWidth: 1, borderDash: [5, 5], pointRadius: 0, fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: {
                        legend: { labels: { color: '#94a3b8' } }
                    },
                    scales: {
                        y: { grid: { color: '#1e293b' }, ticks: { color: '#64748b' } },
                        x: { grid: { display: false }, ticks: { display: false } }
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>
