<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM v23.5 :: Market Mayhem Newsletter - October 23, 1987</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/market_mayhem_tiers.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/nav.js" defer></script>
    <script src="js/market_mayhem_viewer.js" defer></script>
</head>
<body class="tier-high">

    <!-- System 2 Verification Overlay -->
    <div id="system2-overlay" class="system2-overlay">
        <div class="system2-terminal">
            <div id="sys2-content"></div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="cyber-toast-container"></div>

    <!-- Raw Source Modal -->
    <div id="raw-source-modal" class="raw-source-modal">
        <div class="raw-source-header">
            <span>SOURCE_DATA.JSON</span>
            <span style="cursor:pointer; color:#cc0000;" onclick="toggleSource()">[CLOSE]</span>
        </div>
        <div class="raw-source-content" id="raw-source-content"></div>
    </div>

    <!-- Virtual Toolbar for High Tier -->
    <div class="doc-toolbar" style="display: flex;">
        <div class="toolbar-item" onclick="window.location.href='market_mayhem_archive.html'"><strong>FILE</strong></div>
        <div class="toolbar-item" onclick="toggleRedactionMode()">REDACT</div>
        <div class="toolbar-item" onclick="printReport()">PRINT</div>
        <div class="toolbar-item" onclick="shareReport()">SHARE</div>
        <div class="toolbar-item" onclick="downloadReport()">DOWNLOAD</div>
        <div class="toolbar-item" onclick="toggleTheme()">VIEW</div>
        <div class="toolbar-item" onclick="showToast('INSERT: PERMISSION DENIED')">INSERT</div>
        <div class="toolbar-item" onclick="showToast('FORMAT: LOCKED')">FORMAT</div>
        <div class="toolbar-item" onclick="runVerification()" style="color: #0078d7;"><strong>VERIFY</strong></div>
        <div style="flex-grow:1;"></div>
        <div class="toolbar-item" style="color:#666;">ADAM_V26_EDITOR</div>
    </div>

    <div style="max-width: 1400px; margin: 0 auto; padding: 10px 20px; display:flex; justify-content:space-between; align-items:center; display: none;">
        <a href="market_mayhem_archive.html" class="cyber-btn">&larr; RETURN TO ARCHIVE</a>
        <div style="font-family:'JetBrains Mono'; font-size:0.7rem; color:#666;">SECURE CONNECTION ESTABLISHED</div>
    </div>

    <div class="newsletter-wrapper">
        <div class="paper-sheet" id="paper-sheet">

            <!-- Top Secret Stamp -->
            <div id="top-secret-stamp" class="top-secret-stamp">TOP SECRET</div>

            <!-- High Tier Header UI -->
            <div class="doc-header-ui" style="display: flex;">
                <span id="verification-status">CONFIDENTIAL // SYSTEM 2 REVIEW</span>
                <span>1d50206b</span>
            </div>

            <div style="display:flex; justify-content:space-between; font-family:'JetBrains Mono'; font-size:0.8rem; color:#666; margin-bottom:20px; margin-top: 20px;">
                <span>1987-10-23</span>
                <span>ID: 1d50206b</span>
            </div>

            <h1 class="title">Market Mayhem Newsletter - October 23, 1987</h1>

            <!-- Metadata Panel for High Tier (Embedded in Doc) -->
            <div class="doc-metadata-panel" style="display: grid;">
                <div class="doc-metadata-item"><strong>Classification</strong>UNCLASSIFIED</div>
                <div class="doc-metadata-item"><strong>Conviction</strong>50/100</div>
                <div class="doc-metadata-item"><strong>Sentiment</strong>25/100</div>
                <div class="doc-metadata-item"><strong>Reviewer</strong>Sovereign_AI</div>
            </div>

            <div id="financialChartContainer" style="display:none; margin-bottom: 30px;">
                <canvas id="financialChart"></canvas>
            </div>

            <!-- Crisis Simulator (High Tier Only) -->
            <div id="crisisSimContainer" style="display:none; margin-bottom: 30px; border: 1px solid #cc0000; padding: 20px; background: rgba(50, 0, 0, 0.2);">
                <h3 style="color: #cc0000; margin-top: 0; font-family: 'JetBrains Mono'; border-bottom: 1px solid #cc0000; padding-bottom: 10px; margin-bottom: 20px;">CRISIS SIMULATOR // STRESS TEST</h3>

                <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                    <div class="crisis-btn" onclick="renderCrisis('2008_LEHMAN')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2008 LEHMAN
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('1987_BLACK_MONDAY')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        1987 BLACK MON
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2020_COVID')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2020 PANDEMIC
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2000_DOTCOM')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2000 DOTCOM
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2022_INFLATION')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2022 INFLATION
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2025_AI_SHOCK')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2025 AI SHOCK
                    </div>
                </div>

                <div style="height: 300px; position: relative;">
                    <canvas id="crisisChart"></canvas>
                </div>
                <div style="font-size: 0.7rem; color: #888; margin-top: 15px; font-style: italic;">
                    * Hypothetical performance based on portfolio beta and current risk profile. PAST PERFORMANCE IS NOT INDICATIVE OF FUTURE RESULTS.
                </div>
            </div>

            <div id="document-body">
                <h3>Your weekly guide to navigating the financial storms and spotting the sunshine!</h3>
<h2>Market Snapshot</h2>
<em>   <strong>S&P 500:</strong> 248 (-20% WoW) </em>[Rebounding from the Monday low]*
<em>   <strong>Dow Jones:</strong> 1,950 (-13% WoW) </em>[Down 508 points on Monday alone]*
<ul>
<li>  <strong>Nasdaq Composite:</strong> 330 (-15% WoW)</li>
<li>  <strong>Brent Crude Oil:</strong> $18.50 (-2% WoW)</li>
<li>  <strong>Gold:</strong> $475 (+3% WoW)</li>
</ul>
<em>   <strong>Treasury Yield (10Y):</strong> 9.00% </em>[Fell from 10.2% as flight to safety kicked in]*
<h2>Market Mayhem: Executive Summary</h2>
<ul>
<li>  <strong>Mood:</strong> <strong>"Shell-Shocked"</strong></li>
<li>  <strong>Driver:</strong> <strong>Program Trading</strong></li>
<li>  <strong>Theme:</strong> <strong>"Black Monday"</strong> — On October 19th, the Dow Jones Industrial Average fell 22.6% in a single day. 508 points. It was the largest one-day percentage drop in history.</li>
</ul>
<h2>Key News & Events (The "What Happened")</h2>
<p>1.  <strong>The Crash:</strong> Monday, Oct 19. Panic selling overwhelmed the specialists. "Portfolio Insurance" algorithms sold futures into a falling market, creating a feedback loop of doom.
2.  <strong>Greenspan Speaks:</strong> Newly appointed Fed Chair Alan Greenspan issued a terse one-sentence statement Tuesday morning: "The Federal Reserve... stands ready to serve as a source of liquidity to support the economic and financial system."
3.  <strong>Exchange Closures?</strong> Rumors swirled on Tuesday that the NYSE would close. It didn't, but many stocks didn't open for trading for hours due to order imbalances.
4.  <strong>Hong Kong Halts:</strong> The Hong Kong Stock Exchange closed for the rest of the week.
5.  <strong>Buybacks Announced:</strong> Corporations rushed to announce share buybacks to support their stock prices, putting a floor under the market by Wednesday.</p>
<h2>Top Investment Ideas (The "Alpha")</h2>
<h3>1. Blue Chip Value (Warren Buffett Style)</h3>
<ul>
<li>  <strong>Rationale:</strong> Did <strong>Coca-Cola</strong> or <strong>Gillette</strong> lose 20% of their future earnings power in 6 hours? No. Mr. Market is manic-depressive. It's a buying opportunity of a generation.</li>
<li>  <strong>Key Risks:</strong> A recession could follow (like 1929).</li>
</ul>
<h3>2. Bonds (The Pivot)</h3>
<ul>
<li>  <strong>Rationale:</strong> The crash likely kills the inflation scare. Yields at 10% are attractive if the economy slows.</li>
<li>  <strong>Key Risks:</strong> Inflation stays high.</li>
</ul>
<h2>Notable Signals & Rumors</h2>
<ul>
<li>  <strong>Signal:</strong> <strong>P/E Compression:</strong> The market P/E fell from 22x to 15x in two days. Valuation is finally reasonable.</li>
<li>  <strong>Whisper:</strong> "The computers did it. Expect Congress to ban 'Program Trading' and 'Index Arbitrage'."</li>
</ul>
<h2>Policy Impact & Geopolitical Outlook</h2>
<ul>
<li>  <strong>Central Banks:</strong> The Fed is flooding the system. Rates are heading lower. The "Greenspan Put" is born.</li>
<li>  <strong>Geopolitics:</strong> Tensions in the Persian Gulf (Iran attacking tankers) triggered the initial sell-off last week, but now domestic liquidity is the only story.</li>
</ul>
<h2>Deals & Corporate Actions</h2>
<ul>
<li>  <strong>M&A:</strong> <strong>Failed Deals.</strong> Arbitrageurs were wiped out. Many leveraged buyouts (LBOs) are being pulled or renegotiated.</li>
<li>  <strong>Corporate Action:</strong> <strong>Honeywell</strong>, <strong>Citicorp</strong>, and dozens of others announced massive buyback programs.</li>
</ul>
<h2>Earnings Watch (Next Week)</h2>
<ul>
<li>  <strong>Exxon (XOM):</strong> Will oil price volatility impact earnings?</li>
<li>  <strong>IBM:</strong> Can Big Blue lead the tech recovery?</li>
</ul>
<h2>Thematic Deep Dive: "The Failure of Portfolio Insurance"</h2>
<p>Wall Street thought it had conquered risk. "Portfolio Insurance" promised to limit downside by automatically shorting futures when stocks fell.</p>
<p>It worked in theory. In practice, when everyone tries to rush through the same exit door at the same time, the door jams. The liquidity wasn't there. Instead of hedging risk, the algorithms amplified it. Lesson: Financial engineering cannot eliminate systemic risk.</p>
<h2>Year Ahead Forecast</h2>
<strong>Cautiously Bullish.</strong> Unlike 1929, the Fed stepped in immediately. The banking system is solvent. We believe the "Great Bull Market" that started in 1982 is wounded but alive.
<h2>Quirky Sign-Off</h2>
<p>> "It's a buy signal when you see an investor jumping out of a window." — <em>Wall Street Adage (Dark Humor)</em></p>
<p>Keep your head when others are losing theirs.</p>
<p>---
<em>Disclaimer: This newsletter is for informational purposes only and does not constitute financial advice. Past performance is not indicative of future results. Do your own research before making any investment decisions.</em></p>

            </div>

            <!-- Provenance Log (All Tiers) -->
            <div class="provenance-log">
                <div class="log-entry">
                    <span>> HASH_CHECK</span>
                    <span style="color:var(--terminal-green);">1d50206b805a4967460ab5e7f0ae4c8b9c6dc94e558223d6832340279ef0764c</span>
                </div>
                <div class="log-entry">
                    <span>> SENTIMENT_SCAN</span>
                    <span>25 (DENSITY: 64)</span>
                </div>
                <div class="log-entry">
                    <span>> CONVICTION_LOCK</span>
                    <span>50%</span>
                </div>
                <div class="log-entry">
                    <span>> CRITIQUE_LOG</span>
                    <span>"Agent Sovereign_AI reviewed this intelligence. Verdict: HIGH_CONFIDENCE. Sentiment alignment: 25/100. Cross-reference with knowledge graph completed."</span>
                </div>
            </div>

            <a href="#" class="source-jump-btn" onclick="toggleSource(); return false;" title="View Source JSON">JUMP TO SOURCE</a>

            <div style="margin-top: 40px; border-top: 1px solid #ccc; padding-top: 20px; font-style: italic; color: #666;">
                End of Transmission.
            </div>
        </div>

        <aside class="cyber-sidebar">
            <div class="sidebar-widget">
                <div class="sidebar-title">Intelligence Metadata</div>
                <div class="stat-row"><span>DATE</span> <span class="stat-val">1987-10-23</span></div>
                <div class="stat-row"><span>TYPE</span> <span class="stat-val">NEWSLETTER</span></div>
                <div class="stat-row"><span>CLASS</span> <span class="stat-val">UNCLASSIFIED</span></div>
                <div class="stat-row"><span>PROVENANCE</span> <span class="stat-val" title="1d50206b805a4967460ab5e7f0ae4c8b9c6dc94e558223d6832340279ef0764c">1d50206b</span></div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Sentiment Analysis</div>
                <div class="stat-row"><span>SCORE</span> <span class="stat-val">25/100</span></div>
                <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 25%;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Detected Entities</div>
                <div class="tag-cloud">
                    <a href="market_mayhem_archive.html?search=US_FED" class="tag" style="text-decoration:none;">US_FED</a><a href="market_mayhem_archive.html?search=AI" class="tag" style="text-decoration:none; border-color:#666;">AI</a><a href="market_mayhem_archive.html?search=Banks" class="tag" style="text-decoration:none; border-color:#666;">Banks</a><a href="market_mayhem_archive.html?search=Bonds" class="tag" style="text-decoration:none; border-color:#666;">Bonds</a><a href="market_mayhem_archive.html?search=EV" class="tag" style="text-decoration:none; border-color:#666;">EV</a><a href="market_mayhem_archive.html?search=Gold" class="tag" style="text-decoration:none; border-color:#666;">Gold</a>
                </div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Agent Conviction</div>
                 <div class="stat-row"><span>CONFIDENCE</span> <span class="stat-val">50/100</span></div>
                 <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 50%; background: #ffff00;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Semantic Analysis</div>
                 <div class="stat-row"><span>DENSITY</span> <span class="stat-val">64/100</span></div>
                 <div class="stat-row"><span>PROBABILITY</span> <span class="stat-val">50/100</span></div>
            </div>

             <div class="sidebar-widget" style="border-color: #555;">
                <div class="sidebar-title">Reviewer Agent Log</div>
                 <div style="font-size: 0.75rem; color: #ccc; font-style: italic;">
                    "Agent Sovereign_AI reviewed this intelligence. Verdict: HIGH_CONFIDENCE. Sentiment alignment: 25/100. Cross-reference with knowledge graph completed."
                </div>
                <div class="stat-row" style="margin-top:10px;"><span>QUALITY SCORE</span> <span class="stat-val">100/100</span></div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Contributing Agents</div>
                 <div style="display:flex; flex-direction:column; gap:5px;">
                    <div style="font-size:0.75rem; color:#666;">System Core</div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Hidden Raw Data -->
    <textarea id="hidden-raw-data" style="display:none;">{
  "title": "Market Mayhem Newsletter - October 23, 1987",
  "date": "1987-10-23",
  "summary": "   Mood: \"Shell-Shocked\"\n   Driver: Program Trading\n   Theme: \"Black Monday\" \u2014 On October 19th, the Dow Jones Industrial Average fell 22.6% in a single day. 508 points. It was the largest one-day perc...",
  "type": "NEWSLETTER",
  "full_body": "<h3>Your weekly guide to navigating the financial storms and spotting the sunshine!</h3>\n<h2>Market Snapshot</h2>\n<em>   <strong>S&P 500:</strong> 248 (-20% WoW) </em>[Rebounding from the Monday low]*\n<em>   <strong>Dow Jones:</strong> 1,950 (-13% WoW) </em>[Down 508 points on Monday alone]*\n<ul>\n<li>  <strong>Nasdaq Composite:</strong> 330 (-15% WoW)</li>\n<li>  <strong>Brent Crude Oil:</strong> $18.50 (-2% WoW)</li>\n<li>  <strong>Gold:</strong> $475 (+3% WoW)</li>\n</ul>\n<em>   <strong>Treasury Yield (10Y):</strong> 9.00% </em>[Fell from 10.2% as flight to safety kicked in]*\n<h2>Market Mayhem: Executive Summary</h2>\n<ul>\n<li>  <strong>Mood:</strong> <strong>\"Shell-Shocked\"</strong></li>\n<li>  <strong>Driver:</strong> <strong>Program Trading</strong></li>\n<li>  <strong>Theme:</strong> <strong>\"Black Monday\"</strong> \u2014 On October 19th, the Dow Jones Industrial Average fell 22.6% in a single day. 508 points. It was the largest one-day percentage drop in history.</li>\n</ul>\n<h2>Key News & Events (The \"What Happened\")</h2>\n<p>1.  <strong>The Crash:</strong> Monday, Oct 19. Panic selling overwhelmed the specialists. \"Portfolio Insurance\" algorithms sold futures into a falling market, creating a feedback loop of doom.\n2.  <strong>Greenspan Speaks:</strong> Newly appointed Fed Chair Alan Greenspan issued a terse one-sentence statement Tuesday morning: \"The Federal Reserve... stands ready to serve as a source of liquidity to support the economic and financial system.\"\n3.  <strong>Exchange Closures?</strong> Rumors swirled on Tuesday that the NYSE would close. It didn't, but many stocks didn't open for trading for hours due to order imbalances.\n4.  <strong>Hong Kong Halts:</strong> The Hong Kong Stock Exchange closed for the rest of the week.\n5.  <strong>Buybacks Announced:</strong> Corporations rushed to announce share buybacks to support their stock prices, putting a floor under the market by Wednesday.</p>\n<h2>Top Investment Ideas (The \"Alpha\")</h2>\n<h3>1. Blue Chip Value (Warren Buffett Style)</h3>\n<ul>\n<li>  <strong>Rationale:</strong> Did <strong>Coca-Cola</strong> or <strong>Gillette</strong> lose 20% of their future earnings power in 6 hours? No. Mr. Market is manic-depressive. It's a buying opportunity of a generation.</li>\n<li>  <strong>Key Risks:</strong> A recession could follow (like 1929).</li>\n</ul>\n<h3>2. Bonds (The Pivot)</h3>\n<ul>\n<li>  <strong>Rationale:</strong> The crash likely kills the inflation scare. Yields at 10% are attractive if the economy slows.</li>\n<li>  <strong>Key Risks:</strong> Inflation stays high.</li>\n</ul>\n<h2>Notable Signals & Rumors</h2>\n<ul>\n<li>  <strong>Signal:</strong> <strong>P/E Compression:</strong> The market P/E fell from 22x to 15x in two days. Valuation is finally reasonable.</li>\n<li>  <strong>Whisper:</strong> \"The computers did it. Expect Congress to ban 'Program Trading' and 'Index Arbitrage'.\"</li>\n</ul>\n<h2>Policy Impact & Geopolitical Outlook</h2>\n<ul>\n<li>  <strong>Central Banks:</strong> The Fed is flooding the system. Rates are heading lower. The \"Greenspan Put\" is born.</li>\n<li>  <strong>Geopolitics:</strong> Tensions in the Persian Gulf (Iran attacking tankers) triggered the initial sell-off last week, but now domestic liquidity is the only story.</li>\n</ul>\n<h2>Deals & Corporate Actions</h2>\n<ul>\n<li>  <strong>M&A:</strong> <strong>Failed Deals.</strong> Arbitrageurs were wiped out. Many leveraged buyouts (LBOs) are being pulled or renegotiated.</li>\n<li>  <strong>Corporate Action:</strong> <strong>Honeywell</strong>, <strong>Citicorp</strong>, and dozens of others announced massive buyback programs.</li>\n</ul>\n<h2>Earnings Watch (Next Week)</h2>\n<ul>\n<li>  <strong>Exxon (XOM):</strong> Will oil price volatility impact earnings?</li>\n<li>  <strong>IBM:</strong> Can Big Blue lead the tech recovery?</li>\n</ul>\n<h2>Thematic Deep Dive: \"The Failure of Portfolio Insurance\"</h2>\n<p>Wall Street thought it had conquered risk. \"Portfolio Insurance\" promised to limit downside by automatically shorting futures when stocks fell.</p>\n<p>It worked in theory. In practice, when everyone tries to rush through the same exit door at the same time, the door jams. The liquidity wasn't there. Instead of hedging risk, the algorithms amplified it. Lesson: Financial engineering cannot eliminate systemic risk.</p>\n<h2>Year Ahead Forecast</h2>\n<strong>Cautiously Bullish.</strong> Unlike 1929, the Fed stepped in immediately. The banking system is solvent. We believe the \"Great Bull Market\" that started in 1982 is wounded but alive.\n<h2>Quirky Sign-Off</h2>\n<p>> \"It's a buy signal when you see an investor jumping out of a window.\" \u2014 <em>Wall Street Adage (Dark Humor)</em></p>\n<p>Keep your head when others are losing theirs.</p>\n<p>---\n<em>Disclaimer: This newsletter is for informational purposes only and does not constitute financial advice. Past performance is not indicative of future results. Do your own research before making any investment decisions.</em></p>\n",
  "sentiment_score": 25,
  "entities": {
    "tickers": [],
    "agents": [],
    "sovereigns": [
      "US_FED"
    ],
    "keywords": [
      "AI",
      "Banks",
      "Bonds",
      "EV",
      "Gold"
    ]
  },
  "provenance_hash": "1d50206b805a4967460ab5e7f0ae4c8b9c6dc94e558223d6832340279ef0764c",
  "filename": "1987-10-23_Market_Mayhem.html",
  "is_sourced": true,
  "metrics_json": "{}",
  "source_priority": 2,
  "conviction": 50,
  "critique": "Agent Sovereign_AI reviewed this intelligence. Verdict: HIGH_CONFIDENCE. Sentiment alignment: 25/100. Cross-reference with knowledge graph completed.",
  "quality": 100,
  "semantic_score": 64,
  "probability": 50,
  "outlook_score": 28
}</textarea>

    <script>
        // Chart Injection Logic
        const metricsData = {};
        const crisisData = {"2008_LEHMAN": {"scenario": "2008_LEHMAN", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "market": [100.0, 103.4, 96.84, 89.73, 86.25, 90.95, 92.74, 87.27, 88.84, 84.51, 90.01, 89.85, 79.75, 84.12, 71.05, 57.26, 57.7, 64.46, 64.06, 56.55, 57.86, 59.08, 60.76, 60.2, 54.67, 47.99, 51.1, 50.12, 47.5, 50.63], "portfolio": [100.0, 101.64, 100.41, 94.21, 93.36, 95.8, 94.29, 95.21, 95.73, 94.18, 99.62, 94.46, 91.48, 97.29, 90.83, 83.3, 84.49, 91.87, 88.28, 82.68, 84.62, 86.94, 85.19, 82.91, 78.17, 74.34, 75.81, 75.22, 74.87, 76.83]}, "1987_BLACK_MONDAY": {"scenario": "1987_BLACK_MONDAY", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], "market": [100.0, 98.36, 94.08, 82.06, 81.34, 91.47, 82.64, 81.44, 86.63, 17.75, 16.67, 17.53, 17.33, 18.76, 19.45, 17.77, 19.82, 13.16, 12.82, 11.46], "portfolio": [100.0, 96.3, 95.06, 90.87, 91.4, 91.09, 87.98, 88.65, 96.0, 37.68, 36.34, 38.74, 38.96, 43.35, 44.3, 41.36, 44.69, 35.64, 35.43, 33.45]}, "2020_COVID": {"scenario": "2020_COVID", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "market": [100.0, 103.84, 106.77, 93.54, 96.68, 97.17, 101.34, 98.85, 99.84, 110.46, 106.34, 120.66, 130.24, 123.77, 122.34, 119.12, 114.09, 108.63, 107.6, 113.71, 121.4, 121.07, 103.68, 86.46, 88.15, 102.99, 103.71, 95.0, 99.31, 91.11, 97.83, 89.55, 99.54, 99.77, 96.87, 110.59, 120.64, 119.21, 126.63, 137.86], "portfolio": [100.0, 102.41, 102.41, 94.47, 96.36, 98.06, 100.06, 98.83, 101.62, 106.15, 105.93, 116.26, 121.49, 116.06, 119.65, 116.07, 114.51, 111.12, 109.0, 115.07, 122.08, 115.7, 110.41, 94.05, 101.05, 112.75, 118.06, 113.05, 118.91, 112.94, 114.08, 110.83, 122.23, 123.55, 122.95, 131.31, 141.59, 141.22, 139.16, 146.33]}, "2000_DOTCOM": {"scenario": "2000_DOTCOM", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "market": [100.0, 92.62, 89.04, 92.06, 86.57, 89.14, 83.51, 83.91, 83.5, 80.3, 86.1, 74.61, 79.4, 78.37, 82.18, 81.24, 81.11, 90.89, 93.74, 98.29, 92.59, 97.22, 94.6, 95.12, 99.43, 106.19, 114.87, 110.22, 106.08, 68.7, 66.0, 70.48, 60.81, 58.26, 61.63, 63.57, 63.28, 65.64, 56.6, 57.66, 52.28, 52.58, 53.59, 56.47, 55.42, 59.31, 56.61, 58.32, 54.79, 57.55, 55.11, 52.99, 53.49, 50.62, 56.03, 56.95, 59.43, 60.21, 57.91, 57.79], "portfolio": [100.0, 96.09, 93.07, 93.73, 90.98, 89.5, 85.96, 87.42, 90.71, 89.81, 92.01, 83.3, 87.89, 88.38, 90.03, 86.91, 87.07, 93.34, 90.64, 93.09, 88.05, 93.47, 91.92, 88.63, 92.94, 93.34, 99.25, 99.4, 94.14, 74.68, 75.11, 79.89, 75.43, 71.42, 73.64, 68.44, 65.91, 69.96, 67.08, 68.82, 65.39, 64.57, 65.04, 68.81, 68.6, 71.78, 70.01, 71.17, 70.77, 71.81, 70.06, 67.88, 68.85, 67.53, 72.39, 71.04, 71.97, 74.72, 72.05, 70.66]}, "2022_INFLATION": {"scenario": "2022_INFLATION", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50], "market": [100.0, 98.94, 96.4, 93.79, 88.2, 91.52, 90.21, 90.88, 93.59, 93.81, 92.69, 92.98, 93.05, 92.8, 86.09, 85.76, 84.26, 90.33, 85.25, 85.32, 80.62, 77.77, 79.79, 83.21, 79.08, 78.58, 75.3, 68.05, 66.03, 68.4, 68.05, 67.16, 69.07, 71.37, 72.52, 69.78, 67.24, 67.48, 70.57, 68.8, 69.27, 69.3, 68.84, 64.92, 64.7, 62.41, 63.65, 63.75, 64.52, 66.11], "portfolio": [100.0, 99.77, 96.5, 93.58, 88.88, 89.52, 87.44, 87.18, 89.87, 93.88, 90.8, 90.65, 92.7, 93.27, 88.24, 90.98, 90.82, 97.66, 91.28, 90.8, 86.76, 79.4, 79.38, 81.41, 73.52, 74.31, 73.79, 70.28, 70.15, 68.37, 66.51, 64.29, 64.44, 68.58, 70.17, 67.02, 68.87, 65.72, 66.84, 67.85, 69.55, 68.98, 69.33, 67.3, 65.46, 64.88, 65.88, 66.23, 68.28, 70.03]}, "2025_AI_SHOCK": {"scenario": "2025_AI_SHOCK", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "market": [100.0, 92.37, 86.39, 71.5, 74.37, 70.39, 78.2, 78.91, 71.37, 82.26, 67.86, 67.93, 76.62, 75.94, 64.41, 57.64, 55.23, 46.22, 49.82, 56.56, 56.64, 54.3, 53.54, 41.68, 41.49, 42.63, 41.36, 45.48, 38.25, 36.92, 38.09, 39.11, 39.03, 37.83, 35.45], "portfolio": [100.0, 96.97, 91.6, 82.64, 88.3, 87.96, 90.82, 91.13, 86.84, 95.22, 82.44, 80.31, 84.27, 85.38, 81.35, 73.13, 69.66, 66.14, 69.83, 70.2, 67.42, 62.89, 60.35, 51.86, 49.23, 49.1, 48.56, 53.0, 49.43, 47.05, 47.83, 49.7, 47.55, 45.96, 44.23]}};

        // --- Metrics Chart ---
        if (metricsData && Object.keys(metricsData).length > 0) {
            const ctx = document.getElementById('financialChart');
            const container = document.getElementById('financialChartContainer');

            // Basic parsing of metrics structure (assuming flat or Year->Val)
            let labels = [];
            let values = [];
            let labelName = "Metric";

            // Try to find a timeseries
            for (const [key, val] of Object.entries(metricsData)) {
                if (typeof val === 'object') {
                    // Likely year -> value
                    labels = Object.keys(val);
                    values = Object.values(val).map(v => parseFloat(v.replace(/[^0-9.-]/g, '')));
                    labelName = key;
                    break;
                }
            }

            if (labels.length > 0) {
                container.style.display = 'block';
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: labelName,
                            data: values,
                            backgroundColor: 'rgba(204, 0, 0, 0.5)',
                            borderColor: '#cc0000',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#ccc' } }
                        },
                        scales: {
                            y: { grid: { color: '#333' }, ticks: { color: '#888' } },
                            x: { grid: { color: '#333' }, ticks: { color: '#888' } }
                        }
                    }
                });
            }
        }

        // --- Crisis Simulation Logic ---
        let crisisChartInstance = null;

        window.renderCrisis = function(scenarioName) {
            if (!crisisData || !crisisData[scenarioName]) return;

            // UI Feedback for Buttons
            document.querySelectorAll('.crisis-btn').forEach(btn => {
                btn.style.borderColor = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#666';
                btn.style.color = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#ccc';
            });

            const data = crisisData[scenarioName];
            const ctx = document.getElementById('crisisChart').getContext('2d');

            if (crisisChartInstance) {
                crisisChartInstance.destroy();
            }

            crisisChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'Your Portfolio (Simulated)',
                            data: data.portfolio,
                            borderColor: '#00f3ff',
                            backgroundColor: 'rgba(0, 243, 255, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 0
                        },
                        {
                            label: 'Market Benchmark',
                            data: data.market,
                            borderColor: '#666',
                            borderDash: [5, 5],
                            borderWidth: 1,
                            pointRadius: 0,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { labels: { color: '#ccc', font: { family: 'JetBrains Mono' } } },
                        title: {
                            display: true,
                            text: 'STRESS TEST SCENARIO: ' + scenarioName.replace(/_/g, ' '),
                            color: '#cc0000',
                            font: { family: 'JetBrains Mono' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#cc0000',
                            bodyColor: '#fff',
                            borderColor: '#333',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#333' },
                            ticks: { color: '#888', callback: function(value) { return value + '%'; } }
                        },
                        x: {
                            grid: { color: '#333' },
                            ticks: { display: false }
                        }
                    }
                }
            });
        };

        // Auto-Run Default Crisis if Data Available
        if (crisisData && Object.keys(crisisData).length > 0) {
            document.getElementById('crisisSimContainer').style.display = 'block';
            // slight delay to ensure Chart.js loaded
            setTimeout(() => renderCrisis('2008_LEHMAN'), 100);
        }
    </script>
</body>
</html>
