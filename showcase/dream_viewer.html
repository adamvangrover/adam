<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dream Viewer // Nightmare Simulation</title>
    <style>
        body { background-color: #050510; color: #ccf; font-family: 'Courier New', monospace; margin: 0; padding: 20px; }
        h1 { color: #aaddff; border-bottom: 2px solid #336699; padding-bottom: 10px; }

        .dream-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }

        .dream-card { background: #0a0a1a; border: 1px solid #223355; padding: 15px; border-radius: 8px; transition: transform 0.2s; }
        .dream-card:hover { transform: translateY(-5px); border-color: #4488ff; box-shadow: 0 0 15px rgba(68, 136, 255, 0.2); }

        .scenario-title { font-size: 18px; font-weight: bold; color: #fff; margin-bottom: 5px; }
        .scenario-type { font-size: 12px; color: #ff5555; text-transform: uppercase; letter-spacing: 1px; border: 1px solid #552222; padding: 2px 5px; display: inline-block; margin-bottom: 10px; }

        .outcome { font-weight: bold; margin: 10px 0; font-size: 20px; }
        .outcome.survived { color: #00ff88; }
        .outcome.failed { color: #ff3333; }

        .steps { margin-top: 10px; border-top: 1px dashed #334466; padding-top: 10px; font-size: 13px; color: #8899aa; }
        .step-item { margin-bottom: 5px; padding-left: 10px; border-left: 2px solid #334466; }

        .prob-bar { background: #112233; height: 5px; width: 100%; margin-top: 10px; border-radius: 2px; overflow: hidden; }
        .prob-fill { height: 100%; background: #00ff88; width: 0%; transition: width 1s; }
    </style>
</head>
<body>
    <h1>PROJECT OMEGA // DREAM CYCLE</h1>
    <p>Adversarial Simulation Journal | Status: <span style="color:#00ff88">ONLINE</span></p>

    <div class="dream-container" id="dreams">
        <div>Loading nightmares...</div>
    </div>

    <script>
        async function loadDreams() {
            try {
                const response = await fetch('data/dream_journal.json');
                const dreams = await response.json();
                renderDreams(dreams.reverse()); // Newest first
            } catch (e) {
                document.getElementById('dreams').innerHTML = `Error: ${e.message}`;
            }
        }

        function renderDreams(dreams) {
            const container = document.getElementById('dreams');
            container.innerHTML = '';

            dreams.forEach(dream => {
                const sc = dream.scenario;
                const sol = dream.solution;
                const date = new Date(dream.timestamp * 1000).toLocaleString();
                const prob = (sol.survival_probability * 100).toFixed(1);

                const el = document.createElement('div');
                el.className = 'dream-card';
                el.innerHTML = `
                    <div class="scenario-type">${sc.type}</div>
                    <div class="scenario-title">${sc.name}</div>
                    <div style="font-size:12px; margin-bottom:10px;">${sc.description}</div>

                    <div class="outcome ${dream.outcome.toLowerCase()}">
                        ${dream.outcome}
                    </div>

                    <div>Survival Probability: ${prob}%</div>
                    <div class="prob-bar">
                        <div class="prob-fill" style="width: ${prob}%; background-color: ${dream.outcome === 'FAILED' ? '#ff3333' : '#00ff88'}"></div>
                    </div>

                    <div class="steps">
                        <strong>Strategy:</strong><br>
                        ${sol.steps.map(s => `<div class="step-item">${s}</div>`).join('')}
                    </div>

                    <div style="font-size:10px; color:#556677; margin-top:10px; text-align:right;">
                        ${date} | Duration: ${dream.duration.toFixed(2)}s
                    </div>
                `;
                container.appendChild(el);
            });
        }

        loadDreams();
    </script>
</body>
</html>
