<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM v23.5 :: MARKET MAYHEM: CRYPTO WINTER & CELSIUS FREEZE</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/market_mayhem_tiers.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/nav.js" defer></script>
    <script src="js/market_mayhem_viewer.js" defer></script>
</head>
<body class="tier-high">

    <div id="system2-overlay" class="system2-overlay">
        <div class="system2-terminal">
            <div id="sys2-content"></div>
        </div>
    </div>

    <div id="toast-container" class="cyber-toast-container"></div>

    <div id="raw-source-modal" class="raw-source-modal">
        <div class="raw-source-header">
            <span>SOURCE_DATA.JSON</span>
            <span style="cursor:pointer; color:#cc0000;" onclick="toggleSource()">[CLOSE]</span>
        </div>
        <div class="raw-source-content" id="raw-source-content"></div>
    </div>

    <div class="doc-toolbar" style="display: flex;">
        <div class="toolbar-item" onclick="window.location.href='market_mayhem_archive_v24.html'"><strong>FILE</strong></div>
        <div class="toolbar-item" onclick="toggleRedactionMode()">REDACT</div>
        <div class="toolbar-item" onclick="printReport()">PRINT</div>
        <div class="toolbar-item" onclick="shareReport()">SHARE</div>
        <div class="toolbar-item" onclick="downloadReport()">DOWNLOAD</div>
        <div class="toolbar-item" onclick="toggleTheme()">VIEW</div>
        <div class="toolbar-item" onclick="showToast('INSERT: PERMISSION DENIED')">INSERT</div>
        <div class="toolbar-item" onclick="showToast('FORMAT: LOCKED')">FORMAT</div>
        <div class="toolbar-item" onclick="runVerification()" style="color: #0078d7;"><strong>VERIFY</strong></div>
        <div style="flex-grow:1;"></div>
        <div class="toolbar-item" style="color:#666;">ADAM_V26_EDITOR</div>
    </div>

    <div style="max-width: 1400px; margin: 0 auto; padding: 10px 20px; display:flex; justify-content:space-between; align-items:center; display: none;">
        <a href="market_mayhem_archive_v24.html" class="cyber-btn">&larr; RETURN TO ARCHIVE</a>
        <div style="font-family:'JetBrains Mono'; font-size:0.7rem; color:#666;">SECURE CONNECTION ESTABLISHED</div>
    </div>

    <div class="newsletter-wrapper">
        <div class="paper-sheet" id="paper-sheet">

            <div id="top-secret-stamp" class="top-secret-stamp">TOP SECRET</div>

            <div class="doc-header-ui" style="display: flex;">
                <span id="verification-status">CONFIDENTIAL // SYSTEM 2 REVIEW</span>
                <span>8ff5041d</span>
            </div>

            <div style="display:flex; justify-content:space-between; font-family:'JetBrains Mono'; font-size:0.8rem; color:#666; margin-bottom:20px; margin-top: 20px;">
                <span>2022-06-13</span>
                <span>ID: 8ff5041d</span>
            </div>

            <h1 class="title">MARKET MAYHEM: CRYPTO WINTER & CELSIUS FREEZE</h1>

            <div class="doc-metadata-panel" style="display: grid;">
                <div class="doc-metadata-item"><strong>Classification</strong>UNCLASSIFIED</div>
                <div class="doc-metadata-item"><strong>Conviction</strong>50/100</div>
                <div class="doc-metadata-item"><strong>Sentiment</strong>75/100</div>
                <div class="doc-metadata-item"><strong>Reviewer</strong>Overseer</div>
            </div>

            <div id="financialChartContainer" style="display:none; margin-bottom: 30px;">
                <canvas id="financialChart"></canvas>
            </div>

            <div id="crisisSimContainer" style="display:none; margin-bottom: 30px; border: 1px solid #cc0000; padding: 20px; background: rgba(50, 0, 0, 0.2);">
                <h3 style="color: #cc0000; margin-top: 0; font-family: 'JetBrains Mono'; border-bottom: 1px solid #cc0000; padding-bottom: 10px; margin-bottom: 20px;">CRISIS SIMULATOR // STRESS TEST</h3>

                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 20px;">
                    <div class="crisis-btn" onclick="renderCrisis('2008_LEHMAN')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2008 LEHMAN
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('1987_BLACK_MONDAY')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        1987 BLACK MON
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2000_DOTCOM_BUBBLE')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2000 DOTCOM
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2020_COVID')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2020 PANDEMIC
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2022_INFLATION_SHOCK')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2022 INFLATION
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2025_AI_SHOCK')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2025 AI SHOCK
                    </div>
                </div>

                <div style="height: 300px; position: relative;">
                    <canvas id="crisisChart"></canvas>
                </div>

                <div id="crisisMetrics" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; font-family: 'JetBrains Mono'; font-size: 0.8rem; color: #ccc;">
                    <div style="border: 1px solid #00f3ff; padding: 10px; background: rgba(0, 243, 255, 0.05);">
                        <div style="color: #00f3ff; border-bottom: 1px solid #00f3ff; margin-bottom: 10px; padding-bottom: 5px; font-weight: bold;">PORTFOLIO PERFORMANCE</div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>MAX DRAWDOWN:</span> <span id="port_dd" style="color: #fff;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>VOLATILITY (ANN):</span> <span id="port_vol" style="color: #fff;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between;"><span>TOTAL RETURN:</span> <span id="port_ret" style="color: #fff;">0.00%</span></div>
                    </div>
                    <div style="border: 1px solid #666; padding: 10px; background: rgba(100, 100, 100, 0.1);">
                        <div style="color: #888; border-bottom: 1px solid #666; margin-bottom: 10px; padding-bottom: 5px; font-weight: bold;">MARKET BENCHMARK</div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>MAX DRAWDOWN:</span> <span id="mkt_dd" style="color: #ccc;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>VOLATILITY (ANN):</span> <span id="mkt_vol" style="color: #ccc;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between;"><span>TOTAL RETURN:</span> <span id="mkt_ret" style="color: #ccc;">0.00%</span></div>
                    </div>
                </div>

                <div style="font-size: 0.7rem; color: #888; margin-top: 15px; font-style: italic;">
                    * Hypothetical performance based on portfolio beta and current risk profile. PAST PERFORMANCE IS NOT INDICATIVE OF FUTURE RESULTS.
                </div>
            </div>

            <div id="document-body">
                <p><strong>The Bank Run.</strong> Celsius, offering 18% yields on deposits, is facing a liquidity crisis. They have frozen billions in user assets. The contagion is spreading to Three Arrows Capital (3AC) and BlockFi.</p>
<p><strong>De-Pegging:</strong> The collapse of Terra/Luna just a month ago destroyed $40B in value. Now, the centralized lenders are falling dominoes. The 'stETH' peg is under pressure.</p>
<p><strong>The Purge:</strong> This is the 2008 moment for Crypto. Leverage is being flushed out violently. 'Not your keys, not your coins' is the painful lesson being learned by millions.</p>
            </div>

            <div class="provenance-log">
                <div class="log-entry">
                    <span>> HASH_CHECK</span>
                    <span style="color:var(--terminal-green);">8ff5041d67b537beed3af3c7e426627387bb22695c0f6aaa3c27c62e0edff1ca</span>
                </div>
                <div class="log-entry">
                    <span>> SENTIMENT_SCAN</span>
                    <span>75 (DENSITY: 72)</span>
                </div>
                <div class="log-entry">
                    <span>> CONVICTION_LOCK</span>
                    <span>50%</span>
                </div>
                <div class="log-entry">
                    <span>> CRITIQUE_LOG</span>
                    <span>"Agent Overseer reviewed this intelligence. Verdict: VALIDATED. Sentiment alignment: 75/100. Cross-reference with knowledge graph completed."</span>
                </div>
            </div>

            <a href="#" class="source-jump-btn" onclick="toggleSource(); return false;" title="View Source JSON">JUMP TO SOURCE</a>

            <div style="margin-top: 40px; border-top: 1px solid #ccc; padding-top: 20px; font-style: italic; color: #666;">
                End of Transmission.
            </div>
        </div>

        <aside class="cyber-sidebar">
            <div class="sidebar-widget">
                <div class="sidebar-title">Intelligence Metadata</div>
                <div class="stat-row"><span>DATE</span> <span class="stat-val">2022-06-13</span></div>
                <div class="stat-row"><span>TYPE</span> <span class="stat-val">HISTORICAL</span></div>
                <div class="stat-row"><span>CLASS</span> <span class="stat-val">UNCLASSIFIED</span></div>
                <div class="stat-row"><span>PROVENANCE</span> <span class="stat-val" title="8ff5041d67b537beed3af3c7e426627387bb22695c0f6aaa3c27c62e0edff1ca">8ff5041d</span></div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Sentiment Analysis</div>
                <div class="stat-row"><span>SCORE</span> <span class="stat-val">75/100</span></div>
                <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 75%;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Detected Entities</div>
                <div class="tag-cloud">
                    <a href="market_mayhem_archive_v24.html?search=US_FED" class="tag" style="text-decoration:none;">US_FED</a><a href="market_mayhem_archive_v24.html?search=AI" class="tag" style="text-decoration:none; border-color:#666;">AI</a><a href="market_mayhem_archive_v24.html?search=Bitcoin" class="tag" style="text-decoration:none; border-color:#666;">Bitcoin</a><a href="market_mayhem_archive_v24.html?search=Crypto" class="tag" style="text-decoration:none; border-color:#666;">Crypto</a><a href="market_mayhem_archive_v24.html?search=EV" class="tag" style="text-decoration:none; border-color:#666;">EV</a><a href="market_mayhem_archive_v24.html?search=Value" class="tag" style="text-decoration:none; border-color:#666;">Value</a>
                </div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Agent Conviction</div>
                 <div class="stat-row"><span>CONFIDENCE</span> <span class="stat-val">50/100</span></div>
                 <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 50%; background: #ffff00;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Semantic Analysis</div>
                 <div class="stat-row"><span>DENSITY</span> <span class="stat-val">72/100</span></div>
                 <div class="stat-row"><span>PROBABILITY</span> <span class="stat-val">50/100</span></div>
            </div>

             <div class="sidebar-widget" style="border-color: #555;">
                <div class="sidebar-title">Reviewer Agent Log</div>
                 <div style="font-size: 0.75rem; color: #ccc; font-style: italic;">
                    "Agent Overseer reviewed this intelligence. Verdict: VALIDATED. Sentiment alignment: 75/100. Cross-reference with knowledge graph completed."
                </div>
                <div class="stat-row" style="margin-top:10px;"><span>QUALITY SCORE</span> <span class="stat-val">100/100</span></div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Contributing Agents</div>
                 <div style="display:flex; flex-direction:column; gap:5px;">
                    <div style="font-size:0.75rem; color:#666;">System Core</div>
                </div>
            </div>
        </aside>
    </div>

    <textarea id="hidden-raw-data" style="display:none;">{
  "date": "2022-06-13",
  "title": "MARKET MAYHEM: CRYPTO WINTER & CELSIUS FREEZE",
  "summary": "\"Withdrawals Paused\". The crypto lending platform Celsius Network has halted all withdrawals due to 'extreme market conditions'. Bitcoin plunges below $23k.",
  "type": "HISTORICAL",
  "filename": "newsletter_market_mayhem_jun_2022.html",
  "is_sourced": true,
  "full_body": "<p><strong>The Bank Run.</strong> Celsius, offering 18% yields on deposits, is facing a liquidity crisis. They have frozen billions in user assets. The contagion is spreading to Three Arrows Capital (3AC) and BlockFi.</p>\n<p><strong>De-Pegging:</strong> The collapse of Terra/Luna just a month ago destroyed $40B in value. Now, the centralized lenders are falling dominoes. The 'stETH' peg is under pressure.</p>\n<p><strong>The Purge:</strong> This is the 2008 moment for Crypto. Leverage is being flushed out violently. 'Not your keys, not your coins' is the painful lesson being learned by millions.</p>",
  "source_priority": 3,
  "sentiment_score": 75,
  "entities": {
    "tickers": [],
    "agents": [],
    "sovereigns": [
      "US_FED"
    ],
    "keywords": [
      "AI",
      "Bitcoin",
      "Crypto",
      "EV",
      "Value"
    ]
  },
  "provenance_hash": "8ff5041d67b537beed3af3c7e426627387bb22695c0f6aaa3c27c62e0edff1ca",
  "metrics_json": "{}",
  "conviction": 50,
  "semantic_score": 72,
  "probability": 50,
  "outlook_score": 10,
  "critique": "Agent Overseer reviewed this intelligence. Verdict: VALIDATED. Sentiment alignment: 75/100. Cross-reference with knowledge graph completed."
}</textarea>

    <script>
        // Chart Injection Logic
        const metricsData = {};
        const crisisData = {"2008_LEHMAN": {"scenario": "2008_LEHMAN", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "market": [100.0, 101.7, 101.94, 97.29, 91.11, 89.82, 96.53, 101.68, 94.43, 75.18, 77.34, 80.91, 82.79, 80.85, 88.47, 92.67, 82.53, 85.15, 81.03, 72.09, 73.06, 78.79, 77.92, 67.05, 71.45, 69.79, 71.09, 66.19, 70.01, 72.12], "portfolio": [100.0, 100.54, 95.66, 89.59, 80.9, 79.96, 90.82, 94.51, 82.0, 58.51, 61.82, 67.69, 68.32, 66.61, 75.87, 82.97, 72.9, 75.21, 70.66, 62.78, 60.19, 70.61, 67.44, 55.62, 62.23, 57.4, 58.58, 53.29, 56.89, 60.02], "metrics": {"market": {"max_drawdown": 35.07, "volatility": 111.2, "total_return": -27.88}, "portfolio": {"max_drawdown": 47.0, "volatility": 162.82, "total_return": -39.98}}}, "1987_BLACK_MONDAY": {"scenario": "1987_BLACK_MONDAY", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], "market": [100.0, 101.3, 116.46, 117.49, 121.36, 142.33, 127.26, 113.94, 100.25, 94.81, 91.84, 94.86, 99.8, 112.86, 106.82, 93.28, 111.55, 98.93, 89.88, 84.1], "portfolio": [100.0, 100.48, 120.76, 121.01, 125.67, 156.7, 137.73, 113.53, 96.6, 88.28, 89.74, 100.21, 108.88, 130.49, 122.28, 99.03, 127.85, 103.91, 94.03, 87.93], "metrics": {"market": {"max_drawdown": 40.91, "volatility": 161.77, "total_return": -15.9}, "portfolio": {"max_drawdown": 43.89, "volatility": 233.76, "total_return": -12.07}}}, "2000_DOTCOM_BUBBLE": {"scenario": "2000_DOTCOM_BUBBLE", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45], "market": [100.0, 94.04, 90.34, 88.11, 90.95, 98.24, 101.79, 102.26, 90.78, 73.29, 74.29, 75.35, 82.66, 78.12, 65.35, 64.43, 60.78, 64.68, 58.57, 63.06, 64.99, 62.55, 58.51, 56.33, 53.69, 52.03, 50.64, 49.16, 46.82, 44.87, 44.05, 42.0, 43.02, 42.42, 42.95, 42.76, 44.95, 44.18, 43.7, 40.75, 38.34, 35.41, 34.89, 35.43, 34.88], "portfolio": [100.0, 90.65, 83.94, 80.95, 83.38, 90.38, 97.93, 98.76, 81.22, 47.78, 49.38, 48.17, 56.27, 49.41, 38.93, 39.94, 38.67, 41.46, 35.15, 38.58, 39.67, 39.02, 33.68, 32.64, 30.89, 29.68, 28.63, 28.03, 25.06, 23.82, 22.99, 20.98, 22.14, 21.23, 20.97, 20.77, 22.47, 22.66, 22.67, 20.63, 19.2, 16.75, 16.49, 17.05, 16.24], "metrics": {"market": {"max_drawdown": 65.89, "volatility": 90.37, "total_return": -65.12}, "portfolio": {"max_drawdown": 83.76, "volatility": 151.46, "total_return": -83.76}}}, "2020_COVID": {"scenario": "2020_COVID", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "market": [100.0, 107.32, 113.35, 119.04, 116.51, 112.83, 105.73, 100.26, 103.4, 105.22, 107.79, 109.31, 111.16, 99.33, 86.3, 70.54, 72.63, 70.84, 72.18, 75.4, 80.25, 83.17, 71.62, 68.61, 64.9, 68.93, 66.99, 64.95, 60.31, 56.87, 56.74, 50.5, 50.16, 52.67, 52.18, 48.18, 40.93, 40.31, 39.2, 41.29], "portfolio": [100.0, 111.83, 122.54, 134.4, 132.92, 126.46, 114.37, 109.93, 109.56, 110.27, 113.1, 117.58, 120.06, 104.18, 83.54, 60.33, 62.98, 61.36, 65.3, 74.83, 82.85, 93.09, 70.28, 71.12, 64.95, 69.18, 67.12, 64.04, 55.3, 52.1, 49.77, 42.09, 39.61, 42.79, 40.74, 35.04, 26.51, 26.35, 25.28, 26.93], "metrics": {"market": {"max_drawdown": 67.07, "volatility": 102.21, "total_return": -58.71}, "portfolio": {"max_drawdown": 81.19, "volatility": 166.33, "total_return": -73.07}}}, "2022_INFLATION_SHOCK": {"scenario": "2022_INFLATION_SHOCK", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "market": [100.0, 95.71, 94.99, 98.04, 96.28, 96.87, 91.96, 93.51, 95.34, 91.27, 95.0, 90.94, 94.5, 86.83, 87.77, 85.61, 82.09, 81.19, 82.53, 86.1, 89.35, 90.88, 87.18, 84.15, 88.9, 88.12, 84.53, 82.75, 86.85, 87.22, 81.32, 78.57, 77.1, 73.97, 73.86, 77.93, 75.82, 74.08, 71.72, 72.36, 70.23, 66.92, 71.75, 67.98, 68.16, 69.26, 67.8, 63.17, 64.61, 62.91, 64.44, 63.91, 67.05, 67.08, 66.95, 65.77, 64.79, 67.54, 66.17, 62.46], "portfolio": [100.0, 95.65, 92.4, 96.54, 95.27, 96.42, 86.49, 90.74, 91.53, 82.94, 84.81, 80.59, 83.13, 73.85, 75.94, 74.74, 69.17, 69.04, 68.7, 72.89, 75.89, 78.26, 74.39, 67.09, 74.29, 71.27, 68.02, 64.31, 68.87, 66.06, 60.18, 58.09, 54.88, 54.4, 54.29, 59.17, 56.18, 54.75, 51.46, 53.53, 50.52, 48.5, 54.94, 50.44, 49.54, 51.35, 49.77, 44.64, 47.64, 44.37, 45.41, 46.14, 50.03, 46.87, 48.06, 47.02, 46.45, 48.97, 47.4, 44.89], "metrics": {"market": {"max_drawdown": 37.54, "volatility": 56.08, "total_return": -37.54}, "portfolio": {"max_drawdown": 55.63, "volatility": 89.04, "total_return": -55.11}}}, "2025_AI_SHOCK": {"scenario": "2025_AI_SHOCK", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "market": [100.0, 103.15, 100.3, 115.59, 121.18, 105.27, 99.6, 93.16, 92.66, 88.56, 92.1, 99.97, 104.72, 111.79, 97.88, 91.48, 105.27, 50.19, 61.02, 64.34, 57.28, 64.89, 64.94, 75.75, 75.25, 68.38, 71.81, 75.8, 72.83, 70.88, 80.29, 76.99, 81.71, 71.56, 60.93], "portfolio": [100.0, 107.43, 104.56, 127.76, 141.42, 117.13, 115.94, 104.37, 102.63, 94.45, 98.43, 112.59, 118.23, 131.54, 107.91, 95.43, 116.65, 27.49, 33.94, 37.98, 31.11, 37.97, 36.2, 44.72, 43.09, 39.76, 45.68, 49.46, 45.96, 44.74, 52.87, 49.27, 53.38, 44.59, 35.33], "metrics": {"market": {"max_drawdown": 58.58, "volatility": 205.32, "total_return": -39.07}, "portfolio": {"max_drawdown": 80.56, "volatility": 297.6, "total_return": -64.67}}}};

        // --- Metrics Chart ---
        if (metricsData && Object.keys(metricsData).length > 0) {
            const ctx = document.getElementById('financialChart');
            const container = document.getElementById('financialChartContainer');

            // Basic parsing of metrics structure (assuming flat or Year->Val)
            let labels = [];
            let values = [];
            let labelName = "Metric";

            // Try to find a timeseries
            for (const [key, val] of Object.entries(metricsData)) {
                if (typeof val === 'object') {
                    // Likely year -> value
                    labels = Object.keys(val);
                    values = Object.values(val).map(v => parseFloat(v.replace(/[^0-9.-]/g, '')));
                    labelName = key;
                    break;
                }
            }

            if (labels.length > 0) {
                container.style.display = 'block';
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: labelName,
                            data: values,
                            backgroundColor: 'rgba(204, 0, 0, 0.5)',
                            borderColor: '#cc0000',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#ccc' } }
                        },
                        scales: {
                            y: { grid: { color: '#333' }, ticks: { color: '#888' } },
                            x: { grid: { color: '#333' }, ticks: { color: '#888' } }
                        }
                    }
                });
            }
        }

        // --- Crisis Simulation Logic ---
        let crisisChartInstance = null;

        window.renderCrisis = function(scenarioName) {
            if (!crisisData || !crisisData[scenarioName]) return;

            // UI Feedback for Buttons
            document.querySelectorAll('.crisis-btn').forEach(btn => {
                btn.style.borderColor = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#666';
                btn.style.color = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#ccc';
            });

            const data = crisisData[scenarioName];

            // Update Metrics Display
            if (data.metrics) {
                const p = data.metrics.portfolio;
                const m = data.metrics.market;

                document.getElementById('port_dd').innerText = p.max_drawdown.toFixed(2) + '%';
                document.getElementById('port_vol').innerText = p.volatility.toFixed(2) + '%';
                document.getElementById('port_ret').innerText = p.total_return.toFixed(2) + '%';

                // Color code return
                document.getElementById('port_ret').style.color = p.total_return >= 0 ? '#00f3ff' : '#ff4444';

                document.getElementById('mkt_dd').innerText = m.max_drawdown.toFixed(2) + '%';
                document.getElementById('mkt_vol').innerText = m.volatility.toFixed(2) + '%';
                document.getElementById('mkt_ret').innerText = m.total_return.toFixed(2) + '%';

                document.getElementById('mkt_ret').style.color = m.total_return >= 0 ? '#ccc' : '#cc0000';
            }

            const ctx = document.getElementById('crisisChart').getContext('2d');

            if (crisisChartInstance) {
                crisisChartInstance.destroy();
            }

            crisisChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'Your Portfolio (Simulated)',
                            data: data.portfolio,
                            borderColor: '#00f3ff',
                            backgroundColor: 'rgba(0, 243, 255, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 0
                        },
                        {
                            label: 'Market Benchmark',
                            data: data.market,
                            borderColor: '#666',
                            borderDash: [5, 5],
                            borderWidth: 1,
                            pointRadius: 0,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { labels: { color: '#ccc', font: { family: 'JetBrains Mono' } } },
                        title: {
                            display: true,
                            text: 'STRESS TEST SCENARIO: ' + scenarioName.replace(/_/g, ' '),
                            color: '#cc0000',
                            font: { family: 'JetBrains Mono' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#cc0000',
                            bodyColor: '#fff',
                            borderColor: '#333',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#333' },
                            ticks: { color: '#888', callback: function(value) { return value + '%'; } }
                        },
                        x: {
                            grid: { color: '#333' },
                            ticks: { display: false }
                        }
                    }
                }
            });
        };

        // Auto-Run Default Crisis if Data Available
        if (crisisData && Object.keys(crisisData).length > 0) {
            document.getElementById('crisisSimContainer').style.display = 'block';

            // Parse URL parameters for ?sim=SCENARIO_NAME
            const urlParams = new URLSearchParams(window.location.search);
            const simParam = urlParams.get('sim');

            // slight delay to ensure Chart.js loaded
            setTimeout(() => {
                if (simParam && crisisData[simParam]) {
                    renderCrisis(simParam);
                    // Scroll to container
                    document.getElementById('crisisSimContainer').scrollIntoView({ behavior: 'smooth' });
                } else {
                    renderCrisis('2008_LEHMAN');
                }
            }, 100);
        }
    </script>
</body>
</html>