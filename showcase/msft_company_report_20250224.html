<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM v23.5 :: Microsoft Corporation (MSFT) Report</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/market_mayhem_tiers.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/nav.js" defer></script>
    <script src="js/market_mayhem_viewer.js" defer></script>
</head>
<body class="tier-high">

    <div id="system2-overlay" class="system2-overlay">
        <div class="system2-terminal">
            <div id="sys2-content"></div>
        </div>
    </div>

    <div id="toast-container" class="cyber-toast-container"></div>

    <div id="raw-source-modal" class="raw-source-modal">
        <div class="raw-source-header">
            <span>SOURCE_DATA.JSON</span>
            <span style="cursor:pointer; color:#cc0000;" onclick="toggleSource()">[CLOSE]</span>
        </div>
        <div class="raw-source-content" id="raw-source-content"></div>
    </div>

    <div class="doc-toolbar" style="display: flex;">
        <div class="toolbar-item" onclick="window.location.href='market_mayhem_archive_v24.html'"><strong>FILE</strong></div>
        <div class="toolbar-item" onclick="toggleRedactionMode()">REDACT</div>
        <div class="toolbar-item" onclick="printReport()">PRINT</div>
        <div class="toolbar-item" onclick="shareReport()">SHARE</div>
        <div class="toolbar-item" onclick="downloadReport()">DOWNLOAD</div>
        <div class="toolbar-item" onclick="toggleTheme()">VIEW</div>
        <div class="toolbar-item" onclick="showToast('INSERT: PERMISSION DENIED')">INSERT</div>
        <div class="toolbar-item" onclick="showToast('FORMAT: LOCKED')">FORMAT</div>
        <div class="toolbar-item" onclick="runVerification()" style="color: #0078d7;"><strong>VERIFY</strong></div>
        <div style="flex-grow:1;"></div>
        <div class="toolbar-item" style="color:#666;">ADAM_V26_EDITOR</div>
    </div>

    <div style="max-width: 1400px; margin: 0 auto; padding: 10px 20px; display:flex; justify-content:space-between; align-items:center; display: none;">
        <a href="market_mayhem_archive_v24.html" class="cyber-btn">&larr; RETURN TO ARCHIVE</a>
        <div style="font-family:'JetBrains Mono'; font-size:0.7rem; color:#666;">SECURE CONNECTION ESTABLISHED</div>
    </div>

    <div class="newsletter-wrapper">
        <div class="paper-sheet" id="paper-sheet">

            <div id="top-secret-stamp" class="top-secret-stamp">TOP SECRET</div>

            <div class="doc-header-ui" style="display: flex;">
                <span id="verification-status">CONFIDENTIAL // SYSTEM 2 REVIEW</span>
                <span>499cfc01</span>
            </div>

            <div style="display:flex; justify-content:space-between; font-family:'JetBrains Mono'; font-size:0.8rem; color:#666; margin-bottom:20px; margin-top: 20px;">
                <span>2025-02-24</span>
                <span>ID: 499cfc01</span>
            </div>

            <h1 class="title">Microsoft Corporation (MSFT) Report</h1>

            <div class="doc-metadata-panel" style="display: grid;">
                <div class="doc-metadata-item"><strong>Classification</strong>UNCLASSIFIED</div>
                <div class="doc-metadata-item"><strong>Conviction</strong>0/100</div>
                <div class="doc-metadata-item"><strong>Sentiment</strong>97/100</div>
                <div class="doc-metadata-item"><strong>Reviewer</strong>Sovereign_AI</div>
            </div>

            <div id="financialChartContainer" style="display:none; margin-bottom: 30px;">
                <canvas id="financialChart"></canvas>
            </div>

            <div id="crisisSimContainer" style="display:none; margin-bottom: 30px; border: 1px solid #cc0000; padding: 20px; background: rgba(50, 0, 0, 0.2);">
                <h3 style="color: #cc0000; margin-top: 0; font-family: 'JetBrains Mono'; border-bottom: 1px solid #cc0000; padding-bottom: 10px; margin-bottom: 20px;">CRISIS SIMULATOR // STRESS TEST</h3>

                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 20px;">
                    <div class="crisis-btn" onclick="renderCrisis('2008_LEHMAN')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2008 LEHMAN
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('1987_BLACK_MONDAY')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        1987 BLACK MON
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2000_DOTCOM_BUBBLE')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2000 DOTCOM
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2020_COVID')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2020 PANDEMIC
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2022_INFLATION_SHOCK')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2022 INFLATION
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2025_AI_SHOCK')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2025 AI SHOCK
                    </div>
                </div>

                <div style="height: 300px; position: relative;">
                    <canvas id="crisisChart"></canvas>
                </div>

                <div id="crisisMetrics" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; font-family: 'JetBrains Mono'; font-size: 0.8rem; color: #ccc;">
                    <div style="border: 1px solid #00f3ff; padding: 10px; background: rgba(0, 243, 255, 0.05);">
                        <div style="color: #00f3ff; border-bottom: 1px solid #00f3ff; margin-bottom: 10px; padding-bottom: 5px; font-weight: bold;">PORTFOLIO PERFORMANCE</div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>MAX DRAWDOWN:</span> <span id="port_dd" style="color: #fff;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>VOLATILITY (ANN):</span> <span id="port_vol" style="color: #fff;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between;"><span>TOTAL RETURN:</span> <span id="port_ret" style="color: #fff;">0.00%</span></div>
                    </div>
                    <div style="border: 1px solid #666; padding: 10px; background: rgba(100, 100, 100, 0.1);">
                        <div style="color: #888; border-bottom: 1px solid #666; margin-bottom: 10px; padding-bottom: 5px; font-weight: bold;">MARKET BENCHMARK</div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>MAX DRAWDOWN:</span> <span id="mkt_dd" style="color: #ccc;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>VOLATILITY (ANN):</span> <span id="mkt_vol" style="color: #ccc;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between;"><span>TOTAL RETURN:</span> <span id="mkt_ret" style="color: #ccc;">0.00%</span></div>
                    </div>
                </div>

                <div style="font-size: 0.7rem; color: #888; margin-top: 15px; font-style: italic;">
                    * Hypothetical performance based on portfolio beta and current risk profile. PAST PERFORMANCE IS NOT INDICATIVE OF FUTURE RESULTS.
                </div>
            </div>

            <div id="document-body">
                <h2>Executive Summary</h2><p>Microsoft demonstrates robust financial performance driven by cloud and productivity growth. Despite challenges in gaming and regulatory scrutiny, strategic AI investments and the Activision Blizzard acquisition position it for continued market leadership.</p><h2>Segments</h2><ul><li><strong>name:</strong> Productivity and Business Processes, <strong>revenue_growth:</strong> 13%, <strong>key_drivers:</strong> ['Microsoft 365 Commercial cloud', 'LinkedIn', 'Dynamics 365'], <strong>highlights:</strong> ['Microsoft 365 Commercial cloud revenue grew 16% driven by seat growth and increased revenue per user.', 'LinkedIn revenue increased 9% demonstrating continued strength in professional networking and talent acquisition.', 'Dynamics 365 revenue surged by 19% due to growth across all workloads.']</li><li><strong>name:</strong> Intelligent Cloud, <strong>revenue_growth:</strong> 19%, <strong>key_drivers:</strong> ['Azure and other cloud services'], <strong>highlights:</strong> ['Azure and other cloud services revenue grew 32%, with AI services growing 178%.'], <strong>concerns:</strong> ['Slight decline in Server products revenue due to tough comparison with prior year.']</li><li><strong>name:</strong> More Personal Computing, <strong>revenue_growth:</strong> 7%, <strong>key_drivers:</strong> ['Xbox content and services', 'Search and news advertising'], <strong>highlights:</strong> ['Windows OEM and Devices revenue increased 3% due to commercial inventory builds.', 'Xbox content and services revenue increased 24% driven by Game Pass and the Activision Blizzard acquisition.', 'Search and news advertising revenue excluding traffic acquisition costs increased 20%.'], <strong>concerns:</strong> ['Xbox hardware revenue decreased 29% due to lower console sales.']</li></ul><h2>Competitive Landscape</h2><h3>Cloud Computing</h3><h4>Main Competitors</h4><ul><li>Amazon Web Services (AWS)</li><li>Google Cloud Platform (GCP)</li></ul><h4>Microsoft Differentiators</h4><ul><li>Hybrid cloud offerings</li><li>Strong enterprise relationships</li></ul><h3>Productivity Software</h3><h4>Main Competitors</h4><ul><li>Google Workspace</li></ul><h4>Microsoft Differentiators</h4><ul><li>Entrenched position in the enterprise market</li><li>Comprehensive offerings</li></ul><h3>Gaming</h3><h4>Main Competitors</h4><ul><li>Sony PlayStation</li><li>Nintendo</li><li>Mobile gaming platforms</li></ul><h4>Microsoft Differentiators</h4><ul><li>Xbox Game Pass</li><li>Activision Blizzard acquisition (pending)</li><li>Cloud gaming</li></ul><h2>Activision Blizzard Acquisition</h2><h3>Opportunities</h3><ul><li>Expanding Game Pass with popular franchises</li><li>Mobile gaming expansion through titles like Candy Crush</li><li>Accelerated metaverse ambitions</li></ul><h3>Challenges</h3><ul><li>Regulatory scrutiny and potential antitrust concerns</li><li>Complexity of integrating a large organization</li><li>Potential cultural clashes</li></ul><h2>Ai Strategy</h2><ul><li>Integrating AI capabilities into existing products (Microsoft 365, Dynamics 365, Bing)</li><li>Developing new AI-powered products and services (Azure AI platform, Copilot)</li><li>Strategic partnership with OpenAI for cutting-edge research and models</li></ul><h2>Trading Levels</h2><h3>Equity</h3><h4>Outlook</h4><p>Positive</p><h4>Price Target</h4><p>450</p><h4>Potential Upside</h4><p>12.5%</p><h3>Debt</h3><h4>Credit Rating</h4><p>AAA</p><h4>Spread To Treasuries</h4><p>50-70 basis points (example for 3.125% Notes due 2028)</p><h4>Outlook</h4><p>Stable</p><h2>Valuation</h2><h3>Model</h3><p>Discounted Cash Flow (DCF)</p><h3>Assumptions</h3><h4>Revenue Growth</h4><p>15% (next 5 years)</p><h4>Operating Margin</h4><p>42% (long-term)</p><h4>Discount Rate</h4><p>8%</p><h4>Terminal Growth Rate</h4><p>4%</p><h3>Price Target</h3><p>450</p>
            </div>

            <div class="provenance-log">
                <div class="log-entry">
                    <span>> HASH_CHECK</span>
                    <span style="color:var(--terminal-green);">499cfc0153350b0ca708fa0fbe94217a7429cadbd39b462ac7b4a1b5096a6528</span>
                </div>
                <div class="log-entry">
                    <span>> SENTIMENT_SCAN</span>
                    <span>97 (DENSITY: 37)</span>
                </div>
                <div class="log-entry">
                    <span>> CONVICTION_LOCK</span>
                    <span>0%</span>
                </div>
                <div class="log-entry">
                    <span>> CRITIQUE_LOG</span>
                    <span>"Agent Sovereign_AI reviewed this intelligence. Verdict: HIGH_CONFIDENCE. Sentiment alignment: 97/100. Cross-reference with knowledge graph completed."</span>
                </div>
            </div>

            <a href="#" class="source-jump-btn" onclick="toggleSource(); return false;" title="View Source JSON">JUMP TO SOURCE</a>

            <div style="margin-top: 40px; border-top: 1px solid #ccc; padding-top: 20px; font-style: italic; color: #666;">
                End of Transmission.
            </div>
        </div>

        <aside class="cyber-sidebar">
            <div class="sidebar-widget">
                <div class="sidebar-title">Intelligence Metadata</div>
                <div class="stat-row"><span>DATE</span> <span class="stat-val">2025-02-24</span></div>
                <div class="stat-row"><span>TYPE</span> <span class="stat-val">COMPANY_REPORT</span></div>
                <div class="stat-row"><span>CLASS</span> <span class="stat-val">UNCLASSIFIED</span></div>
                <div class="stat-row"><span>PROVENANCE</span> <span class="stat-val" title="499cfc0153350b0ca708fa0fbe94217a7429cadbd39b462ac7b4a1b5096a6528">499cfc01</span></div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Sentiment Analysis</div>
                <div class="stat-row"><span>SCORE</span> <span class="stat-val">97/100</span></div>
                <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 97%;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Detected Entities</div>
                <div class="tag-cloud">
                    <a href="market_mayhem_archive_v24.html?search=AI" class="tag" style="text-decoration:none; border-color:#666;">AI</a><a href="market_mayhem_archive_v24.html?search=Cloud" class="tag" style="text-decoration:none; border-color:#666;">Cloud</a><a href="market_mayhem_archive_v24.html?search=EV" class="tag" style="text-decoration:none; border-color:#666;">EV</a><a href="market_mayhem_archive_v24.html?search=Growth" class="tag" style="text-decoration:none; border-color:#666;">Growth</a><a href="market_mayhem_archive_v24.html?search=Metaverse" class="tag" style="text-decoration:none; border-color:#666;">Metaverse</a>
                </div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Agent Conviction</div>
                 <div class="stat-row"><span>CONFIDENCE</span> <span class="stat-val">0/100</span></div>
                 <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 0%; background: #ff0000;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Semantic Analysis</div>
                 <div class="stat-row"><span>DENSITY</span> <span class="stat-val">37/100</span></div>
                 <div class="stat-row"><span>PROBABILITY</span> <span class="stat-val">0/100</span></div>
            </div>

             <div class="sidebar-widget" style="border-color: #555;">
                <div class="sidebar-title">Reviewer Agent Log</div>
                 <div style="font-size: 0.75rem; color: #ccc; font-style: italic;">
                    "Agent Sovereign_AI reviewed this intelligence. Verdict: HIGH_CONFIDENCE. Sentiment alignment: 97/100. Cross-reference with knowledge graph completed."
                </div>
                <div class="stat-row" style="margin-top:10px;"><span>QUALITY SCORE</span> <span class="stat-val">100/100</span></div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Contributing Agents</div>
                 <div style="display:flex; flex-direction:column; gap:5px;">
                    <div style="font-size:0.75rem; color:#666;">System Core</div>
                </div>
            </div>
        </aside>
    </div>

    <textarea id="hidden-raw-data" style="display:none;">{
  "title": "Microsoft Corporation (MSFT) Report",
  "date": "2025-02-24",
  "summary": "Microsoft demonstrates robust financial performance driven by cloud and productivity growth. Despite challenges in gaming and regulatory scrutiny, strategic AI investments and the Activision Blizzard acquisition position it for continued market leadership.",
  "type": "COMPANY_REPORT",
  "full_body": "<h2>Executive Summary</h2><p>Microsoft demonstrates robust financial performance driven by cloud and productivity growth. Despite challenges in gaming and regulatory scrutiny, strategic AI investments and the Activision Blizzard acquisition position it for continued market leadership.</p><h2>Segments</h2><ul><li><strong>name:</strong> Productivity and Business Processes, <strong>revenue_growth:</strong> 13%, <strong>key_drivers:</strong> ['Microsoft 365 Commercial cloud', 'LinkedIn', 'Dynamics 365'], <strong>highlights:</strong> ['Microsoft 365 Commercial cloud revenue grew 16% driven by seat growth and increased revenue per user.', 'LinkedIn revenue increased 9% demonstrating continued strength in professional networking and talent acquisition.', 'Dynamics 365 revenue surged by 19% due to growth across all workloads.']</li><li><strong>name:</strong> Intelligent Cloud, <strong>revenue_growth:</strong> 19%, <strong>key_drivers:</strong> ['Azure and other cloud services'], <strong>highlights:</strong> ['Azure and other cloud services revenue grew 32%, with AI services growing 178%.'], <strong>concerns:</strong> ['Slight decline in Server products revenue due to tough comparison with prior year.']</li><li><strong>name:</strong> More Personal Computing, <strong>revenue_growth:</strong> 7%, <strong>key_drivers:</strong> ['Xbox content and services', 'Search and news advertising'], <strong>highlights:</strong> ['Windows OEM and Devices revenue increased 3% due to commercial inventory builds.', 'Xbox content and services revenue increased 24% driven by Game Pass and the Activision Blizzard acquisition.', 'Search and news advertising revenue excluding traffic acquisition costs increased 20%.'], <strong>concerns:</strong> ['Xbox hardware revenue decreased 29% due to lower console sales.']</li></ul><h2>Competitive Landscape</h2><h3>Cloud Computing</h3><h4>Main Competitors</h4><ul><li>Amazon Web Services (AWS)</li><li>Google Cloud Platform (GCP)</li></ul><h4>Microsoft Differentiators</h4><ul><li>Hybrid cloud offerings</li><li>Strong enterprise relationships</li></ul><h3>Productivity Software</h3><h4>Main Competitors</h4><ul><li>Google Workspace</li></ul><h4>Microsoft Differentiators</h4><ul><li>Entrenched position in the enterprise market</li><li>Comprehensive offerings</li></ul><h3>Gaming</h3><h4>Main Competitors</h4><ul><li>Sony PlayStation</li><li>Nintendo</li><li>Mobile gaming platforms</li></ul><h4>Microsoft Differentiators</h4><ul><li>Xbox Game Pass</li><li>Activision Blizzard acquisition (pending)</li><li>Cloud gaming</li></ul><h2>Activision Blizzard Acquisition</h2><h3>Opportunities</h3><ul><li>Expanding Game Pass with popular franchises</li><li>Mobile gaming expansion through titles like Candy Crush</li><li>Accelerated metaverse ambitions</li></ul><h3>Challenges</h3><ul><li>Regulatory scrutiny and potential antitrust concerns</li><li>Complexity of integrating a large organization</li><li>Potential cultural clashes</li></ul><h2>Ai Strategy</h2><ul><li>Integrating AI capabilities into existing products (Microsoft 365, Dynamics 365, Bing)</li><li>Developing new AI-powered products and services (Azure AI platform, Copilot)</li><li>Strategic partnership with OpenAI for cutting-edge research and models</li></ul><h2>Trading Levels</h2><h3>Equity</h3><h4>Outlook</h4><p>Positive</p><h4>Price Target</h4><p>450</p><h4>Potential Upside</h4><p>12.5%</p><h3>Debt</h3><h4>Credit Rating</h4><p>AAA</p><h4>Spread To Treasuries</h4><p>50-70 basis points (example for 3.125% Notes due 2028)</p><h4>Outlook</h4><p>Stable</p><h2>Valuation</h2><h3>Model</h3><p>Discounted Cash Flow (DCF)</p><h3>Assumptions</h3><h4>Revenue Growth</h4><p>15% (next 5 years)</p><h4>Operating Margin</h4><p>42% (long-term)</p><h4>Discount Rate</h4><p>8%</p><h4>Terminal Growth Rate</h4><p>4%</p><h3>Price Target</h3><p>450</p>",
  "sentiment_score": 97,
  "entities": {
    "tickers": [],
    "agents": [],
    "sovereigns": [],
    "keywords": [
      "AI",
      "Cloud",
      "EV",
      "Growth",
      "Metaverse"
    ]
  },
  "provenance_hash": "499cfc0153350b0ca708fa0fbe94217a7429cadbd39b462ac7b4a1b5096a6528",
  "filename": "msft_company_report_20250224.html",
  "is_sourced": true,
  "metrics_json": "{}",
  "source_priority": 2,
  "conviction": 0,
  "semantic_score": 37,
  "probability": 0,
  "outlook_score": 19,
  "critique": "Agent Sovereign_AI reviewed this intelligence. Verdict: HIGH_CONFIDENCE. Sentiment alignment: 97/100. Cross-reference with knowledge graph completed."
}</textarea>

    <script>
        // Chart Injection Logic
        const metricsData = {};
        const crisisData = {"2008_LEHMAN": {"scenario": "2008_LEHMAN", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "market": [100.0, 93.63, 90.44, 80.91, 85.04, 84.81, 87.86, 86.56, 76.22, 73.69, 62.17, 64.43, 57.68, 58.36, 38.68, 38.06, 43.54, 45.74, 38.68, 37.96, 39.57, 43.59, 40.21, 33.5, 29.39, 31.98, 31.05, 29.47, 28.81, 28.83], "portfolio": [100.0, 90.06, 84.4, 70.4, 78.4, 78.81, 78.88, 80.59, 68.23, 66.78, 50.33, 54.6, 44.78, 49.8, 28.03, 28.41, 32.07, 34.52, 26.55, 25.47, 27.35, 31.56, 27.66, 19.81, 17.38, 19.59, 18.91, 17.61, 17.18, 17.64], "metrics": {"market": {"max_drawdown": 71.19, "volatility": 152.48, "total_return": -71.17}, "portfolio": {"max_drawdown": 82.82, "volatility": 220.62, "total_return": -82.36}}}, "1987_BLACK_MONDAY": {"scenario": "1987_BLACK_MONDAY", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], "market": [100.0, 100.03, 91.66, 88.15, 96.88, 84.32, 84.93, 86.23, 98.76, 31.74, 29.3, 24.52, 27.71, 31.02, 36.45, 37.25, 37.75, 34.65, 32.27, 31.36], "portfolio": [100.0, 100.37, 82.82, 77.63, 92.05, 78.9, 77.2, 79.18, 96.84, -1.7, -1.37, -1.06, -1.29, -1.5, -1.97, -2.03, -2.11, -1.87, -1.63, -1.53], "metrics": {"market": {"max_drawdown": 75.49, "volatility": 283.02, "total_return": -68.64}, "portfolio": {"max_drawdown": 102.1, "volatility": 434.78, "total_return": -101.53}}}, "2000_DOTCOM_BUBBLE": {"scenario": "2000_DOTCOM_BUBBLE", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45], "market": [100.0, 105.39, 107.91, 102.68, 103.02, 103.8, 103.83, 94.26, 98.6, 75.5, 68.41, 67.74, 63.1, 54.0, 55.52, 51.73, 53.72, 55.58, 57.41, 50.54, 51.02, 53.28, 53.63, 49.14, 49.26, 46.56, 47.77, 45.46, 45.2, 48.53, 45.78, 44.27, 44.95, 42.47, 45.08, 45.09, 41.94, 41.76, 43.46, 43.93, 43.79, 44.24, 41.92, 42.07, 40.35], "portfolio": [100.0, 107.12, 112.68, 103.51, 104.86, 101.9, 102.67, 90.23, 95.16, 64.82, 52.83, 52.23, 46.42, 33.85, 36.17, 32.85, 32.94, 34.66, 34.5, 27.87, 28.13, 28.27, 28.13, 25.1, 25.52, 23.02, 23.97, 22.49, 21.77, 23.56, 21.95, 21.41, 21.77, 20.45, 22.86, 23.12, 20.4, 20.61, 21.65, 22.53, 22.64, 23.33, 21.45, 21.28, 19.81], "metrics": {"market": {"max_drawdown": 62.61, "volatility": 94.97, "total_return": -59.65}, "portfolio": {"max_drawdown": 82.42, "volatility": 142.03, "total_return": -80.19}}}, "2020_COVID": {"scenario": "2020_COVID", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "market": [100.0, 99.57, 99.85, 105.86, 107.72, 102.56, 99.87, 92.89, 80.45, 86.37, 82.53, 77.23, 78.45, 72.23, 80.72, 89.53, 78.73, 84.18, 91.22, 79.15, 93.24, 82.35, 88.78, 90.19, 88.24, 95.06, 95.9, 103.28, 101.18, 98.82, 98.92, 114.98, 110.45, 108.4, 94.59, 103.74, 104.02, 95.85, 94.13, 93.06], "portfolio": [100.0, 100.33, 99.27, 109.12, 113.6, 106.71, 106.8, 95.94, 73.5, 80.44, 75.87, 69.73, 70.05, 62.21, 74.5, 86.06, 74.88, 82.42, 96.48, 83.15, 99.57, 79.42, 92.12, 95.17, 88.45, 98.21, 98.26, 111.53, 110.92, 106.6, 103.26, 128.74, 124.02, 117.68, 93.61, 105.54, 107.11, 95.09, 94.25, 94.91], "metrics": {"market": {"max_drawdown": 32.95, "volatility": 125.27, "total_return": -6.94}, "portfolio": {"max_drawdown": 45.24, "volatility": 184.91, "total_return": -5.09}}}, "2022_INFLATION_SHOCK": {"scenario": "2022_INFLATION_SHOCK", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "market": [100.0, 99.52, 95.95, 92.02, 91.1, 89.08, 87.98, 92.75, 92.95, 100.55, 106.65, 106.06, 101.98, 94.81, 93.13, 86.54, 86.53, 79.07, 77.74, 72.63, 71.83, 72.04, 71.22, 74.72, 72.54, 67.16, 70.92, 74.69, 78.21, 82.66, 84.41, 90.37, 97.05, 88.86, 91.0, 88.64, 89.37, 88.39, 88.68, 83.18, 81.71, 79.45, 80.07, 84.06, 85.0, 87.23, 80.71, 79.25, 79.09, 77.45, 74.96, 73.33, 77.48, 78.16, 78.75, 72.32, 70.18, 69.96, 69.77, 66.15], "portfolio": [100.0, 95.67, 91.16, 84.39, 83.97, 81.42, 80.71, 85.02, 86.17, 97.7, 104.0, 105.56, 98.37, 85.74, 84.66, 77.22, 76.34, 66.66, 67.74, 61.43, 59.2, 59.58, 58.27, 64.61, 65.15, 61.91, 67.09, 71.27, 75.68, 88.68, 93.86, 98.89, 112.44, 99.75, 103.0, 99.1, 99.2, 95.11, 97.42, 87.5, 88.92, 87.3, 89.5, 99.94, 102.88, 110.78, 98.61, 96.95, 96.93, 93.1, 85.15, 82.74, 91.87, 90.91, 90.3, 78.62, 76.67, 75.91, 76.68, 69.41], "metrics": {"market": {"max_drawdown": 37.97, "volatility": 68.02, "total_return": -33.85}, "portfolio": {"max_drawdown": 44.8, "volatility": 110.36, "total_return": -30.59}}}, "2025_AI_SHOCK": {"scenario": "2025_AI_SHOCK", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "market": [100.0, 100.99, 97.88, 80.77, 81.79, 69.45, 63.47, 67.86, 73.29, 74.82, 83.49, 68.63, 76.01, 49.34, 46.38, 42.41, 32.35, 32.01, 43.69, 52.73, 41.22, 47.18, 47.07, 45.8, 31.92, 33.36, 33.67, 38.06, 29.4, 28.25, 31.29, 30.21, 34.25, 35.67, 35.87], "portfolio": [100.0, 96.54, 94.8, 68.92, 70.85, 53.25, 46.75, 52.81, 61.43, 63.88, 78.69, 55.08, 64.34, 29.76, 27.89, 24.68, 14.73, 14.46, 22.73, 31.51, 17.58, 21.21, 22.09, 21.19, 10.58, 11.28, 11.57, 14.54, 9.35, 8.43, 9.6, 9.36, 11.33, 11.9, 12.34], "metrics": {"market": {"max_drawdown": 72.03, "volatility": 236.02, "total_return": -64.13}, "portfolio": {"max_drawdown": 91.57, "volatility": 391.03, "total_return": -87.66}}}};

        // --- Metrics Chart ---
        if (metricsData && Object.keys(metricsData).length > 0) {
            const ctx = document.getElementById('financialChart');
            const container = document.getElementById('financialChartContainer');

            // Basic parsing of metrics structure (assuming flat or Year->Val)
            let labels = [];
            let values = [];
            let labelName = "Metric";

            // Try to find a timeseries
            for (const [key, val] of Object.entries(metricsData)) {
                if (typeof val === 'object') {
                    // Likely year -> value
                    labels = Object.keys(val);
                    values = Object.values(val).map(v => parseFloat(v.replace(/[^0-9.-]/g, '')));
                    labelName = key;
                    break;
                }
            }

            if (labels.length > 0) {
                container.style.display = 'block';
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: labelName,
                            data: values,
                            backgroundColor: 'rgba(204, 0, 0, 0.5)',
                            borderColor: '#cc0000',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#ccc' } }
                        },
                        scales: {
                            y: { grid: { color: '#333' }, ticks: { color: '#888' } },
                            x: { grid: { color: '#333' }, ticks: { color: '#888' } }
                        }
                    }
                });
            }
        }

        // --- Crisis Simulation Logic ---
        let crisisChartInstance = null;

        window.renderCrisis = function(scenarioName) {
            if (!crisisData || !crisisData[scenarioName]) return;

            // UI Feedback for Buttons
            document.querySelectorAll('.crisis-btn').forEach(btn => {
                btn.style.borderColor = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#666';
                btn.style.color = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#ccc';
            });

            const data = crisisData[scenarioName];

            // Update Metrics Display
            if (data.metrics) {
                const p = data.metrics.portfolio;
                const m = data.metrics.market;

                document.getElementById('port_dd').innerText = p.max_drawdown.toFixed(2) + '%';
                document.getElementById('port_vol').innerText = p.volatility.toFixed(2) + '%';
                document.getElementById('port_ret').innerText = p.total_return.toFixed(2) + '%';

                // Color code return
                document.getElementById('port_ret').style.color = p.total_return >= 0 ? '#00f3ff' : '#ff4444';

                document.getElementById('mkt_dd').innerText = m.max_drawdown.toFixed(2) + '%';
                document.getElementById('mkt_vol').innerText = m.volatility.toFixed(2) + '%';
                document.getElementById('mkt_ret').innerText = m.total_return.toFixed(2) + '%';

                document.getElementById('mkt_ret').style.color = m.total_return >= 0 ? '#ccc' : '#cc0000';
            }

            const ctx = document.getElementById('crisisChart').getContext('2d');

            if (crisisChartInstance) {
                crisisChartInstance.destroy();
            }

            crisisChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'Your Portfolio (Simulated)',
                            data: data.portfolio,
                            borderColor: '#00f3ff',
                            backgroundColor: 'rgba(0, 243, 255, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 0
                        },
                        {
                            label: 'Market Benchmark',
                            data: data.market,
                            borderColor: '#666',
                            borderDash: [5, 5],
                            borderWidth: 1,
                            pointRadius: 0,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { labels: { color: '#ccc', font: { family: 'JetBrains Mono' } } },
                        title: {
                            display: true,
                            text: 'STRESS TEST SCENARIO: ' + scenarioName.replace(/_/g, ' '),
                            color: '#cc0000',
                            font: { family: 'JetBrains Mono' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#cc0000',
                            bodyColor: '#fff',
                            borderColor: '#333',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#333' },
                            ticks: { color: '#888', callback: function(value) { return value + '%'; } }
                        },
                        x: {
                            grid: { color: '#333' },
                            ticks: { display: false }
                        }
                    }
                }
            });
        };

        // Auto-Run Default Crisis if Data Available
        if (crisisData && Object.keys(crisisData).length > 0) {
            document.getElementById('crisisSimContainer').style.display = 'block';

            // Parse URL parameters for ?sim=SCENARIO_NAME
            const urlParams = new URLSearchParams(window.location.search);
            const simParam = urlParams.get('sim');

            // slight delay to ensure Chart.js loaded
            setTimeout(() => {
                if (simParam && crisisData[simParam]) {
                    renderCrisis(simParam);
                    // Scroll to container
                    document.getElementById('crisisSimContainer').scrollIntoView({ behavior: 'smooth' });
                } else {
                    renderCrisis('2008_LEHMAN');
                }
            }, 100);
        }
    </script>
</body>
</html>