<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM v23.5 | Agent Registry</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .agent-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .agent-card:hover {
            transform: translateY(-4px);
            border-color: var(--primary-glow);
            box-shadow: 0 10px 30px -10px rgba(6, 182, 212, 0.2);
        }
        .code-editor {
            background: #0d1117;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: #c9d1d9;
            white-space: pre;
            overflow: auto;
        }
        .terminal-window {
            background: #0d1117;
            border-top: 1px solid #30363d;
            height: 300px;
            transition: transform 0.3s ease-in-out;
            transform: translateY(100%);
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 50;
        }
        .terminal-window.open {
            transform: translateY(0);
        }
    </style>
</head>
<body class="h-screen flex flex-col grid-bg overflow-hidden">
    <div class="scan-line"></div>

    <!-- Header -->
    <header class="h-16 border-b border-slate-700/50 flex items-center justify-between px-6 bg-[#0f172a] z-40 shrink-0">
        <div class="flex items-center gap-4">
            <button id="nav-toggle" class="text-slate-400 hover:text-white transition md:hidden">
                <i class="fas fa-bars"></i>
            </button>
            <h1 class="text-xl font-bold tracking-tight mono">ADAM <span class="text-cyan-400">v23.5</span> <span class="text-slate-500 font-normal">| Agent Registry</span></h1>
        </div>
        <div class="flex items-center gap-6 font-mono text-xs">
            <div class="hidden md:block text-slate-400">AGENTS: <span class="text-white" id="agent-count">--</span></div>
            <div class="hidden md:block text-slate-400">STATUS: <span class="text-emerald-400">ONLINE</span></div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 p-6 overflow-y-auto custom-scrollbar pb-32">
        
        <!-- Controls -->
        <div class="mb-8 flex flex-wrap justify-between items-center gap-4">
            <div class="flex gap-2 p-1 bg-slate-800/50 rounded-lg border border-slate-700/50" id="filters">
                <button class="px-4 py-1.5 rounded bg-cyan-600 text-white text-xs font-bold font-mono transition shadow-lg shadow-cyan-500/20 active-filter" onclick="filter('ALL', this)">ALL</button>
                <button class="px-4 py-1.5 rounded hover:bg-slate-700 text-slate-400 text-xs font-bold font-mono transition" onclick="filter('Specialized', this)">SPECIALISTS</button>
                <button class="px-4 py-1.5 rounded hover:bg-slate-700 text-slate-400 text-xs font-bold font-mono transition" onclick="filter('Core', this)">CORE</button>
            </div>
            
            <div class="relative">
                <input type="text" id="search-agent" placeholder="Search agent name or capabilities..."
                    class="cyber-input rounded w-64 text-xs" onkeyup="handleSearch(this.value)">
                <i class="fas fa-search absolute right-3 top-2 text-slate-500 text-xs pointer-events-none"></i>
            </div>
        </div>

        <!-- Grid -->
        <div id="agents-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Populated by JS -->
            <div class="col-span-full flex flex-col items-center justify-center py-20 text-slate-500 animate-pulse">
                <i class="fas fa-circle-notch fa-spin fa-2x mb-4 text-cyan-500"></i>
                <span class="font-mono text-sm">Querying Agent Mesh...</span>
            </div>
        </div>

    </main>

    <!-- Terminal Overlay -->
    <div id="terminal" class="terminal-window shadow-[0_-10px_40px_rgba(0,0,0,0.5)] flex flex-col">
        <div class="h-8 bg-slate-800 flex items-center justify-between px-4 border-b border-slate-700 cursor-pointer" onclick="toggleTerminal()">
            <div class="flex items-center gap-2">
                <i class="fas fa-terminal text-emerald-400 text-xs"></i>
                <span class="text-slate-300 font-bold text-xs font-mono" id="terminal-title">TERMINAL</span>
            </div>
            <div class="flex gap-4 text-xs">
                <button class="text-slate-400 hover:text-white"><i class="fas fa-chevron-down"></i></button>
            </div>
        </div>
        <div class="flex-1 overflow-y-auto p-4 space-y-1 font-mono text-xs custom-scrollbar" id="terminal-output">
            <div class="text-slate-500">Welcome to Adam v23.5 Agent Interaction Console.</div>
            <div class="text-slate-500">Select an agent to begin session.</div>
        </div>
        <div class="p-2 bg-slate-900 border-t border-slate-700 flex gap-2 items-center">
             <span class="text-emerald-400 font-mono text-xs select-none">root@adam:~#</span>
             <input type="text" id="manual-command" class="bg-transparent border-none outline-none text-white flex-1 font-mono text-xs" placeholder="Type command..." disabled>
        </div>
    </div>

    <!-- Agent Details Modal -->
    <div id="details-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] hidden flex items-center justify-center p-4">
        <div class="cyber-card w-full max-w-3xl flex flex-col max-h-[85vh] p-0 overflow-hidden">
            <div class="p-4 border-b border-slate-700 flex justify-between items-center bg-slate-800/50">
                <h3 class="text-lg font-bold text-white font-mono flex items-center gap-2">
                    <i class="fas fa-id-card text-cyan-400"></i> <span id="modal-title">Agent Details</span>
                </h3>
                <button onclick="closeModal()" class="text-slate-400 hover:text-white"><i class="fas fa-times"></i></button>
            </div>

            <div class="p-6 overflow-y-auto custom-scrollbar bg-[#0f172a]">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="md:col-span-2 space-y-6">
                        <div>
                            <label class="text-xs text-slate-500 font-bold uppercase tracking-widest mb-2 block">Description</label>
                            <p class="text-sm text-slate-300 leading-relaxed" id="modal-desc">Loading...</p>
                        </div>
                        <div>
                            <label class="text-xs text-slate-500 font-bold uppercase tracking-widest mb-2 block">Source File</label>
                            <div class="bg-slate-900 border border-slate-700 rounded p-2 flex items-center justify-between group cursor-pointer hover:border-cyan-500 transition">
                                <code class="text-xs text-cyan-300 font-mono truncate" id="modal-path">core/agents/...</code>
                                <i class="fas fa-external-link-alt text-slate-600 group-hover:text-cyan-400 text-xs"></i>
                            </div>
                        </div>
                        <div>
                            <label class="text-xs text-slate-500 font-bold uppercase tracking-widest mb-2 block">Capabilities</label>
                            <div class="flex flex-wrap gap-2" id="modal-caps">
                                <!-- Tags -->
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div class="p-4 bg-slate-900/50 rounded border border-slate-700 text-center">
                            <div class="text-xs text-slate-500 uppercase mb-1">Status</div>
                            <div class="text-xl font-bold text-white font-mono" id="modal-status">IDLE</div>
                        </div>
                        <div class="p-4 bg-slate-900/50 rounded border border-slate-700 text-center">
                            <div class="text-xs text-slate-500 uppercase mb-1">Success Rate</div>
                            <div class="text-xl font-bold text-emerald-400 font-mono">99.2%</div>
                        </div>
                        <button class="w-full py-2 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded text-xs transition uppercase tracking-wider" onclick="deployAgent()">
                            <i class="fas fa-play mr-2"></i> Deploy
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/mock_data.js"></script>
    <script src="js/app.js"></script>
    <script src="js/nav.js"></script>
    <script>
        let allAgents = [];
        let currentFilter = 'ALL';
        let searchQuery = '';
        let selectedAgent = null;

        document.addEventListener('DOMContentLoaded', () => {
            loadAgents();
        });

        function loadAgents() {
            if (window.MOCK_DATA && window.MOCK_DATA.agents) {
                allAgents = window.MOCK_DATA.agents;
            } else {
                allAgents = [];
            }
            document.getElementById('agent-count').innerText = allAgents.length;
            renderGrid();
        }

        function renderGrid() {
            const grid = document.getElementById('agents-grid');
            grid.innerHTML = '';

            let filtered = allAgents;

            if (currentFilter !== 'ALL') {
                filtered = filtered.filter(a => a.type === currentFilter);
            }

            if (searchQuery) {
                const q = searchQuery.toLowerCase();
                filtered = filtered.filter(a => a.name.toLowerCase().includes(q) || (a.docstring && a.docstring.toLowerCase().includes(q)));
            }

            if (filtered.length === 0) {
                grid.innerHTML = `<div class="col-span-full text-center text-slate-500 py-12 border border-dashed border-slate-800 rounded">No agents found.</div>`;
                return;
            }

            filtered.forEach(agent => {
                const card = document.createElement('div');
                card.className = 'cyber-card rounded-lg p-5 relative overflow-hidden group flex flex-col justify-between h-56 cursor-pointer';
                card.onclick = () => openDetails(agent);
                
                let typeBadgeClass = "badge-blue";
                let icon = "fa-robot";

                if (agent.type === 'Specialized') { typeBadgeClass = "badge-amber"; icon = "fa-bolt"; }
                if (agent.type === 'Orchestrator') { typeBadgeClass = "badge-purple"; icon = "fa-network-wired"; }

                // Fake status logic for demo
                const status = Math.random() > 0.8 ? 'ACTIVE' : 'IDLE';
                const statusColor = status === 'ACTIVE' ? 'bg-emerald-500 animate-pulse' : 'bg-slate-600';

                card.innerHTML = `
                    <div class="absolute -right-6 -top-6 text-9xl text-white opacity-[0.02] group-hover:opacity-[0.05] transition-opacity rotate-12 pointer-events-none">
                        <i class="fas ${icon}"></i>
                    </div>

                    <div class="relative z-10">
                        <div class="flex justify-between items-start mb-3">
                            <span class="cyber-badge ${typeBadgeClass}">${agent.type}</span>
                            <div class="flex items-center gap-2">
                                <span class="w-2 h-2 rounded-full ${statusColor}"></span>
                            </div>
                        </div>
                        <h3 class="text-base font-bold text-white group-hover:text-cyan-400 transition font-mono truncate" title="${agent.name}">
                            ${formatName(agent.name)}
                        </h3>
                        <p class="text-[10px] text-slate-400 mt-2 line-clamp-3 leading-relaxed font-mono">
                            ${agent.docstring ? agent.docstring.slice(0, 100) + '...' : 'System logic unit ready for deployment.'}
                        </p>
                    </div>

                    <div class="relative z-10 mt-auto pt-4 flex gap-2">
                        <div class="text-[10px] text-slate-500 font-mono truncate w-full">
                            <i class="fas fa-code-branch mr-1"></i> ${agent.file || 'core.py'}
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function formatName(name) {
            // Convert Snake_Case or CamelCase to Title Case with Spaces
            return name
                .replace(/_/g, ' ')
                .replace(/([a-z])([A-Z])/g, '$1 $2');
        }

        function filter(type, btn) {
            currentFilter = type;
            document.querySelectorAll('#filters button').forEach(b => {
                b.className = "px-4 py-1.5 rounded hover:bg-slate-700 text-slate-400 text-xs font-bold font-mono transition";
            });
            btn.className = "px-4 py-1.5 rounded bg-cyan-600 text-white text-xs font-bold font-mono transition shadow-lg shadow-cyan-500/20 active-filter";
            renderGrid();
        }

        function handleSearch(val) {
            searchQuery = val;
            renderGrid();
        }

        function openDetails(agent) {
            selectedAgent = agent;
            document.getElementById('modal-title').innerText = formatName(agent.name);
            document.getElementById('modal-desc').innerText = agent.docstring || "No documentation provided.";
            document.getElementById('modal-path').innerText = agent.path || "Unknown path";
            
            // Random status for consistency with grid
            document.getElementById('modal-status').innerText = Math.random() > 0.8 ? 'ACTIVE' : 'IDLE';
            document.getElementById('modal-status').className = document.getElementById('modal-status').innerText === 'ACTIVE' ? 'text-xl font-bold text-emerald-400 font-mono animate-pulse' : 'text-xl font-bold text-slate-400 font-mono';

            const capsDiv = document.getElementById('modal-caps');
            capsDiv.innerHTML = '';
            // Generate fake capabilities tags based on name/doc
            const keywords = ['Analysis', 'Reasoning', 'Data', 'Risk', 'Execution'];
            keywords.forEach(k => {
                if ((agent.name + agent.docstring).includes(k)) {
                    capsDiv.innerHTML += `<span class="cyber-badge badge-cyan">${k}</span>`;
                }
            });
            if (capsDiv.innerHTML === '') capsDiv.innerHTML = `<span class="cyber-badge badge-slate">General Purpose</span>`;

            document.getElementById('details-modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('details-modal').classList.add('hidden');
        }

        function toggleTerminal() {
            document.getElementById('terminal').classList.toggle('open');
        }

        function deployAgent() {
            closeModal();
            const term = document.getElementById('terminal');
            const output = document.getElementById('terminal-output');

            if (!term.classList.contains('open')) term.classList.add('open');

            // Simulate startup
            const name = formatName(selectedAgent.name).toUpperCase();

            const log = (msg, color='text-slate-300') => {
                const div = document.createElement('div');
                div.innerHTML = `<span class="text-slate-500 mr-2">[${new Date().toLocaleTimeString('en-US',{hour12:false})}]</span> <span class="${color}">${msg}</span>`;
                output.appendChild(div);
                output.scrollTop = output.scrollHeight;
            };

            log(`INITIATING DEPLOYMENT: ${name}...`, 'text-cyan-400 font-bold');

            setTimeout(() => log(`Loading module: ${selectedAgent.path}...`), 500);
            setTimeout(() => log(`Verifying dependencies... OK`), 1000);
            setTimeout(() => log(`Connecting to Message Bus... OK`), 1500);
            setTimeout(() => {
                log(`${name} IS NOW ONLINE AND LISTENING.`, 'text-emerald-400 font-bold');
                document.getElementById('manual-command').disabled = false;
                document.getElementById('manual-command').focus();
            }, 2000);
        }
    </script>

    <!-- Adam Global Nav -->
    <script src="../showcase/js/nav.js" data-root=".."></script>
<script src="js/command_palette.js"></script></body>
</html>