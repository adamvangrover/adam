<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Brain | Cognitive Core</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #020408;
            --panel-bg: rgba(15, 23, 42, 0.7);
            --border-color: #334155;
            --accent-cyan: #22d3ee;
            --accent-purple: #a855f7;
            --accent-green: #10b981;
        }

        body {
            background-color: var(--bg-dark);
            color: #e2e8f0;
            font-family: 'Inter', sans-serif;
            background-image: radial-gradient(circle at 50% 0%, #1e1b4b 0%, #020408 60%);
            min-height: 100vh;
        }

        .scan-line {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
            z-index: 50;
        }

        .glass-panel {
            background: var(--panel-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        .glow-text {
            text-shadow: 0 0 10px rgba(34, 211, 238, 0.5);
        }

        .pulse-dot {
            box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            animation: pulse-green 2s infinite;
        }

        @keyframes pulse-green {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }

        .bar-container {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 9999px;
            overflow: hidden;
            height: 0.5rem;
        }
    </style>
</head>
<body class="p-6 md:p-12">
    <div class="scan-line"></div>

    <!-- Header -->
    <header class="flex justify-between items-end mb-10 border-b border-slate-800 pb-6 relative z-10">
        <div>
            <h1 class="text-4xl font-bold tracking-tight text-white mb-2 flex items-center gap-3">
                <i class="fas fa-brain text-purple-500"></i> SYSTEM <span class="text-cyan-400 glow-text">BRAIN</span>
            </h1>
            <p class="text-slate-400 mono text-sm flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-green-500 pulse-dot inline-block"></span>
                COGNITIVE CORE ONLINE
            </p>
        </div>
        <div class="text-right hidden md:block">
            <div class="text-xs text-slate-500 mono mb-1">RUNTIME SEED</div>
            <div class="text-sm text-cyan-500 mono" id="timestamp">--</div>
        </div>
    </header>

    <!-- Main Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 relative z-10">

        <!-- Active Agents Metric -->
        <div class="glass-panel p-6">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <div class="text-xs text-slate-400 mono uppercase tracking-widest">Active Agents</div>
                    <div class="text-3xl font-bold text-white mt-1" id="agent-count">0</div>
                </div>
                <div class="w-10 h-10 rounded-full bg-green-900/30 flex items-center justify-center border border-green-500/30">
                    <i class="fas fa-robot text-green-400"></i>
                </div>
            </div>
            <div class="h-px bg-slate-700 my-4"></div>
            <div class="text-xs text-slate-400 mb-2 mono">DEPLOYED UNITS:</div>
            <div class="flex flex-wrap gap-2" id="agent-list">
                <!-- Populated by JS -->
            </div>
        </div>

        <!-- Knowledge Base Metric -->
        <div class="glass-panel p-6">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <div class="text-xs text-slate-400 mono uppercase tracking-widest">Knowledge Nodes</div>
                    <div class="text-3xl font-bold text-white mt-1" id="knowledge-count">0</div>
                </div>
                <div class="w-10 h-10 rounded-full bg-amber-900/30 flex items-center justify-center border border-amber-500/30">
                    <i class="fas fa-book text-amber-400"></i>
                </div>
            </div>
            <div class="mt-4">
                <div class="flex justify-between text-xs text-slate-400 mb-1 mono">
                    <span>Docs & Strategy</span>
                    <span id="knowledge-percent">--%</span>
                </div>
                <div class="bar-container">
                    <div id="knowledge-bar" class="h-full bg-amber-500" style="width: 0%"></div>
                </div>
                <p class="text-xs text-slate-500 mt-3">Indexed semantic artifacts and strategy documents.</p>
            </div>
        </div>

        <!-- Complexity Metric -->
        <div class="glass-panel p-6">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <div class="text-xs text-slate-400 mono uppercase tracking-widest">Synaptic Edges</div>
                    <div class="text-3xl font-bold text-white mt-1" id="edge-count">0</div>
                </div>
                <div class="w-10 h-10 rounded-full bg-purple-900/30 flex items-center justify-center border border-purple-500/30">
                    <i class="fas fa-project-diagram text-purple-400"></i>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4 mt-4">
                <div>
                    <div class="text-[10px] text-slate-500 uppercase mono">Total Nodes</div>
                    <div class="text-lg font-bold text-slate-200" id="node-count">0</div>
                </div>
                <div>
                    <div class="text-[10px] text-slate-500 uppercase mono">Cog. Load</div>
                    <div class="text-lg font-bold text-purple-400" id="cog-load">0.0</div>
                </div>
            </div>
        </div>

        <!-- Active Synapses (Hotspots) -->
        <div class="glass-panel p-6 lg:col-span-2">
            <h3 class="text-sm font-bold text-white uppercase tracking-widest mb-6 flex items-center gap-2">
                <i class="fas fa-bolt text-yellow-400"></i> Active Synapses (Top Connected Nodes)
            </h3>
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="text-xs text-slate-500 border-b border-slate-700">
                            <th class="py-2 font-mono font-normal">NODE NAME</th>
                            <th class="py-2 font-mono font-normal">TYPE</th>
                            <th class="py-2 font-mono font-normal text-right">CONNECTIONS</th>
                            <th class="py-2 font-mono font-normal text-right">ACTIVITY</th>
                        </tr>
                    </thead>
                    <tbody id="synapse-list" class="text-sm text-slate-300">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Hardware Telemetry -->
        <div class="glass-panel p-6">
            <h3 class="text-sm font-bold text-white uppercase tracking-widest mb-6 flex items-center gap-2">
                <i class="fas fa-server text-cyan-400"></i> Infrastructure
            </h3>

            <div class="space-y-6">
                <!-- CPU -->
                <div>
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-slate-400 mono">CPU LOAD</span>
                        <span class="text-cyan-400 mono font-bold" id="cpu-val">0%</span>
                    </div>
                    <div class="bar-container bg-slate-800">
                        <div id="cpu-bar" class="h-full bg-cyan-500 transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>

                <!-- MEM -->
                <div>
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-slate-400 mono">MEMORY</span>
                        <span class="text-purple-400 mono font-bold" id="mem-val">0%</span>
                    </div>
                    <div class="bar-container bg-slate-800">
                        <div id="mem-bar" class="h-full bg-purple-500 transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>

                <!-- GPU -->
                <div>
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-slate-400 mono">GPU ACCELERATION</span>
                        <span class="text-green-400 mono font-bold" id="gpu-val">0%</span>
                    </div>
                    <div class="bar-container bg-slate-800">
                        <div id="gpu-bar" class="h-full bg-green-500 transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>

                 <!-- TPU -->
                 <div>
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-slate-400 mono">TPU TENSOR CORE</span>
                        <span class="text-red-400 mono font-bold" id="tpu-val">0%</span>
                    </div>
                    <div class="bar-container bg-slate-800">
                        <div id="tpu-bar" class="h-full bg-red-500 transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Actions -->
    <div class="mt-8 flex justify-center relative z-10">
        <a href="system_knowledge_graph.html" class="group relative px-8 py-4 bg-slate-900 border border-purple-500/50 rounded-lg overflow-hidden transition-all hover:border-purple-400 hover:shadow-[0_0_20px_rgba(168,85,247,0.3)]">
            <div class="absolute inset-0 w-full h-full bg-gradient-to-r from-purple-500/10 to-cyan-500/10 opacity-0 group-hover:opacity-100 transition-opacity"></div>
            <div class="relative flex items-center gap-3">
                <i class="fas fa-network-wired text-purple-400 text-xl group-hover:scale-110 transition-transform"></i>
                <div class="text-left">
                    <div class="text-xs text-purple-300 font-bold tracking-widest uppercase">Launch Interface</div>
                    <div class="text-white font-bold">Neural Knowledge Graph</div>
                </div>
                <i class="fas fa-arrow-right text-slate-500 group-hover:text-white group-hover:translate-x-1 transition-all ml-2"></i>
            </div>
        </a>
    </div>

    <script src="js/system_brain_data.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const data = window.SYSTEM_BRAIN_DATA || {};
            const metrics = data.metrics || {};
            const hw = data.hardware || {};

            // 1. Timestamp
            document.getElementById('timestamp').innerText = new Date(data.timestamp * 1000).toLocaleString();

            // 2. Key Metrics
            document.getElementById('agent-count').innerText = metrics.active_agents_count || 0;
            document.getElementById('knowledge-count').innerText = metrics.knowledge_nodes_count || 0;

            const kCov = metrics.knowledge_coverage || 0;
            document.getElementById('knowledge-percent').innerText = kCov + '%';
            document.getElementById('knowledge-bar').style.width = kCov + '%';

            document.getElementById('edge-count').innerText = metrics.total_edges || 0;
            document.getElementById('node-count').innerText = metrics.total_nodes || 0;
            document.getElementById('cog-load').innerText = metrics.cognitive_load || 0.0;

            // Agent List
            const agentList = document.getElementById('agent-list');
            (metrics.active_agents_list || []).forEach(agent => {
                const span = document.createElement('span');
                span.className = "px-2 py-1 bg-green-900/30 text-green-300 border border-green-800 rounded text-[10px] mono";
                span.innerText = agent;
                agentList.appendChild(span);
            });

            // 3. Synapses Table
            const synapseList = document.getElementById('synapse-list');
            (data.synapses || []).slice(0, 5).forEach(node => {
                const tr = document.createElement('tr');
                tr.className = "border-b border-slate-800 hover:bg-slate-800/50 transition-colors";

                let typeColor = "text-slate-400";
                if(node.type === 'agent') typeColor = "text-green-400";
                if(node.type === 'strategy') typeColor = "text-red-400";
                if(node.type === 'core') typeColor = "text-purple-400";

                tr.innerHTML = `
                    <td class="py-3 font-medium text-white">${node.name}</td>
                    <td class="py-3 text-xs uppercase ${typeColor}">${node.type}</td>
                    <td class="py-3 text-right font-mono text-cyan-300">${node.connections}</td>
                    <td class="py-3 text-right">
                        <div class="w-20 ml-auto bg-slate-700 h-1.5 rounded-full overflow-hidden">
                            <div class="h-full bg-cyan-500" style="width: ${Math.min(100, node.connections * 2)}%"></div>
                        </div>
                    </td>
                `;
                synapseList.appendChild(tr);
            });

            // 4. Hardware Telemetry
            function updateGauge(id, val) {
                document.getElementById(id + '-val').innerText = val + '%';
                document.getElementById(id + '-bar').style.width = val + '%';
            }

            updateGauge('cpu', hw.cpu_usage || 0);
            updateGauge('mem', hw.memory_usage_pct || 0);
            updateGauge('gpu', hw.gpu_usage || 0);
            updateGauge('tpu', hw.tpu_usage || 0);
        });
    </script>
</body>
</html>
