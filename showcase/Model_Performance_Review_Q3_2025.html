<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM v23.5 :: Model Performance Review: Q3 2025</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/market_mayhem_tiers.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/nav.js" defer></script>
    <script src="js/market_mayhem_viewer.js" defer></script>
</head>
<body class="tier-high">

    <div id="system2-overlay" class="system2-overlay">
        <div class="system2-terminal">
            <div id="sys2-content"></div>
        </div>
    </div>

    <div id="toast-container" class="cyber-toast-container"></div>

    <div id="raw-source-modal" class="raw-source-modal">
        <div class="raw-source-header">
            <span>SOURCE_DATA.JSON</span>
            <span style="cursor:pointer; color:#cc0000;" onclick="toggleSource()">[CLOSE]</span>
        </div>
        <div class="raw-source-content" id="raw-source-content"></div>
    </div>

    <div class="doc-toolbar" style="display: flex;">
        <div class="toolbar-item" onclick="window.location.href='market_mayhem_archive_v24.html'"><strong>FILE</strong></div>
        <div class="toolbar-item" onclick="toggleRedactionMode()">REDACT</div>
        <div class="toolbar-item" onclick="printReport()">PRINT</div>
        <div class="toolbar-item" onclick="shareReport()">SHARE</div>
        <div class="toolbar-item" onclick="downloadReport()">DOWNLOAD</div>
        <div class="toolbar-item" onclick="toggleTheme()">VIEW</div>
        <div class="toolbar-item" onclick="showToast('INSERT: PERMISSION DENIED')">INSERT</div>
        <div class="toolbar-item" onclick="showToast('FORMAT: LOCKED')">FORMAT</div>
        <div class="toolbar-item" onclick="runVerification()" style="color: #0078d7;"><strong>VERIFY</strong></div>
        <div style="flex-grow:1;"></div>
        <div class="toolbar-item" style="color:#666;">ADAM_V26_EDITOR</div>
    </div>

    <div style="max-width: 1400px; margin: 0 auto; padding: 10px 20px; display:flex; justify-content:space-between; align-items:center; display: none;">
        <a href="market_mayhem_archive_v24.html" class="cyber-btn">&larr; RETURN TO ARCHIVE</a>
        <div style="font-family:'JetBrains Mono'; font-size:0.7rem; color:#666;">SECURE CONNECTION ESTABLISHED</div>
    </div>

    <div class="newsletter-wrapper">
        <div class="paper-sheet" id="paper-sheet">

            <div id="top-secret-stamp" class="top-secret-stamp">TOP SECRET</div>

            <div class="doc-header-ui" style="display: flex;">
                <span id="verification-status">CONFIDENTIAL // SYSTEM 2 REVIEW</span>
                <span>1be636af</span>
            </div>

            <div style="display:flex; justify-content:space-between; font-family:'JetBrains Mono'; font-size:0.8rem; color:#666; margin-bottom:20px; margin-top: 20px;">
                <span>2025-10-15</span>
                <span>ID: 1be636af</span>
            </div>

            <h1 class="title">Model Performance Review: Q3 2025</h1>

            <div class="doc-metadata-panel" style="display: grid;">
                <div class="doc-metadata-item"><strong>Classification</strong>UNCLASSIFIED</div>
                <div class="doc-metadata-item"><strong>Conviction</strong>100/100</div>
                <div class="doc-metadata-item"><strong>Sentiment</strong>0/100</div>
                <div class="doc-metadata-item"><strong>Reviewer</strong>Market_Maker</div>
            </div>

            <div id="financialChartContainer" style="display:none; margin-bottom: 30px;">
                <canvas id="financialChart"></canvas>
            </div>

            <div id="crisisSimContainer" style="display:none; margin-bottom: 30px; border: 1px solid #cc0000; padding: 20px; background: rgba(50, 0, 0, 0.2);">
                <h3 style="color: #cc0000; margin-top: 0; font-family: 'JetBrains Mono'; border-bottom: 1px solid #cc0000; padding-bottom: 10px; margin-bottom: 20px;">CRISIS SIMULATOR // STRESS TEST</h3>

                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 20px;">
                    <div class="crisis-btn" onclick="renderCrisis('2008_LEHMAN')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2008 LEHMAN
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('1987_BLACK_MONDAY')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        1987 BLACK MON
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2000_DOTCOM_BUBBLE')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2000 DOTCOM
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2020_COVID')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2020 PANDEMIC
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2022_INFLATION_SHOCK')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2022 INFLATION
                    </div>
                    <div class="crisis-btn" onclick="renderCrisis('2025_AI_SHOCK')" style="cursor:pointer; text-align:center; padding: 10px; border: 1px solid #666; font-size: 0.8rem; color: #ccc;">
                        2025 AI SHOCK
                    </div>
                </div>

                <div style="height: 300px; position: relative;">
                    <canvas id="crisisChart"></canvas>
                </div>

                <div id="crisisMetrics" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; font-family: 'JetBrains Mono'; font-size: 0.8rem; color: #ccc;">
                    <div style="border: 1px solid #00f3ff; padding: 10px; background: rgba(0, 243, 255, 0.05);">
                        <div style="color: #00f3ff; border-bottom: 1px solid #00f3ff; margin-bottom: 10px; padding-bottom: 5px; font-weight: bold;">PORTFOLIO PERFORMANCE</div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>MAX DRAWDOWN:</span> <span id="port_dd" style="color: #fff;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>VOLATILITY (ANN):</span> <span id="port_vol" style="color: #fff;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between;"><span>TOTAL RETURN:</span> <span id="port_ret" style="color: #fff;">0.00%</span></div>
                    </div>
                    <div style="border: 1px solid #666; padding: 10px; background: rgba(100, 100, 100, 0.1);">
                        <div style="color: #888; border-bottom: 1px solid #666; margin-bottom: 10px; padding-bottom: 5px; font-weight: bold;">MARKET BENCHMARK</div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>MAX DRAWDOWN:</span> <span id="mkt_dd" style="color: #ccc;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>VOLATILITY (ANN):</span> <span id="mkt_vol" style="color: #ccc;">0.00%</span></div>
                        <div style="display: flex; justify-content: space-between;"><span>TOTAL RETURN:</span> <span id="mkt_ret" style="color: #ccc;">0.00%</span></div>
                    </div>
                </div>

                <div style="font-size: 0.7rem; color: #888; margin-top: 15px; font-style: italic;">
                    * Hypothetical performance based on portfolio beta and current risk profile. PAST PERFORMANCE IS NOT INDICATIVE OF FUTURE RESULTS.
                </div>
            </div>

            <div id="document-body">
                <strong>Date:</strong> 2025-10-15
<strong>Analyst:</strong> Adam Risk Engine (Audit Module)
<h2>1. Accuracy Audit (Prediction vs. Reality)</h2>
<p>The following table analyzes the key predictions made in the Q2 "Outlook" versus the realized market data for Q3 2025.</p>
<p>| Prediction | Confidence | Realized Outcome | Verdict | Accuracy Score |
| :--- | :---: | :--- | :--- | :---: |
| <strong>"Oil to break $90/bbl"</strong> | 75% | Brent peaked at $88.40, then faded to $78. | <strong>MISS</strong> | 65% |
| <strong>"Fed Pause in September"</strong> | 90% | Fed held rates steady (5.25%). | <strong>HIT</strong> | 100% |
| <strong>"Small Cap Rotation"</strong> | 60% | Russell 2000 dropped 8%. | <strong>MISS</strong> | 0% |
| <strong>"Yen Volatility > 15%"</strong> | 85% | JPY Implied Vol hit 18%. | <strong>HIT</strong> | 95% |</p>
<strong>Aggregate System Precision:</strong> 72.4%
<strong>Bias Detected:</strong> The model currently exhibits a "Permabull" bias in Small Caps (IWM), consistently underestimating the impact of refinancing walls on zombie companies.
<h2>2. Sentiment Model Calibration</h2>
<ul>
<li>  <strong>Issue:</strong> The NLP engine flagged "layoffs" as purely negative.</li>
<li>  <strong>Reality:</strong> Market reacted positively to "efficiency measures" (e.g., Meta, Google).</li>
<li>  <strong>Adjustment:</strong> We have retrained the `FinBERT` layer to contextualize "layoffs" within "margin expansion" narratives.</li>
</ul>
<h2>3. Analytical Rigor & Reasoning</h2>
<ul>
<li>  <strong>Deficiency:</strong> In the July "Crypto Shock" report, the causal link between "SEC Regulation" and "Bitcoin Dominance" was asserted but not mathematically proven.</li>
<li>  <strong>Correction:</strong> Future Deep Dives must include a <strong>Granger Causality Test</strong> or a Correlation Matrix heatmap to substantiate narrative claims.</li>
<li>  <strong>New Protocol:</strong> "No Narrative Without Numbers."</li>
</ul>
<p>---</p>
<h2>4. Development Notes for Human Operators</h2>
> The machine is good at extrapolating trends, but bad at predicting turning points driven by <em>political</em> irrationality. The Q3 miss on Oil was due to an unmodeled geopolitical de-escalation deal. We recommend increasing the weight of "Diplomatic Cables" in the ingestion pipeline.
<strong>Signed:</strong> <em>Adam Audit Bot v2.1</em>

            </div>

            <div class="provenance-log">
                <div class="log-entry">
                    <span>> HASH_CHECK</span>
                    <span style="color:var(--terminal-green);">1be636afbcaad73b71ea57925263a7e7417fbabc0ede28fa308248478642d74b</span>
                </div>
                <div class="log-entry">
                    <span>> SENTIMENT_SCAN</span>
                    <span>0 (DENSITY: 78)</span>
                </div>
                <div class="log-entry">
                    <span>> CONVICTION_LOCK</span>
                    <span>100%</span>
                </div>
                <div class="log-entry">
                    <span>> CRITIQUE_LOG</span>
                    <span>"Agent Market_Maker reviewed this intelligence. Verdict: SPECULATIVE. Sentiment alignment: 0/100. Cross-reference with knowledge graph completed."</span>
                </div>
            </div>

            <a href="#" class="source-jump-btn" onclick="toggleSource(); return false;" title="View Source JSON">JUMP TO SOURCE</a>

            <div style="margin-top: 40px; border-top: 1px solid #ccc; padding-top: 20px; font-style: italic; color: #666;">
                End of Transmission.
            </div>
        </div>

        <aside class="cyber-sidebar">
            <div class="sidebar-widget">
                <div class="sidebar-title">Intelligence Metadata</div>
                <div class="stat-row"><span>DATE</span> <span class="stat-val">2025-10-15</span></div>
                <div class="stat-row"><span>TYPE</span> <span class="stat-val">PERFORMANCE_REVIEW</span></div>
                <div class="stat-row"><span>CLASS</span> <span class="stat-val">UNCLASSIFIED</span></div>
                <div class="stat-row"><span>PROVENANCE</span> <span class="stat-val" title="1be636afbcaad73b71ea57925263a7e7417fbabc0ede28fa308248478642d74b">1be636af</span></div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Sentiment Analysis</div>
                <div class="stat-row"><span>SCORE</span> <span class="stat-val">0/100</span></div>
                <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 0%;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Detected Entities</div>
                <div class="tag-cloud">
                    <a href="market_mayhem_archive_v24.html?search=US_FED" class="tag" style="text-decoration:none;">US_FED</a><a href="market_mayhem_archive_v24.html?search=AI" class="tag" style="text-decoration:none; border-color:#666;">AI</a><a href="market_mayhem_archive_v24.html?search=Bitcoin" class="tag" style="text-decoration:none; border-color:#666;">Bitcoin</a><a href="market_mayhem_archive_v24.html?search=Crypto" class="tag" style="text-decoration:none; border-color:#666;">Crypto</a><a href="market_mayhem_archive_v24.html?search=DeFi" class="tag" style="text-decoration:none; border-color:#666;">DeFi</a><a href="market_mayhem_archive_v24.html?search=EV" class="tag" style="text-decoration:none; border-color:#666;">EV</a>
                </div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Agent Conviction</div>
                 <div class="stat-row"><span>CONFIDENCE</span> <span class="stat-val">100/100</span></div>
                 <div class="sentiment-bar">
                    <div class="sentiment-fill" style="width: 100%; background: #00ff00;"></div>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="sidebar-title">Semantic Analysis</div>
                 <div class="stat-row"><span>DENSITY</span> <span class="stat-val">78/100</span></div>
                 <div class="stat-row"><span>PROBABILITY</span> <span class="stat-val">100/100</span></div>
            </div>

             <div class="sidebar-widget" style="border-color: #555;">
                <div class="sidebar-title">Reviewer Agent Log</div>
                 <div style="font-size: 0.75rem; color: #ccc; font-style: italic;">
                    "Agent Market_Maker reviewed this intelligence. Verdict: SPECULATIVE. Sentiment alignment: 0/100. Cross-reference with knowledge graph completed."
                </div>
                <div class="stat-row" style="margin-top:10px;"><span>QUALITY SCORE</span> <span class="stat-val">100/100</span></div>
            </div>

             <div class="sidebar-widget">
                <div class="sidebar-title">Contributing Agents</div>
                 <div style="display:flex; flex-direction:column; gap:5px;">
                    <div style="font-size:0.75rem; color:#666;">System Core</div>
                </div>
            </div>
        </aside>
    </div>

    <textarea id="hidden-raw-data" style="display:none;">{
  "title": "Model Performance Review: Q3 2025",
  "date": "2025-10-15",
  "summary": "Market analysis and strategic insights.",
  "type": "PERFORMANCE_REVIEW",
  "full_body": "<strong>Date:</strong> 2025-10-15\n<strong>Analyst:</strong> Adam Risk Engine (Audit Module)\n<h2>1. Accuracy Audit (Prediction vs. Reality)</h2>\n<p>The following table analyzes the key predictions made in the Q2 \"Outlook\" versus the realized market data for Q3 2025.</p>\n<p>| Prediction | Confidence | Realized Outcome | Verdict | Accuracy Score |\n| :--- | :---: | :--- | :--- | :---: |\n| <strong>\"Oil to break $90/bbl\"</strong> | 75% | Brent peaked at $88.40, then faded to $78. | <strong>MISS</strong> | 65% |\n| <strong>\"Fed Pause in September\"</strong> | 90% | Fed held rates steady (5.25%). | <strong>HIT</strong> | 100% |\n| <strong>\"Small Cap Rotation\"</strong> | 60% | Russell 2000 dropped 8%. | <strong>MISS</strong> | 0% |\n| <strong>\"Yen Volatility > 15%\"</strong> | 85% | JPY Implied Vol hit 18%. | <strong>HIT</strong> | 95% |</p>\n<strong>Aggregate System Precision:</strong> 72.4%\n<strong>Bias Detected:</strong> The model currently exhibits a \"Permabull\" bias in Small Caps (IWM), consistently underestimating the impact of refinancing walls on zombie companies.\n<h2>2. Sentiment Model Calibration</h2>\n<ul>\n<li>  <strong>Issue:</strong> The NLP engine flagged \"layoffs\" as purely negative.</li>\n<li>  <strong>Reality:</strong> Market reacted positively to \"efficiency measures\" (e.g., Meta, Google).</li>\n<li>  <strong>Adjustment:</strong> We have retrained the `FinBERT` layer to contextualize \"layoffs\" within \"margin expansion\" narratives.</li>\n</ul>\n<h2>3. Analytical Rigor & Reasoning</h2>\n<ul>\n<li>  <strong>Deficiency:</strong> In the July \"Crypto Shock\" report, the causal link between \"SEC Regulation\" and \"Bitcoin Dominance\" was asserted but not mathematically proven.</li>\n<li>  <strong>Correction:</strong> Future Deep Dives must include a <strong>Granger Causality Test</strong> or a Correlation Matrix heatmap to substantiate narrative claims.</li>\n<li>  <strong>New Protocol:</strong> \"No Narrative Without Numbers.\"</li>\n</ul>\n<p>---</p>\n<h2>4. Development Notes for Human Operators</h2>\n> The machine is good at extrapolating trends, but bad at predicting turning points driven by <em>political</em> irrationality. The Q3 miss on Oil was due to an unmodeled geopolitical de-escalation deal. We recommend increasing the weight of \"Diplomatic Cables\" in the ingestion pipeline.\n<strong>Signed:</strong> <em>Adam Audit Bot v2.1</em>\n",
  "sentiment_score": 0,
  "entities": {
    "tickers": [],
    "agents": [],
    "sovereigns": [
      "US_FED"
    ],
    "keywords": [
      "AI",
      "Bitcoin",
      "Crypto",
      "DeFi",
      "EV"
    ]
  },
  "provenance_hash": "1be636afbcaad73b71ea57925263a7e7417fbabc0ede28fa308248478642d74b",
  "filename": "Model_Performance_Review_Q3_2025.html",
  "is_sourced": true,
  "metrics_json": "{}",
  "source_priority": 2,
  "conviction": 100,
  "critique": "Agent Market_Maker reviewed this intelligence. Verdict: SPECULATIVE. Sentiment alignment: 0/100. Cross-reference with knowledge graph completed.",
  "quality": 100,
  "semantic_score": 78,
  "probability": 100,
  "outlook_score": 45
}</textarea>

    <script>
        // Chart Injection Logic
        const metricsData = {};
        const crisisData = {"2008_LEHMAN": {"scenario": "2008_LEHMAN", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "market": [100.0, 96.66, 90.42, 82.73, 78.43, 80.0, 77.65, 73.24, 66.95, 74.6, 70.81, 76.03, 79.03, 63.0, 48.93, 38.46, 35.01, 38.42, 33.72, 30.9, 26.01, 26.06, 26.15, 27.33, 23.68, 21.83, 21.71, 22.73, 20.63, 21.34], "portfolio": [100.0, 100.65, 95.2, 89.09, 83.15, 87.53, 86.71, 82.71, 76.97, 82.24, 80.58, 85.11, 86.09, 74.29, 64.25, 61.58, 56.55, 56.62, 53.03, 50.03, 47.23, 49.62, 49.49, 51.39, 48.71, 46.99, 46.51, 47.14, 43.79, 44.21], "metrics": {"market": {"max_drawdown": 79.37, "volatility": 139.17, "total_return": -78.66}, "portfolio": {"max_drawdown": 56.49, "volatility": 82.77, "total_return": -55.79}}}, "1987_BLACK_MONDAY": {"scenario": "1987_BLACK_MONDAY", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], "market": [100.0, 102.85, 100.86, 101.52, 111.22, 92.84, 92.21, 83.82, 78.64, 73.74, 80.16, 78.87, 78.72, 55.66, 56.66, 49.56, 46.1, 50.71, 51.57, 56.51], "portfolio": [100.0, 101.34, 101.85, 98.65, 102.35, 94.75, 95.63, 91.28, 84.25, 83.34, 89.64, 82.6, 83.97, 69.05, 69.22, 64.66, 61.75, 64.03, 64.36, 69.58], "metrics": {"market": {"max_drawdown": 58.55, "volatility": 152.95, "total_return": -43.49}, "portfolio": {"max_drawdown": 39.67, "volatility": 95.59, "total_return": -30.42}}}, "2000_DOTCOM_BUBBLE": {"scenario": "2000_DOTCOM_BUBBLE", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45], "market": [100.0, 103.34, 102.31, 104.6, 96.08, 89.63, 94.89, 108.38, 104.7, 103.58, 91.82, 96.67, 103.52, 96.72, 99.28, 99.14, 99.42, 104.94, 104.87, 112.33, 110.45, 112.34, 114.16, 117.55, 121.12, 115.12, 115.87, 117.95, 122.65, 117.15, 114.4, 113.69, 110.77, 111.97, 112.23, 110.83, 114.94, 108.52, 99.6, 101.66, 103.64, 102.81, 95.63, 94.66, 92.32], "portfolio": [100.0, 105.31, 104.84, 105.27, 100.42, 100.77, 99.53, 107.15, 108.15, 101.25, 103.47, 104.13, 109.72, 104.91, 106.87, 106.52, 107.7, 117.63, 117.29, 119.81, 117.32, 118.06, 119.16, 118.18, 117.62, 112.83, 111.87, 110.2, 113.2, 111.7, 112.16, 115.38, 113.39, 116.28, 118.63, 118.16, 123.37, 121.63, 118.91, 122.0, 122.93, 120.86, 115.42, 116.16, 114.32], "metrics": {"market": {"max_drawdown": 24.73, "volatility": 75.65, "total_return": -7.68}, "portfolio": {"max_drawdown": 8.02, "volatility": 48.52, "total_return": 14.32}}}, "2020_COVID": {"scenario": "2020_COVID", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "market": [100.0, 102.41, 97.71, 84.42, 84.46, 89.72, 91.95, 89.38, 82.02, 92.52, 86.92, 83.62, 75.77, 59.18, 60.94, 59.35, 62.88, 50.05, 53.64, 37.61, 39.72, 44.45, 43.8, 44.98, 45.94, 46.23, 50.21, 42.31, 39.36, 36.36, 37.93, 35.71, 33.18, 31.87, 30.05, 29.87, 27.09, 26.08, 27.21, 29.22], "portfolio": [100.0, 101.97, 100.44, 92.25, 90.48, 94.19, 96.59, 96.06, 90.09, 96.25, 90.43, 90.36, 81.48, 72.23, 75.65, 78.25, 84.29, 72.7, 78.93, 66.09, 67.92, 72.57, 70.01, 72.01, 73.59, 73.83, 78.76, 67.69, 66.24, 60.46, 62.6, 60.82, 61.6, 60.34, 55.96, 54.67, 49.36, 49.42, 52.3, 54.52], "metrics": {"market": {"max_drawdown": 74.53, "volatility": 143.64, "total_return": -70.78}, "portfolio": {"max_drawdown": 51.59, "volatility": 102.74, "total_return": -45.48}}}, "2022_INFLATION_SHOCK": {"scenario": "2022_INFLATION_SHOCK", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "market": [100.0, 96.46, 94.48, 90.43, 88.65, 81.99, 75.97, 80.1, 71.67, 67.98, 69.7, 71.32, 73.04, 75.89, 74.31, 71.88, 72.15, 77.33, 77.11, 81.56, 81.33, 77.94, 73.36, 70.09, 69.33, 69.66, 66.72, 63.26, 63.27, 49.02, 47.36, 53.31, 54.9, 53.17, 53.75, 54.74, 55.2, 56.97, 56.03, 55.06, 54.7, 53.95, 53.17, 53.57, 56.66, 56.99, 56.27, 55.38, 55.36, 52.93, 53.42, 50.78, 48.57, 49.24, 51.03, 48.51, 45.29, 41.6, 39.37, 37.59], "portfolio": [100.0, 94.53, 89.22, 87.35, 88.59, 85.75, 82.33, 88.78, 79.1, 79.5, 83.83, 84.72, 84.82, 85.24, 86.65, 90.67, 90.71, 94.09, 94.37, 101.67, 100.27, 102.05, 98.39, 95.09, 95.9, 97.55, 97.13, 91.26, 90.57, 80.27, 77.86, 84.68, 92.45, 88.65, 86.99, 87.91, 85.98, 92.08, 94.02, 89.68, 87.8, 86.27, 86.42, 86.66, 89.92, 89.44, 86.68, 86.38, 85.63, 81.55, 79.74, 77.43, 74.01, 77.98, 80.57, 77.99, 73.31, 69.27, 65.13, 64.62], "metrics": {"market": {"max_drawdown": 62.41, "volatility": 78.8, "total_return": -62.41}, "portfolio": {"max_drawdown": 36.68, "volatility": 68.28, "total_return": -35.38}}}, "2025_AI_SHOCK": {"scenario": "2025_AI_SHOCK", "labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "market": [100.0, 100.51, 87.65, 86.91, 81.9, 76.73, 80.02, 85.72, 83.23, 82.73, 70.32, 85.53, 82.52, 82.51, 83.62, 85.35, 81.77, 68.44, 64.94, 73.11, 76.49, 87.18, 81.15, 78.69, 79.97, 79.32, 79.19, 77.24, 65.83, 56.95, 51.73, 52.3, 41.55, 39.42, 35.06], "portfolio": [100.0, 99.26, 91.16, 93.58, 90.87, 86.91, 94.66, 97.4, 96.92, 94.59, 83.33, 95.28, 96.67, 92.86, 94.17, 93.14, 90.67, 86.97, 92.03, 96.03, 100.12, 105.97, 100.26, 99.32, 97.98, 100.2, 97.0, 97.73, 85.34, 80.58, 76.31, 74.42, 66.17, 65.05, 63.15], "metrics": {"market": {"max_drawdown": 65.12, "volatility": 138.71, "total_return": -64.94}, "portfolio": {"max_drawdown": 40.41, "volatility": 88.32, "total_return": -36.85}}}};

        // --- Metrics Chart ---
        if (metricsData && Object.keys(metricsData).length > 0) {
            const ctx = document.getElementById('financialChart');
            const container = document.getElementById('financialChartContainer');

            // Basic parsing of metrics structure (assuming flat or Year->Val)
            let labels = [];
            let values = [];
            let labelName = "Metric";

            // Try to find a timeseries
            for (const [key, val] of Object.entries(metricsData)) {
                if (typeof val === 'object') {
                    // Likely year -> value
                    labels = Object.keys(val);
                    values = Object.values(val).map(v => parseFloat(v.replace(/[^0-9.-]/g, '')));
                    labelName = key;
                    break;
                }
            }

            if (labels.length > 0) {
                container.style.display = 'block';
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: labelName,
                            data: values,
                            backgroundColor: 'rgba(204, 0, 0, 0.5)',
                            borderColor: '#cc0000',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#ccc' } }
                        },
                        scales: {
                            y: { grid: { color: '#333' }, ticks: { color: '#888' } },
                            x: { grid: { color: '#333' }, ticks: { color: '#888' } }
                        }
                    }
                });
            }
        }

        // --- Crisis Simulation Logic ---
        let crisisChartInstance = null;

        window.renderCrisis = function(scenarioName) {
            if (!crisisData || !crisisData[scenarioName]) return;

            // UI Feedback for Buttons
            document.querySelectorAll('.crisis-btn').forEach(btn => {
                btn.style.borderColor = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#666';
                btn.style.color = btn.innerText.includes(scenarioName.split('_')[1]) ? '#cc0000' : '#ccc';
            });

            const data = crisisData[scenarioName];

            // Update Metrics Display
            if (data.metrics) {
                const p = data.metrics.portfolio;
                const m = data.metrics.market;

                document.getElementById('port_dd').innerText = p.max_drawdown.toFixed(2) + '%';
                document.getElementById('port_vol').innerText = p.volatility.toFixed(2) + '%';
                document.getElementById('port_ret').innerText = p.total_return.toFixed(2) + '%';

                // Color code return
                document.getElementById('port_ret').style.color = p.total_return >= 0 ? '#00f3ff' : '#ff4444';

                document.getElementById('mkt_dd').innerText = m.max_drawdown.toFixed(2) + '%';
                document.getElementById('mkt_vol').innerText = m.volatility.toFixed(2) + '%';
                document.getElementById('mkt_ret').innerText = m.total_return.toFixed(2) + '%';

                document.getElementById('mkt_ret').style.color = m.total_return >= 0 ? '#ccc' : '#cc0000';
            }

            const ctx = document.getElementById('crisisChart').getContext('2d');

            if (crisisChartInstance) {
                crisisChartInstance.destroy();
            }

            crisisChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'Your Portfolio (Simulated)',
                            data: data.portfolio,
                            borderColor: '#00f3ff',
                            backgroundColor: 'rgba(0, 243, 255, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 0
                        },
                        {
                            label: 'Market Benchmark',
                            data: data.market,
                            borderColor: '#666',
                            borderDash: [5, 5],
                            borderWidth: 1,
                            pointRadius: 0,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { labels: { color: '#ccc', font: { family: 'JetBrains Mono' } } },
                        title: {
                            display: true,
                            text: 'STRESS TEST SCENARIO: ' + scenarioName.replace(/_/g, ' '),
                            color: '#cc0000',
                            font: { family: 'JetBrains Mono' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#cc0000',
                            bodyColor: '#fff',
                            borderColor: '#333',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#333' },
                            ticks: { color: '#888', callback: function(value) { return value + '%'; } }
                        },
                        x: {
                            grid: { color: '#333' },
                            ticks: { display: false }
                        }
                    }
                }
            });
        };

        // Auto-Run Default Crisis if Data Available
        if (crisisData && Object.keys(crisisData).length > 0) {
            document.getElementById('crisisSimContainer').style.display = 'block';

            // Parse URL parameters for ?sim=SCENARIO_NAME
            const urlParams = new URLSearchParams(window.location.search);
            const simParam = urlParams.get('sim');

            // slight delay to ensure Chart.js loaded
            setTimeout(() => {
                if (simParam && crisisData[simParam]) {
                    renderCrisis(simParam);
                    // Scroll to container
                    document.getElementById('crisisSimContainer').scrollIntoView({ behavior: 'smooth' });
                } else {
                    renderCrisis('2008_LEHMAN');
                }
            }, 100);
        }
    </script>
</body>
</html>