<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAM EVOLUTION :: SYSTEM HISTORY</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-color: #050b14;
            --text-primary: #e0e0e0;
            --accent-cyan: #00f3ff;
            --accent-purple: #bd00ff;
            --accent-yellow: #ffd700;
        }
        body { margin: 0; background: var(--bg-color); color: var(--text-primary); font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .mono { font-family: 'JetBrains Mono', monospace; }

        .cyber-header {
            height: 60px; display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; border-bottom: 1px solid var(--accent-cyan);
            background: rgba(5, 11, 20, 0.95); position: sticky; top: 0; z-index: 100;
        }

        .controls {
            max-width: 1000px; margin: 20px auto 0; padding: 0 20px;
            display: flex; gap: 10px; justify-content: flex-end;
        }

        .timeline-container {
            max-width: 1000px; margin: 60px auto; padding: 0 20px; position: relative;
        }
        .timeline-line {
            position: absolute; left: 50%; width: 2px; background: #333; top: 0; bottom: 0; transform: translateX(-50%);
        }

        .timeline-node {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 80px; position: relative;
        }
        .timeline-node:nth-child(even) { flex-direction: row-reverse; }

        .node-content {
            width: 45%; background: rgba(255, 255, 255, 0.02); border: 1px solid #333; padding: 20px;
            backdrop-filter: blur(5px); position: relative; transition: all 0.3s;
        }
        .node-content:hover { border-color: var(--accent-cyan); box-shadow: 0 0 20px rgba(0, 243, 255, 0.1); }
        .node-content::before {
            content: ''; position: absolute; top: 20px; width: 20px; height: 1px; background: var(--accent-cyan);
        }
        .timeline-node:nth-child(odd) .node-content::before { right: -21px; }
        .timeline-node:nth-child(even) .node-content::before { left: -21px; }

        .node-marker {
            width: 20px; height: 20px; background: #000; border: 2px solid var(--accent-cyan); border-radius: 50%;
            position: absolute; left: 50%; transform: translateX(-50%); z-index: 10;
        }

        .version-tag {
            font-size: 0.8rem; background: rgba(0, 243, 255, 0.1); color: var(--accent-cyan);
            padding: 2px 6px; border-radius: 4px; display: inline-block; margin-bottom: 10px;
        }

        .capability-list { padding-left: 20px; color: #aaa; font-size: 0.9rem; }
        .capability-list li { margin-bottom: 5px; }

        .metrics-grid {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; max-width: 1000px; margin: 40px auto; padding: 0 20px;
        }
        .metric-card {
            background: rgba(255, 255, 255, 0.02); border: 1px solid #333; padding: 20px; text-align: center;
        }

        .cyber-btn {
            font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; padding: 6px 12px;
            border: 1px solid #444; color: var(--text-primary); text-decoration: none; display: inline-block;
            background: transparent; cursor: pointer;
        }
        .cyber-btn:hover { border-color: var(--accent-cyan); color: var(--accent-cyan); }
        .cyber-btn.active { background: rgba(0, 243, 255, 0.1); border-color: var(--accent-cyan); color: var(--accent-cyan); }

        .constraints-section {
            max-width: 1000px; margin: 60px auto; padding: 40px; border: 1px solid var(--accent-purple);
            background: rgba(189, 0, 255, 0.02); position: relative;
        }
        .constraints-title {
            position: absolute; top: -15px; left: 40px; background: var(--bg-color); padding: 0 10px;
            color: var(--accent-purple); font-weight: bold; font-family: 'JetBrains Mono';
        }

        .log-quote {
            font-style: italic; color: #888; border-left: 2px solid #444; padding-left: 10px; margin: 10px 0; font-size: 0.9rem;
        }

    </style>
</head>
<body>
    <header class="cyber-header">
        <h1 class="mono" style="color: var(--accent-cyan); margin: 0;">ADAM EVOLUTION</h1>
        <nav>
            <a href="mission_control_v2.html" class="cyber-btn">MISSION CONTROL</a>
        </nav>
    </header>

    <!-- Controls -->
    <div class="controls">
        <button id="btn-human" class="cyber-btn active" onclick="setMode('human')">HUMAN MODE</button>
        <button id="btn-ml" class="cyber-btn" onclick="downloadDataset()">ML DATASET (JSON)</button>
    </div>

    <!-- Metrics Header -->
    <div class="metrics-grid">
        <div class="metric-card">
            <h3 class="mono" style="color: #666; font-size: 0.8rem;">MODEL GENERATIONS</h3>
            <canvas id="genChart" height="150"></canvas>
        </div>
        <div class="metric-card">
            <h3 class="mono" style="color: #666; font-size: 0.8rem;">AGENT COMPLEXITY</h3>
            <canvas id="agentChart" height="150"></canvas>
        </div>
        <div class="metric-card">
            <h3 class="mono" style="color: #666; font-size: 0.8rem;">SYSTEM ENTROPY</h3>
            <canvas id="entropyChart" height="150"></canvas>
        </div>
    </div>

    <div class="timeline-container">
        <div class="timeline-line"></div>
        <div id="timeline-content">
            <!-- Dynamic Content -->
        </div>
    </div>

    <!-- Constraints Section (Static for now, but could be dynamic) -->
    <div class="constraints-section">
        <div class="constraints-title">SYSTEM CONSTRAINTS & BOUNDARIES</div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
            <div>
                <h3 class="mono" style="color: var(--accent-purple);">COGNITIVE LIMITS</h3>
                <ul style="color: #aaa; line-height: 1.6;">
                    <li><strong>Context Window:</strong> 128k Tokens (Soft Limit). Information beyond this requires RAG retrieval.</li>
                    <li><strong>Temporal Lag:</strong> Knowledge cutoff applies to base model; "NewsBot" bridges the gap but has latency.</li>
                    <li><strong>Hallucination Risk:</strong> Non-zero probability in creative synthesis tasks. Requires "Red Team" verification.</li>
                </ul>
            </div>
            <div>
                <h3 class="mono" style="color: var(--accent-purple);">SAFETY PROTOCOLS</h3>
                <ul style="color: #aaa; line-height: 1.6;">
                    <li><strong>No Trade Execution:</strong> System is ADVISORY only. Cannot execute real-money transactions.</li>
                    <li><strong>PII Redaction:</strong> All client data is anonymized before processing in the cloud layer.</li>
                    <li><strong>Adversarial Mandatory:</strong> Bear cases must be generated for every Bull thesis.</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        let globalData = null;
        let charts = {};

        async function loadData() {
            try {
                const response = await fetch('data/evolution_data.json');
                const data = await response.json();
                globalData = data;
                renderTimeline(data.timeline);
                renderCharts(data.timeline);
            } catch (e) {
                console.error("Failed to load evolution data", e);
                document.getElementById('timeline-content').innerHTML = '<p style="text-align:center; color:red;">Failed to load data. Ensure showcase/data/evolution_data.json exists.</p>';
            }
        }

        function renderTimeline(timeline) {
            const container = document.getElementById('timeline-content');
            container.innerHTML = '';

            timeline.forEach((node, index) => {
                const div = document.createElement('div');
                div.className = 'timeline-node';

                // Construct lists
                let listsHtml = '';
                if (node.added && node.added.length > 0) {
                    listsHtml += `<ul class="capability-list">`;
                    node.added.slice(0, 3).forEach(item => {
                        // Strip markdown bold if present for cleaner display
                        const cleanItem = item.replace(/\*\*(.*?)\*\*/g, '$1').split(' - ')[0]; // Just take the name part if split by dash
                        listsHtml += `<li>${cleanItem}</li>`;
                    });
                    if (node.added.length > 3) listsHtml += `<li>+ ${node.added.length - 3} more...</li>`;
                    listsHtml += `</ul>`;
                }

                div.innerHTML = `
                    <div class="node-content">
                        <span class="version-tag mono">${node.version}</span>
                        <h2 style="margin: 5px 0;">${node.title}</h2>
                        <div style="font-size: 0.8rem; color: #666; margin-bottom: 5px;">${node.date}</div>
                        ${node.log ? `<div class="log-quote">"${node.log.substring(0, 150)}${node.log.length > 150 ? '...' : ''}"</div>` : ''}
                        ${listsHtml}
                    </div>
                    <div class="node-marker"></div>
                `;
                container.appendChild(div);
            });
        }

        function renderCharts(timeline) {
            // Reverse timeline for charts (oldest to newest)
            const sorted = [...timeline].reverse();
            const labels = sorted.map(t => t.version);
            const complexity = sorted.map(t => t.metrics.complexity);
            const entropy = sorted.map(t => t.metrics.entropy);
            const generations = sorted.map(t => t.metrics.generations);

            const commonOptions = {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { x: { display: false }, y: { display: false } }
            };

            // Destroy existing if any
            if (charts.gen) charts.gen.destroy();
            if (charts.agent) charts.agent.destroy();
            if (charts.entropy) charts.entropy.destroy();

            // Gen Chart
            charts.gen = new Chart(document.getElementById('genChart'), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        data: generations,
                        borderColor: '#00f3ff', tension: 0.4, borderWidth: 2, pointRadius: 0
                    }]
                },
                options: commonOptions
            });

            // Agent Complexity
            charts.agent = new Chart(document.getElementById('agentChart'), {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        data: complexity,
                        backgroundColor: '#bd00ff', borderRadius: 2
                    }]
                },
                options: commonOptions
            });

            // Entropy
            charts.entropy = new Chart(document.getElementById('entropyChart'), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        data: entropy,
                        borderColor: '#ffd700', tension: 0.4, borderWidth: 2, pointRadius: 0
                    }]
                },
                options: commonOptions
            });
        }

        function downloadDataset() {
            if (!globalData) return;
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(globalData, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "adam_evolution_dataset.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
        }

        function setMode(mode) {
            // Visual toggle only for now, can extend to change view
            document.getElementById('btn-human').classList.toggle('active', mode === 'human');
            // document.getElementById('btn-ml').classList.toggle('active', mode === 'ml');
            // ML mode is just download for now
        }

        document.addEventListener('DOMContentLoaded', loadData);
    </script>
<script src="js/command_palette.js"></script></body>
</html>
